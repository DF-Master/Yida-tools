# Def of 220118

# bsa_fasta = "MKWVTFISLLLLFSSAYSRGVFRRDTHKSEIAHRFKDLGEEHFKGLVLIAFSQYLQQCPFDEHVKLVNELTEFAKTCVADESHAGCEKSLHTLFGDELCKVASLRETYGDMADCCEKQEPERNECFLSHKDDSPDLPKLKPDPNTLCDEFKADEKKFWGKYLYEIARRHPYFYAPELLYYANKYNGVFQECCQAEDKGACLLPKIETMREKVLTSSARQRLRCASIQKFGERALKAWSVARLSQKFPKAEFVEVTKLVTDLTKVHKECCHGDLLECADDRADLAKYICDNQDTISSKLKECCDKPLLEKSHCIAEVEKDAIPENLPPLTADFAEDKDVCKNYQEAKDAFLGSFLYEYSRRHPEYAVSVLLRLAKEYEATLEECCAKDDPHACYSTVFDKLKHLVDEPQNLIKQNCDQFEKLGEYGFQNALIVRYTRKVPQVSTPTLVEVSRSLGKVGTRCCTKPESERMPCTEDYLSLILNRLCVLHEKTPVSEKVTKCCTESLVNRRPCFSALTPDETYVPKAFDEKLFTFHADICTLPDTEKQIKKQTALVELLKHKPKATEEQLKTVMENFVAFVDKCCAADDKEACFAVEGPKLVVSTQTALA"

# spotlink_file_0118_B_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_B_HCDFT_result_filtered.csv'
# spotlink_file_0118_BM10_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_BM10_HCDFT_result_filtered.csv'
# spotlink_file_0118_BS1_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_BS1_HCDFT_result_filtered.csv'
# spotlink_file_0118_BS2_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_BS2_HCDFT_result_filtered.csv'
# spotlink_file_0118_BS3_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_BS3_HCDFT_result_filtered.csv'
# spotlink_file_0118_BS5_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_BS5_HCDFT_result_filtered.csv'
# spotlink_file_0118_BS10_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_BS10_HCDFT_result_filtered.csv'
# spotlink_file_0118_BS30_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_BS30_HCDFT_result_filtered.csv'

# plink_0118_B_fDR = "G:/MSdata/20220215dataanalyze/plink/220118/pLink_task_2022.02.16.12.34.07/reports/bsa_20220118_spotlinkform/WXZ_20220118_B.csv"
# plink_0118_BS1_fDR = "G:/MSdata/20220215dataanalyze/plink/220118/pLink_task_2022.02.16.12.34.07/reports/bsa_20220118_spotlinkform/WXZ_20220118_BS1.csv"
# plink_0118_BS2_fDR = "G:/MSdata/20220215dataanalyze/plink/220118/pLink_task_2022.02.16.12.34.07/reports/bsa_20220118_spotlinkform/WXZ_20220118_BS2.csv"
# plink_0118_BS3_fDR = "G:/MSdata/20220215dataanalyze/plink/220118/pLink_task_2022.02.16.12.34.07/reports/bsa_20220118_spotlinkform/WXZ_20220118_BS3.csv"
# plink_0118_BS5_fDR = "G:/MSdata/20220215dataanalyze/plink/220118/pLink_task_2022.02.16.12.34.07/reports/bsa_20220118_spotlinkform/WXZ_20220118_BS5.csv"
# plink_0118_BS10_fDR = "G:/MSdata/20220215dataanalyze/plink/220118/pLink_task_2022.02.16.12.34.07/reports/bsa_20220118_spotlinkform/WXZ_20220118_BS10.csv"
# plink_0118_BS30_fDR = "G:/MSdata/20220215dataanalyze/plink/220118/pLink_task_2022.02.16.12.34.07/reports/bsa_20220118_spotlinkform/WXZ_20220118_BS30.csv"
# plink_0118_BM10_fDR = "G:/MSdata/20220215dataanalyze/plink/220118/pLink_task_2022.02.16.12.34.07/reports/bsa_20220118_spotlinkform/WXZ_20220118_BM10.csv"

# BS1_0118_s = spotlink_report_valid_link_sfDR(spotlink_file_0118_BS1_fDR,
#                                              bsa_fasta)[0]
# BS2_0118_s = spotlink_report_valid_link_sfDR(spotlink_file_0118_BS2_fDR,
#                                              bsa_fasta)[0]
# BS3_0118_s = spotlink_report_valid_link_sfDR(spotlink_file_0118_BS3_fDR,
#                                              bsa_fasta)[0]
# BS5_0118_s = spotlink_report_valid_link_sfDR(spotlink_file_0118_BS5_fDR,
#                                              bsa_fasta)[0]
# BS10_0118_s = spotlink_report_valid_link_sfDR(spotlink_file_0118_BS10_fDR,
#                                               bsa_fasta)[0]
# BS30_0118_s = spotlink_report_valid_link_sfDR(spotlink_file_0118_BS30_fDR,
#                                               bsa_fasta)[0]
# BM10_0118_s = spotlink_report_valid_link_sfDR(spotlink_file_0118_BM10_fDR,
#                                               bsa_fasta)[0]

# BS1_0118_p = plink_report_valid_link_sfDR(plink_0118_BS1_fDR, bsa_fasta)[0]
# BS2_0118_p = plink_report_valid_link_sfDR(plink_0118_BS2_fDR, bsa_fasta)[0]
# BS3_0118_p = plink_report_valid_link_sfDR(plink_0118_BS3_fDR, bsa_fasta)[0]
# BS5_0118_p = plink_report_valid_link_sfDR(plink_0118_BS5_fDR, bsa_fasta)[0]
# BS10_0118_p = plink_report_valid_link_sfDR(plink_0118_BS10_fDR,
#                                            bsa_fasta)[0]
# BS30_0118_p = plink_report_valid_link_sfDR(plink_0118_BS30_fDR,
#                                            bsa_fasta)[0]
# BM10_0118_p = plink_report_valid_link_sfDR(plink_0118_BM10_fDR,
#                                            bsa_fasta)[0]

# BS1_repeat = cal_repeat_list(BS1_0118_p, BS1_0118_s)[0]
# BS2_repeat = cal_repeat_list(BS2_0118_p, BS2_0118_s)[0]
# BS3_repeat = cal_repeat_list(BS3_0118_p, BS3_0118_s)[0]
# BS5_repeat = cal_repeat_list(BS5_0118_p, BS5_0118_s)[0]
# BS10_repeat = cal_repeat_list(BS5_0118_p, BS10_0118_s)[0]
# BS30_repeat = cal_repeat_list(BS30_0118_p, BS30_0118_s)[0]
# BM10_repeat = cal_repeat_list(BM10_0118_p, BM10_0118_s)[0]
# op

#####

# UB
# ub_fasta = "MQIFVKTLTGKTITLEVEPSDTIENVKAKIQDKEGIPPDQQRLIFAGKQLEDGRTLSDYNIQKESTLHLVLRLRGG"
# ub_pdb = "G:/MSdata/220118UBBSA/mono_ub.pdb"

# spotlink_file_0118_U_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_U_HCDFT_result_filtered.csv'
# spotlink_file_0118_UM10_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_UM10_HCDFT_result_filtered.csv'
# spotlink_file_0118_UM1_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_UM1_HCDFT_result_filtered.csv'
# spotlink_file_0118_UM30_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_UM30_HCDFT_result_filtered.csv'
# spotlink_file_0118_US1_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_US1_HCDFT_result_filtered.csv'
# spotlink_file_0118_US5_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_US5_HCDFT_result_filtered.csv'
# spotlink_file_0118_US15_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_US15_HCDFT_result_filtered.csv'
# spotlink_file_0118_US30_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_US30_HCDFT_result_filtered.csv'
# spotlink_file_0118_US10_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_US10_HCDFT_result_filtered.csv'

# plink_0118_U_fDR = "G:/MSdata/220118UBBSA/UB_plink/pLink_task_2022.03.11.13.54.12/reports/mono_ub_20220118_spotlinkform/WXZ_20220118_U.csv"
# plink_0118_US1_fDR = "G:/MSdata/220118UBBSA/UB_plink/pLink_task_2022.03.11.13.54.12/reports/mono_ub_20220118_spotlinkform/WXZ_20220118_US1.csv"
# plink_0118_US5_fDR = "G:/MSdata/220118UBBSA/UB_plink/pLink_task_2022.03.11.13.54.12/reports/mono_ub_20220118_spotlinkform/WXZ_20220118_US5.csv"
# plink_0118_US10_fDR = "G:/MSdata/220118UBBSA/UB_plink/pLink_task_2022.03.11.13.54.12/reports/mono_ub_20220118_spotlinkform/WXZ_20220118_US10.csv"
# plink_0118_US15_fDR = "G:/MSdata/220118UBBSA/UB_plink/pLink_task_2022.03.11.13.54.12/reports/mono_ub_20220118_spotlinkform/WXZ_20220118_US15.csv"
# plink_0118_US30_fDR = "G:/MSdata/220118UBBSA/UB_plink/pLink_task_2022.03.11.13.54.12/reports/mono_ub_20220118_spotlinkform/WXZ_20220118_US30.csv"
# plink_0118_UM1_fDR = "G:/MSdata/220118UBBSA/UB_plink/pLink_task_2022.03.11.13.54.12/reports/mono_ub_20220118_spotlinkform/WXZ_20220118_UM1.csv"
# plink_0118_UM10_fDR = "G:/MSdata/220118UBBSA/UB_plink/pLink_task_2022.03.11.13.54.12/reports/mono_ub_20220118_spotlinkform/WXZ_20220118_UM10.csv"
# plink_0118_UM30_fDR = "G:/MSdata/220118UBBSA/UB_plink/pLink_task_2022.03.11.13.54.12/reports/mono_ub_20220118_spotlinkform/WXZ_20220118_UM30.csv"

# US1_0118_s = spotlink_report_valid_link_sfDR(spotlink_file_0118_US1_fDR,
#                                              ub_fasta)[0]
# US5_0118_s = spotlink_report_valid_link_sfDR(spotlink_file_0118_US5_fDR,
#                                              ub_fasta)[0]
# US10_0118_s = spotlink_report_valid_link_sfDR(spotlink_file_0118_US10_fDR,
#                                               ub_fasta)[0]
# US15_0118_s = spotlink_report_valid_link_sfDR(spotlink_file_0118_US15_fDR,
#                                               ub_fasta)[0]
# US30_0118_s = spotlink_report_valid_link_sfDR(spotlink_file_0118_US30_fDR,
#                                               ub_fasta)[0]
# UM1_0118_s = spotlink_report_valid_link_sfDR(spotlink_file_0118_UM1_fDR,
#                                              ub_fasta)[0]
# UM10_0118_s = spotlink_report_valid_link_sfDR(spotlink_file_0118_UM10_fDR,
#                                               ub_fasta)[0]
# UM30_0118_s = spotlink_report_valid_link_sfDR(spotlink_file_0118_UM30_fDR,
#                                               ub_fasta)[0]

# US1_0118_p = plink_report_valid_link_sfDR(plink_0118_US1_fDR, ub_fasta)[0]
# US5_0118_p = plink_report_valid_link_sfDR(plink_0118_US5_fDR, ub_fasta)[0]
# US10_0118_p = plink_report_valid_link_sfDR(plink_0118_US10_fDR,
#                                            ub_fasta)[0]
# US15_0118_p = plink_report_valid_link_sfDR(plink_0118_US15_fDR,
#                                            ub_fasta)[0]
# US30_0118_p = plink_report_valid_link_sfDR(plink_0118_US30_fDR,
#                                            ub_fasta)[0]
# UM1_0118_p = plink_report_valid_link_sfDR(plink_0118_UM1_fDR, ub_fasta)[0]
# UM10_0118_p = plink_report_valid_link_sfDR(plink_0118_UM10_fDR,
#                                            ub_fasta)[0]
# UM30_0118_p = plink_report_valid_link_sfDR(plink_0118_UM30_fDR,
#                                            ub_fasta)[0]

# US1_repeat = cal_repeat_list(US1_0118_p, US1_0118_s)[0]
# US5_repeat = cal_repeat_list(US5_0118_p, US5_0118_s)[0]
# US10_repeat = cal_repeat_list(US10_0118_p, US10_0118_s)[0]
# US15_repeat = cal_repeat_list(US15_0118_p, US15_0118_s)[0]
# US30_repeat = cal_repeat_list(US30_0118_p, US30_0118_s)[0]
# UM1_repeat = cal_repeat_list(UM1_0118_p, UM1_0118_s)[0]
# UM10_repeat = cal_repeat_list(UM10_0118_p, UM10_0118_s)[0]
# UM30_repeat = cal_repeat_list(UM30_0118_p, UM30_0118_s)[0]

# print("************")
# US1 = cal_repeat_list(US1_repeat, UM30_repeat)[0]
# US5 = cal_repeat_list(US5_repeat, UM30_repeat)[0]
# US10 = cal_repeat_list(US10_repeat, UM30_repeat)[0]
# US15 = cal_repeat_list(US15_repeat, UM30_repeat)[0]
# US30 = cal_repeat_list(US30_repeat, UM30_repeat)[0]
# UM10 = cal_repeat_list(UM10_repeat, UM30_repeat)[0]
# UM1 = cal_repeat_list(UM1_repeat, UM30_repeat)[0]

# dis_US1 = cal_distance_pos_list(US1_repeat,
#                                 fasta=ub_fasta,
#                                 pdb_file=ub_pdb)
# dis_US5 = cal_distance_pos_list(US5_repeat,
#                                 fasta=ub_fasta,
#                                 pdb_file=ub_pdb)
# dis_US10 = cal_distance_pos_list(US10_repeat,
#                                  fasta=ub_fasta,
#                                  pdb_file=ub_pdb)
# dis_US15 = cal_distance_pos_list(US15_repeat,
#                                  fasta=ub_fasta,
#                                  pdb_file=ub_pdb)
# dis_US30 = cal_distance_pos_list(US30_repeat,
#                                  fasta=ub_fasta,
#                                  pdb_file=ub_pdb)
# dis_UM1 = cal_distance_pos_list(UM1_repeat,
#                                 fasta=ub_fasta,
#                                 pdb_file=ub_pdb)
# dis_UM10 = cal_distance_pos_list(UM10_repeat,
#                                  fasta=ub_fasta,
#                                  pdb_file=ub_pdb)
# dis_UM30 = cal_distance_pos_list(UM30_repeat,
#                                  fasta=ub_fasta,
#                                  pdb_file=ub_pdb)

# dis_list = [
#     dis_US1, dis_US5, dis_US10, dis_US15, dis_US30, dis_UM1, dis_UM10,
#     dis_UM30
# ]

# import matplotlib.pyplot as plt

# plt.figure(figsize=(10, 5))
# plt.title('Distance of crosslink positions', fontsize=20)  #标题，并设定字号大小

# labels = ['US1', 'US5', 'US10', 'US15', 'US30', 'UM1', 'UM10', 'UM30']
# plt.boxplot(dis_list, labels=labels, showmeans=True)
# plt.show()

#####
# Selection analyze

## Def of 220223
# spotlink_file_0223_BSA_fDR = 'G:/MSdata/20220221tanglabprotein/Spotlink/BSA/JYD_20220223_BSA_HCDFT_result_filtered.csv'
# spotlink_file_0223_E1_fDR = 'G:/MSdata/20220221tanglabprotein/Spotlink/E1/JYD_20220223_E1_HCDFT_result_filtered.csv'
# spotlink_file_0223_PPASE_fDR = 'G:/MSdata/20220221tanglabprotein/Spotlink/PPASE/JYD_20220223_PPASE_HCDFT_result_filtered.csv'
# spotlink_file_0223_NSP5_fDR = 'G:/MSdata/20220221tanglabprotein/Spotlink/NSP5/JYD_20220223_NSP5_HCDFT_result_filtered.csv'
# spotlink_file_0223_AS_fDR = 'G:/MSdata/20220221tanglabprotein/Spotlink/AS/JYD_20220223_AS_HCDFT_result_filtered.csv'

# plink_0223_BSA_fDR = "G:/MSdata/20220221tanglabprotein/plink/BSA/JYD_20220223_BSA.csv"
# plink_0223_E1_fDR = "G:/MSdata/20220221tanglabprotein/plink/E1/JYD_20220223_E1.csv"
# plink_0223_PPASE_fDR = "G:/MSdata/20220221tanglabprotein/plink/PPASE/JYD_20220223_PPASE.csv"
# plink_0223_NSP5_fDR = "G:/MSdata/20220221tanglabprotein/plink/NSP5/JYD_20220223_NSP5.csv"
# plink_0223_AS_fDR = "G:/MSdata/20220221tanglabprotein/plink/AS/JYD_20220223_AS.csv"

# bsa_fasta = "DTHKSEIAHRFKDLGEEHFKGLVLIAFSQYLQQCPFDEHVKLVNELTEFAKTCVADESHAGCEKSLHTLFGDELCKVASLRETYGDMADCCEKQEPERNECFLSHKDDSPDLPKLKPDPNTLCDEFKADEKKFWGKYLYEIARRHPYFYAPELLYYANKYNGVFQECCQAEDKGACLLPKIETMREKVLTSSARQRLRCASIQKFGERALKAWSVARLSQKFPKAEFVEVTKLVTDLTKVHKECCHGDLLECADDRADLAKYICDNQDTISSKLKECCDKPLLEKSHCIAEVEKDAIPENLPPLTADFAEDKDVCKNYQEAKDAFLGSFLYEYSRRHPEYAVSVLLRLAKEYEATLEECCAKDDPHACYSTVFDKLKHLVDEPQNLIKQNCDQFEKLGEYGFQNALIVRYTRKVPQVSTPTLVEVSRSLGKVGTRCCTKPESERMPCTEDYLSLILNRLCVLHEKTPVSEKVTKCCTESLVNRRPCFSALTPDETYVPKAFDEKLFTFHADICTLPDTEKQIKKQTALVELLKHKPKATEEQLKTVMENFVAFVDKCCAADDKEACFAVEGPKLVVSTQTALA"

# BSA_0223_p = plink_report_valid_link_sfDR(plink_0223_BSA_fDR, bsa_fasta)[0]
# BSA_0223_s = spotlink_report_valid_link_sfDR(spotlink_file_0223_BSA_fDR,
#                                              bsa_fasta)[0]

# BSA_repeat = cal_repeat_list(BSA_0223_p, BSA_0223_s)[0]

# E1_fasta = "MTTVLYYLPASPPCRSVLLLAKMIGVELDLKVLNIMEGEQLKPDFVELNPQHCIPTMDDHGLVLWESRVILSYLVSAYGKDENLYPKDFRSRAIVDQRLHFDLGTLYQRVVDYYFPTIHLGAHLDQTKKAKLAEALGWFEAMLKQYQWSAANHFTIADIALCVTVSQIEAFQFDLHPYPRVRAWLLKCKDELEGHGYKEINETGAETLAGLFRSKLKQSDLVPRGSMSSSPLSKKRRVSGPDPKPGSNCSPAQSVLSEVPSVPTNGMAKNGSEADIDEGLYSRQLYVLGHEAMKRLQTSSVLVSGLRGLGVEIAKNIILGGVKAVTLHDQGTAQWADLSSQFYLREEDIGKNRAEVSQPRLAELNSYVPVTAYTGPLVEDFLSGFQVVVLTNTPLEDQLRVGEFCHNRGIKLVVADTRGLFGQLFCDFGEEMILTDSNGEQPLSAMVSMVTKDNPGVVTCLDEARHGFESGDFVSFSEVQGMVELNGNQPMEIKVLGPYTFSICDTSNFSDYIRGGIVSQVKVPKKISFKSLVASLAEPDFVVTDFAKFSRPAQLHIGFQALHQFCAQHGRPPRPRNEEDAAELVALAQAVNARALPAVQQNNLDEDLIRKLAYVAAGDLAPINAFIGGLAAQEVMKACSGKFMPIMQWLYFDALECLPEDKEVLTEDKCLQRQNRYDGQVAVFGSDLQEKLGKQKYFLVGAGAIGCELLKNFAMIGLGCGEGGEIIVTDMDTIEKSNLNRQFLFRPWDVTKLKSDTAAAAVRQMNPHIRVTSHQNRVGPDTERIYDDDFFQNLDGVANALDNVDARMYMDRRCVYYRKPLLESGTLGTKGNVQVVIPFLTESYSSSQDPPEKSIPICTLKNFPNAIEHTLQWARDEFEGLFKQPAENVNQYLTDPKFVERTLRLAGTQPLEVLEAVQRSLVLQRPQTWADCVTWACHHWHTQYSNNIRQLLHNFPPDQLTSSGAPFWSGPKRCPHPLTFDVNNPLHLDYVMAAANLFAQTYGLTGSQDRAAVATFLQSVQVPEFTPKSGVKIHVSDQELQSANASVDDSRLEELKATLPSPDKLPGFKMYPIDFEKDDDSNFHMDFIVAASNLRAENYDIPSADRHKSKLIAGKIIPAIATTTAAVVGLVCLELYKVVQGHRQLDSYKNGFLNLALPFFGFSEPLAAPRHQYYNQEWTLWDRFEVQGLQPNGEEMTLKQFLDYFKTEHKLEITMLSQGVSMLYSFFMPAAKLKERLDQPMTEIVSRVSKRKLGRHVRALVLELCCNDESGEDVEVPYVRYTIR"
# E1_0223_p = plink_report_valid_link_sfDR(plink_0223_E1_fDR, E1_fasta)[0]
# E1_0223_s = spotlink_report_valid_link_sfDR(spotlink_file_0223_E1_fDR,
#                                             E1_fasta)[0]
# E1_repeat = cal_repeat_list(E1_0223_p, E1_0223_s)[0]

# PPASE_fasta = "MSPILGYWKIKGLVQPTRLLLEYLEEKYEEHLYERDEGDKWRNKKFELGLEFPNLPYYIDGDVKLTQSMAIIRYIADKHNMLGGCPKERAEISMLEGAVLDIRYGVSRIAYSKDFETLKVDFLSKLPEMLKMFEDRLCHKTYLNGDHVTHPDFMLYDALDVVLYMDPMCLDAFPKLVCFKKRIEAIPQIDKYLKSSKYIAWPLQGWQATFGGGDHPPKSDLVPRGSGGGPNTEFALSLLRKNIMTITTSKGEFTGLGIHDRVCVIPTHAQPGDDVLVNGQKIRVKDKYKLVDPENINLELTVLTLDRNEKFRDIRGFISEDLEGVDATLVVHSNNFTNTILEVGPVTMAGLINLSSTPTNRMIRYDYATKTGQCGGVLCATGKIFGIHVGGNGRQGFSAQLKKQYFVEKQ"
# PPASE_0223_p = plink_report_valid_link_sfDR(plink_0223_PPASE_fDR,
#                                             PPASE_fasta)[0]
# PPASE_0223_s = spotlink_report_valid_link_sfDR(
#     spotlink_file_0223_PPASE_fDR, PPASE_fasta)[0]
# PPASE_repeat = cal_repeat_list(PPASE_0223_p, PPASE_0223_s)[0]

# NSP5_fasta = "SGFRKMAFPSGKVEGCMVQVTCGTTTLNGLWLDDVVYCPRHVICTSEDMLNPNYEDLLIRKSNHNFLVQAGNVQLRVIGHSMQNCVLKLKVDTANPKTPKYKFVRIQPGQTFSVLACYNGSPSGVYQCAMRPNFTIKGSFLNGSAGSVGFNIDYDCVSFCYMHHMELPTGVHAGTDLEGNFYGPFVDRQTAQAAGTDTTITVNVLAWLYAAVINGDRWFLNRFTTTLNDFNLVAMKYNYEPLTQDHVDILGPLSAQTGIAVLDMCASLKELLQNGMNGRTILGSALLEDEFTPFDVVRQCSGVTFQSAVKRT"
# NSP5_0223_p = plink_report_valid_link_sfDR(plink_0223_NSP5_fDR,
#                                            NSP5_fasta)[0]
# NSP5_0223_s = spotlink_report_valid_link_sfDR(spotlink_file_0223_NSP5_fDR,
#                                               NSP5_fasta)[0]
# NSP5_repeat = cal_repeat_list(NSP5_0223_p, NSP5_0223_s)[0]

# AS_fasta = "MDVFMKGLSKAKEGVVAAAEKTKQGVAEAAGKTKEGVLYVGSKTKEGVVHGVATVAEKTKEQVTNVGGAVVTGVTAVAQKTVEGAGSIAAATGFVKKDQLGKNEEGAPQEGILEDMPVDPDNEAYEMPSEEGYQDYEPEA"
# AS_0223_p = plink_report_valid_link_sfDR(plink_0223_AS_fDR, AS_fasta)[0]
# AS_0223_s = spotlink_report_valid_link_sfDR(spotlink_file_0223_AS_fDR,
#                                             AS_fasta)[0]
# AS_repeat = cal_repeat_list(AS_0223_p, AS_0223_s)[0]

# dis_BSA = cal_distance_pos_list(BSA_repeat)
# dis_E1 = cal_distance_pos_list(
#     E1_repeat,
#     fasta=E1_fasta,
#     pdb_file="G:/MSdata/20220221tanglabprotein/E1.pdb")
# dis_PPASE = cal_distance_pos_list(
#     PPASE_repeat,
#     fasta=PPASE_fasta,
#     pdb_file="G:/MSdata/20220221tanglabprotein/PPASE.pdb")
# dis_NSP5 = cal_distance_pos_list(
#     NSP5_repeat,
#     fasta=NSP5_fasta,
#     pdb_file="G:/MSdata/20220221tanglabprotein/NSP5.pdb")
# dis_AS = cal_distance_pos_list(
#     AS_repeat,
#     fasta=AS_fasta,
#     pdb_file="G:/MSdata/20220221tanglabprotein/AS.pdb")
# dis_UB = cal_distance_pos_list(US5_repeat, fasta=ub_fasta, pdb_file=ub_pdb)

# dis_list = [dis_BSA, dis_E1, dis_PPASE, dis_NSP5, dis_UB]

# import matplotlib.pyplot as plt

# plt.figure(figsize=(10, 5))
# plt.title('Distance of crosslink positions', fontsize=20)  #标题，并设定字号大小

# labels = ['BSA', 'E1', 'PPASE', 'NSP5', 'UB']
# plt.boxplot(dis_list, labels=labels, showmeans=True)
# plt.show()

## Amino ratio report
# print("***********")
# report_animo_ratio(BSA_repeat,
#                    pos_form=True,
#                    fasta_file=bsa_fasta,
#                    tableform=True)
# report_animo_ratio(E1_repeat,
#                    pos_form=True,
#                    fasta_file=E1_fasta,
#                    tableform=True)
# report_animo_ratio(PPASE_repeat,
#                    pos_form=True,
#                    fasta_file=PPASE_fasta,
#                    tableform=True)
# report_animo_ratio(NSP5_repeat,
#                    pos_form=True,
#                    fasta_file=NSP5_fasta,
#                    tableform=True)
# report_animo_ratio(AS_repeat,
#                    pos_form=True,
#                    fasta_file=AS_fasta,
#                    tableform=True)
# report_animo_ratio(US5_repeat,
#                    pos_form=True,
#                    fasta_file=ub_fasta,
#                    tableform=True)

# for j in [
#         bsa_fasta, E1_fasta, PPASE_fasta, NSP5_fasta, AS_fasta, ub_fasta
# ]:
#     calc_fasta(j, table_form=True)
#     analyze_neighborhood(j, percent=True, table_form=True)

# analyze_distance_neighboorhood(E1_fasta,
#                                "G:/MSdata/20220221tanglabprotein/E1.pdb")

# 220805-BSA-modify-power

# bsa_fasta = "MKWVTFISLLLLFSSAYSRGVFRRDTHKSEIAHRFKDLGEEHFKGLVLIAFSQYLQQCPFDEHVKLVNELTEFAKTCVADESHAGCEKSLHTLFGDELCKVASLRETYGDMADCCEKQEPERNECFLSHKDDSPDLPKLKPDPNTLCDEFKADEKKFWGKYLYEIARRHPYFYAPELLYYANKYNGVFQECCQAEDKGACLLPKIETMREKVLTSSARQRLRCASIQKFGERALKAWSVARLSQKFPKAEFVEVTKLVTDLTKVHKECCHGDLLECADDRADLAKYICDNQDTISSKLKECCDKPLLEKSHCIAEVEKDAIPENLPPLTADFAEDKDVCKNYQEAKDAFLGSFLYEYSRRHPEYAVSVLLRLAKEYEATLEECCAKDDPHACYSTVFDKLKHLVDEPQNLIKQNCDQFEKLGEYGFQNALIVRYTRKVPQVSTPTLVEVSRSLGKVGTRCCTKPESERMPCTEDYLSLILNRLCVLHEKTPVSEKVTKCCTESLVNRRPCFSALTPDETYVPKAFDEKLFTFHADICTLPDTEKQIKKQTALVELLKHKPKATEEQLKTVMENFVAFVDKCCAADDKEACFAVEGPKLVVSTQTALA"

# # plink2crosslink(
# #     "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/bsa_2022.03.26.filtered_cross-linked_spectra.csv",
# #     "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/"
# # )

# spotlink_file_0322_B_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_B_HCDFT_result_filtered.csv'
# spotlink_file_0322_BO_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_BO_HCDFT_result_filtered.csv'
# spotlink_file_0322_BN_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_BN_HCDFT_result_filtered.csv'
# spotlink_file_0322_BU_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_BU_HCDFT_result_filtered.csv'
# spotlink_file_0322_B1_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_B1_HCDFT_result_filtered.csv'
# spotlink_file_0322_B5_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_B5_HCDFT_result_filtered.csv'
# spotlink_file_0322_B50_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_B50_HCDFT_result_filtered.csv'
# spotlink_file_0322_B500_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_B500_HCDFT_result_filtered.csv'
# spotlink_file_0322_B1000_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_B1000_HCDFT_result_filtered.csv'

# crosslink_file_0118_BM10_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_BM10_HCDFT_result_filtered.csv'

# plink_0322_B_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_B.csv"
# plink_0322_BO_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_BO.csv"
# plink_0322_BU_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_BU.csv"
# plink_0322_BN_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_BN.csv"
# plink_0322_B1_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_B1.csv"
# plink_0322_B5_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_B5.csv"
# plink_0322_B50_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_B50.csv"
# plink_0322_B500_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_B500.csv"
# plink_0322_B1000_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_B1000.csv"

# B_0322_s = spotlink_report_valid_link_sfDR(spotlink_file_0322_B_fDR,
#                                            bsa_fasta)[0]
# BO_0322_s = spotlink_report_valid_link_sfDR(spotlink_file_0322_BO_fDR,
#                                             bsa_fasta)[0]
# BN_0322_s = spotlink_report_valid_link_sfDR(spotlink_file_0322_BN_fDR,
#                                             bsa_fasta)[0]
# BU_0322_s = spotlink_report_valid_link_sfDR(spotlink_file_0322_BU_fDR,
#                                             bsa_fasta)[0]
# B1_0322_s = spotlink_report_valid_link_sfDR(spotlink_file_0322_B1_fDR,
#                                             bsa_fasta)[0]
# B5_0322_s = spotlink_report_valid_link_sfDR(spotlink_file_0322_B5_fDR,
#                                             bsa_fasta)[0]
# B50_0322_s = spotlink_report_valid_link_sfDR(spotlink_file_0322_B50_fDR,
#                                              bsa_fasta)[0]
# B500_0322_s = spotlink_report_valid_link_sfDR(spotlink_file_0322_B500_fDR,
#                                               bsa_fasta)[0]
# B1000_0322_s = spotlink_report_valid_link_sfDR(spotlink_file_0322_B1000_fDR,
#                                                bsa_fasta)[0]
# BM10_0118_s = spotlink_report_valid_link_sfDR(crosslink_file_0118_BM10_fDR,
#                                               bsa_fasta,
#                                               least_ssn=1,
#                                               threshold=0.8)[0]

# B_0322_p = plink_report_valid_link_sfDR(plink_0322_B_fDR, bsa_fasta)[0]
# BO_0322_p = plink_report_valid_link_sfDR(plink_0322_BO_fDR, bsa_fasta)[0]
# BU_0322_p = plink_report_valid_link_sfDR(plink_0322_BU_fDR, bsa_fasta)[0]
# BN_0322_p = plink_report_valid_link_sfDR(plink_0322_BN_fDR, bsa_fasta)[0]
# B1_0322_p = plink_report_valid_link_sfDR(plink_0322_B1_fDR, bsa_fasta)[0]
# B5_0322_p = plink_report_valid_link_sfDR(plink_0322_B5_fDR, bsa_fasta)[0]
# B50_0322_p = plink_report_valid_link_sfDR(plink_0322_B50_fDR, bsa_fasta)[0]
# B500_0322_p = plink_report_valid_link_sfDR(plink_0322_B500_fDR, bsa_fasta)[0]
# B1000_0322_p = plink_report_valid_link_sfDR(plink_0322_B1000_fDR, bsa_fasta)[0]
# print("-------------")

# B_repeat = cal_repeat_list(B_0322_p, B_0322_s)[0]
# BO_repeat = cal_repeat_list(BO_0322_p, BO_0322_s)[0]
# BU_repeat = cal_repeat_list(BU_0322_p, BU_0322_s)[0]
# BN_repeat = cal_repeat_list(BN_0322_p, BN_0322_s)[0]
# B1_repeat = cal_repeat_list(B1_0322_p, B1_0322_s)[0]
# B5_repeat = cal_repeat_list(B5_0322_p, B5_0322_s)[0]
# B50_repeat = cal_repeat_list(B50_0322_p, B50_0322_s)[0]
# B500_repeat = cal_repeat_list(B500_0322_p, B500_0322_s)[0]
# B1000_repeat = cal_repeat_list(B1000_0322_p, B1000_0322_s)[0]
# # Contrast with standard
# print("-------------")
# print(len(BM10_0118_s))
# B_repeat = cal_repeat_list(B_repeat, BM10_0118_s)[0]
# B1_repeat = cal_repeat_list(B1_repeat, BM10_0118_s)[0]
# BO_repeat = cal_repeat_list(BO_repeat, BM10_0118_s)[0]
# B5_repeat = cal_repeat_list(B5_repeat, BM10_0118_s)[0]
# B50_repeat = cal_repeat_list(B50_repeat, BM10_0118_s)[0]
# B500_repeat = cal_repeat_list(B500_repeat, BM10_0118_s)[0]
# B1000_repeat = cal_repeat_list(B1000_repeat, BM10_0118_s)[0]
# print("-------------")

# repeat_list_0322 = [
#     B_repeat, B1_repeat, BO_repeat, B5_repeat, B50_repeat, B500_repeat,
#     B1000_repeat
# ]

# list_0322_s = [
#     B_0322_s, BO_0322_s, BN_0322_s, BU_0322_s, B1_0322_s, B5_0322_s,
#     B50_0322_s, B500_0322_s, B1000_0322_s
# ]

# list_0322_p = [
#     B_0322_p, BO_0322_p, BN_0322_p, BU_0322_p, B1_0322_p, B5_0322_p,
#     B50_0322_p, B500_0322_p, B1000_0322_p
# ]

# # for i in list_0322_s:
# #     cal_distance_pos_list(i[0:100], print_all=False)

# for i in repeat_list_0322:
#     report_animo_ratio(i,
#                        pos_form=True,
#                        fasta_file=bsa_fasta,
#                        tableform=True,
#                        ratio_output=True,
#                        threshold=40)

# ADK

# adk_fasta = "MRIILLGAPGAGKGTQAQFIMEKYGIPQISTGDMLRAAVKSGSELGKQAKDIMDAGKLVTDELVIALVKERIAQEDCRNGFLLDGFPRTIPQADAMKEAGINVDYVLEFDVPDELIVDRIVGRRVHAPSGRVYHVKFNPPKVEGKDDVTGEELTTRKDDQEETVRKRLVEYHQMTAPLIGYYSKEAEAGNTKYAKVDGTKPVAEVRADLEKILG"
# # plink2crosslink(
# #     "G:/MSdata/220329ADK/adk/plink/pLink_task_2022.04.02.20.19.24/reports/adk_2022.04.02.filtered_cross-linked_spectra.csv",
# #     "G:/MSdata/220329ADK/adk/plink/pLink_task_2022.04.02.20.19.24/reports/crosslink_spotlinkform/"
# # )
# plink_0329_ADK_fDR = "G:/MSdata/220329ADK/adk/plink/pLink_task_2022.04.02.20.19.24/reports/crosslink_spotlinkform/WXZ_20220329_AdK.csv"
# plink_0329_ADKC_fDR = "G:/MSdata/220329ADK/adk/plink/pLink_task_2022.04.02.20.19.24/reports/crosslink_spotlinkform/WXZ_20220329_AdKC.csv"

# spotlink_file_0329_ADK_fDR = 'G:/MSdata/220329ADK/adk/spotlink/WXZ_20220329_AdK_HCDFT_result_filtered.csv'
# spotlink_file_0329_ADKC_fDR = 'G:/MSdata/220329ADK/adk/spotlink/WXZ_20220329_AdKC_HCDFT_result_filtered.csv'

# ADK_0329_s = spotlink_report_valid_link_sfDR(spotlink_file_0329_ADK_fDR,
#                                              adk_fasta)[0]
# ADKC_0329_s = spotlink_report_valid_link_sfDR(spotlink_file_0329_ADKC_fDR,
#                                               adk_fasta)[0]

# ADK_0329_p = plink_report_valid_link_sfDR(plink_0329_ADK_fDR, adk_fasta)[0]
# ADKC_0329_p = plink_report_valid_link_sfDR(plink_0329_ADKC_fDR, adk_fasta)[0]

# ADK_repeat = cal_repeat_list(ADK_0329_s, ADK_0329_p)[0]
# ADKC_repeat = cal_repeat_list(ADKC_0329_s, ADKC_0329_p)[0]

# report_animo_ratio(ADK_repeat,
#                    pos_form=True,
#                    fasta_file=adk_fasta,
#                    tableform=True)
# report_animo_ratio(ADKC_repeat,
#                    pos_form=True,
#                    fasta_file=adk_fasta,
#                    tableform=True)
# calc_fasta(adk_fasta, table_form=True)

# from pymol import cmd

# for i in ADKC_repeat:
#     dis = cal_distance(int(i[0]), int(i[1]), 'G:/MSdata/220329ADK/adk/adk.pdb')
#     print(i, dis, adk_fasta[int(i[0]) - 1], adk_fasta[int(i[1]) - 1])
#     cmd.distance(
#         str(i[0]) + '-' + str(i[1]), "(/adk//A/" + str(i[0]) + "/CA)",
#         "( /adk//A/" + str(i[1]) + "/CA)")

# 220812
    #BSA
    print("*" * 40)
    print("--BSA--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/22020802BARSN_modify_power/Spotlink/"
    plink_root_dir = "G:/MSdata/22020802BARSN_modify_power/Plink/Plink_CL_spotlinkform/"
    ### fasta
    bsa_fasta = "MKWVTFISLLLLFSSAYSRGVFRRDTHKSEIAHRFKDLGEEHFKGLVLIAFSQYLQQCPFDEHVKLVNELTEFAKTCVADESHAGCEKSLHTLFGDELCKVASLRETYGDMADCCEKQEPERNECFLSHKDDSPDLPKLKPDPNTLCDEFKADEKKFWGKYLYEIARRHPYFYAPELLYYANKYNGVFQECCQAEDKGACLLPKIETMREKVLTSSARQRLRCASIQKFGERALKAWSVARLSQKFPKAEFVEVTKLVTDLTKVHKECCHGDLLECADDRADLAKYICDNQDTISSKLKECCDKPLLEKSHCIAEVEKDAIPENLPPLTADFAEDKDVCKNYQEAKDAFLGSFLYEYSRRHPEYAVSVLLRLAKEYEATLEECCAKDDPHACYSTVFDKLKHLVDEPQNLIKQNCDQFEKLGEYGFQNALIVRYTRKVPQVSTPTLVEVSRSLGKVGTRCCTKPESERMPCTEDYLSLILNRLCVLHEKTPVSEKVTKCCTESLVNRRPCFSALTPDETYVPKAFDEKLFTFHADICTLPDTEKQIKKQTALVELLKHKPKATEEQLKTVMENFVAFVDKCCAADDKEACFAVEGPKLVVSTQTALA"
    ### file_dir
    spotlink_file_0805_B_fDR = spotlink_root_dir + 'JYD_20220727_B_HCDFT_result_filtered.csv'
    spotlink_file_0805_B5_fDR = spotlink_root_dir + 'JYD_20220727_B5_HCDFT_result_filtered.csv'
    spotlink_file_0805_B25_fDR = spotlink_root_dir + 'JYD_20220727_B25_HCDFT_result_filtered.csv'
    spotlink_file_0805_B125_fDR = spotlink_root_dir + 'JYD_20220727_B125_HCDFT_result_filtered.csv'
    spotlink_file_0805_B625_fDR = spotlink_root_dir + 'JYD_20220727_B625_HCDFT_result_filtered.csv'
    spotlink_file_0805_BF_fDR = spotlink_root_dir + 'JYD_20220727_BF_HCDFT_result_filtered.csv'
    plink_file_0805_B_fDR = plink_root_dir + "JYD_20220727_B.csv"
    plink_file_0805_B5_fDR = plink_root_dir + "JYD_20220727_B5.csv"
    plink_file_0805_B25_fDR = plink_root_dir + "JYD_20220727_B25.csv"
    plink_file_0805_B125_fDR = plink_root_dir + "JYD_20220727_B125.csv"
    plink_file_0805_B625_fDR = plink_root_dir + "JYD_20220727_B625.csv"
    plink_file_0805_BF_fDR = plink_root_dir + "JYD_20220727_BF.csv"
    B_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B_fDR,
                                               bsa_fasta)[0]
    B5_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B5_fDR,
                                                bsa_fasta)[0]
    B25_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B25_fDR,
                                                 bsa_fasta)[0]
    B125_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B125_fDR,
                                                  bsa_fasta)[0]
    B625_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B625_fDR,
                                                  bsa_fasta)[0]
    BF_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_BF_fDR,
                                                bsa_fasta,
                                                f2sf=False)[0]
    B_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B_fDR,
                                            bsa_fasta)[0]
    B5_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B5_fDR,
                                             bsa_fasta)[0]
    B25_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B25_fDR,
                                              bsa_fasta)[0]
    B125_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B125_fDR,
                                               bsa_fasta)[0]
    B625_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B625_fDR,
                                               bsa_fasta)[0]
    BF_0805_p = plink_report_valid_link_sfDR(plink_file_0805_BF_fDR,
                                             bsa_fasta)[0]
    ## repeat part

    B_repeat = cal_multi_list([B_0805_s, BF_0805_s])
    B5_repeat = cal_multi_list([B5_0805_s, BF_0805_s])
    B25_repeat = cal_multi_list([B25_0805_s, BF_0805_s])
    B125_repeat = cal_multi_list([B125_0805_s, BF_0805_s])
    B625_repeat = cal_multi_list([B625_0805_s, BF_0805_s])
    # B_repeat = cal_multi_list([B_0805_s, B_0805_p])
    # B5_repeat = cal_multi_list([B5_0805_s, B5_0805_p])
    # B25_repeat = cal_multi_list([B25_0805_s, B25_0805_p])
    # B125_repeat = cal_multi_list([B125_0805_s, B125_0805_p])
    # B625_repeat = cal_multi_list([B625_0805_s, B625_0805_p])
    # B_repeat = cal_multi_list([B_0805_s, B_0805_s])
    # B5_repeat = cal_multi_list([B5_0805_s, B5_0805_s])
    # B25_repeat = cal_multi_list([B25_0805_s, B25_0805_s])
    # B125_repeat = cal_multi_list([B125_0805_s, B125_0805_s])
    # B625_repeat = cal_multi_list([B625_0805_s, B625_0805_s])
    B_repeat_list = [B_repeat, B5_repeat, B25_repeat, B125_repeat, B625_repeat]
    B_0805_s_list = [
        B_0805_s, B5_0805_s, B25_0805_s, B125_0805_s, B625_0805_s, BF_0805_s
    ]

    for i in B_repeat_list:
        report_animo_ratio(i,
                           pos_form=True,
                           fasta_file=bsa_fasta,
                           tableform=True,
                           ratio_output=True,
                           threshold=50)

    # RSV_CA
    print("*" * 40)
    print("--RSV--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/22020802BARSN_modify_power/Spotlink/"
    plink_root_dir = "G:/MSdata/22020802BARSN_modify_power/Plink/Plink_CL_spotlinkform/"
    ### fasta
    bsa_fasta = "MASMTGGQQMGRGSEFMPVVIKTEGPAWTPLEPKLITRLADTVRTKGLRSPITMAEVEALMSSPLLPHDVTNLMRVILGPAPYALWMDAWGVQLQTVIAAATRDPRHPANGQGRGERTNLNRLKGLADGMVGNPQGQAALLRPGELVAITASALQAFREVARLAEPAGPWADIMQGPSESFVDFANRLIKAVEGSDLPPSARAPVIIDSFRQKSQPDIQQLIRTAPSTLTTPGEIIKYVLDRQKTAPLTDQGIAAAM"
    ### file_dir

    spotlink_file_0805_B_fDR = spotlink_root_dir + 'JYD_20220727_R_HCDFT_result_filtered.csv'
    spotlink_file_0805_B5_fDR = spotlink_root_dir + 'JYD_20220727_R5_HCDFT_result_filtered.csv'
    spotlink_file_0805_B25_fDR = spotlink_root_dir + 'JYD_20220727_R25_HCDFT_result_filtered.csv'
    spotlink_file_0805_B125_fDR = spotlink_root_dir + 'JYD_20220727_R125_HCDFT_result_filtered.csv'
    spotlink_file_0805_B625_fDR = spotlink_root_dir + 'JYD_20220727_R625_HCDFT_result_filtered.csv'
    spotlink_file_0805_BF_fDR = spotlink_root_dir + 'JYD_20220727_RF_HCDFT_result_filtered.csv'
    plink_file_0805_B_fDR = plink_root_dir + "JYD_20220727_R.csv"
    plink_file_0805_B5_fDR = plink_root_dir + "JYD_20220727_R5.csv"
    plink_file_0805_B25_fDR = plink_root_dir + "JYD_20220727_R25.csv"
    plink_file_0805_B125_fDR = plink_root_dir + "JYD_20220727_R125.csv"
    plink_file_0805_B625_fDR = plink_root_dir + "JYD_20220727_R625.csv"
    plink_file_0805_BF_fDR = plink_root_dir + "JYD_20220727_RF.csv"
    B_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B_fDR,
                                               bsa_fasta)[0]
    B5_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B5_fDR,
                                                bsa_fasta)[0]
    B25_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B25_fDR,
                                                 bsa_fasta)[0]
    B125_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B125_fDR,
                                                  bsa_fasta)[0]
    B625_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B625_fDR,
                                                  bsa_fasta)[0]
    BF_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_BF_fDR,
                                                bsa_fasta)[0]
    B_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B_fDR,
                                            bsa_fasta)[0]
    B5_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B5_fDR,
                                             bsa_fasta)[0]
    B25_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B25_fDR,
                                              bsa_fasta)[0]
    B125_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B125_fDR,
                                               bsa_fasta)[0]
    B625_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B625_fDR,
                                               bsa_fasta)[0]
    BF_0805_p = plink_report_valid_link_sfDR(plink_file_0805_BF_fDR,
                                             bsa_fasta)[0]
    ## repeat part

    B_repeat = cal_multi_list([B_0805_s, BF_0805_s])
    B5_repeat = cal_multi_list([B5_0805_s, BF_0805_s])
    B25_repeat = cal_multi_list([B25_0805_s, BF_0805_s])
    B125_repeat = cal_multi_list([B125_0805_s, BF_0805_s])
    B625_repeat = cal_multi_list([B625_0805_s, BF_0805_s])
    # B_repeat = cal_multi_list([B_0805_s, B_0805_s])
    # B5_repeat = cal_multi_list([B5_0805_s, B5_0805_s])
    # B25_repeat = cal_multi_list([B25_0805_s, B25_0805_s])
    # B125_repeat = cal_multi_list([B125_0805_s, B125_0805_s])
    # B625_repeat = cal_multi_list([B625_0805_s, B625_0805_s])
    B_repeat_list = [B_repeat, B5_repeat, B25_repeat, B125_repeat, B625_repeat]

    for i in B_repeat_list:
        report_animo_ratio(i,
                           pos_form=True,
                           fasta_file=bsa_fasta,
                           tableform=True,
                           ratio_output=True,
                           threshold=12)

    # E1
    print("*" * 40)
    print("--E1--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/22020802BARSN_modify_power/Spotlink/"
    plink_root_dir = "G:/MSdata/22020802BARSN_modify_power/Plink/Plink_CL_spotlinkform/"
    ### fasta
    bsa_fasta = "MTTVLYYLPASPPCRSVLLLAKMIGVELDLKVLNIMEGEQLKPDFVELNPQHCIPTMDDHGLVLWESRVILSYLVSAYGKDENLYPKDFRSRAIVDQRLHFDLGTLYQRVVDYYFPTIHLGAHLDQTKKAKLAEALGWFEAMLKQYQWSAANHFTIADIALCVTVSQIEAFQFDLHPYPRVRAWLLKCKDELEGHGYKEINETGAETLAGLFRSKLKQSDLVPRGSMSSSPLSKKRRVSGPDPKPGSNCSPAQSVLSEVPSVPTNGMAKNGSEADIDEGLYSRQLYVLGHEAMKRLQTSSVLVSGLRGLGVEIAKNIILGGVKAVTLHDQGTAQWADLSSQFYLREEDIGKNRAEVSQPRLAELNSYVPVTAYTGPLVEDFLSGFQVVVLTNTPLEDQLRVGEFCHNRGIKLVVADTRGLFGQLFCDFGEEMILTDSNGEQPLSAMVSMVTKDNPGVVTCLDEARHGFESGDFVSFSEVQGMVELNGNQPMEIKVLGPYTFSICDTSNFSDYIRGGIVSQVKVPKKISFKSLVASLAEPDFVVTDFAKFSRPAQLHIGFQALHQFCAQHGRPPRPRNEEDAAELVALAQAVNARALPAVQQNNLDEDLIRKLAYVAAGDLAPINAFIGGLAAQEVMKACSGKFMPIMQWLYFDALECLPEDKEVLTEDKCLQRQNRYDGQVAVFGSDLQEKLGKQKYFLVGAGAIGCELLKNFAMIGLGCGEGGEIIVTDMDTIEKSNLNRQFLFRPWDVTKLKSDTAAAAVRQMNPHIRVTSHQNRVGPDTERIYDDDFFQNLDGVANALDNVDARMYMDRRCVYYRKPLLESGTLGTKGNVQVVIPFLTESYSSSQDPPEKSIPICTLKNFPNAIEHTLQWARDEFEGLFKQPAENVNQYLTDPKFVERTLRLAGTQPLEVLEAVQRSLVLQRPQTWADCVTWACHHWHTQYSNNIRQLLHNFPPDQLTSSGAPFWSGPKRCPHPLTFDVNNPLHLDYVMAAANLFAQTYGLTGSQDRAAVATFLQSVQVPEFTPKSGVKIHVSDQELQSANASVDDSRLEELKATLPSPDKLPGFKMYPIDFEKDDDSNFHMDFIVAASNLRAENYDIPSADRHKSKLIAGKIIPAIATTTAAVVGLVCLELYKVVQGHRQLDSYKNGFLNLALPFFGFSEPLAAPRHQYYNQEWTLWDRFEVQGLQPNGEEMTLKQFLDYFKTEHKLEITMLSQGVSMLYSFFMPAAKLKERLDQPMTEIVSRVSKRKLGRHVRALVLELCCNDESGEDVEVPYVRYTIR"
    ### file_dir

    spotlink_file_0805_B_fDR = spotlink_root_dir + 'JYD_20220727_E_HCDFT_result_filtered.csv'
    spotlink_file_0805_B5_fDR = spotlink_root_dir + 'JYD_20220727_E5_HCDFT_result_filtered.csv'
    spotlink_file_0805_B25_fDR = spotlink_root_dir + 'JYD_20220727_E25_HCDFT_result_filtered.csv'
    spotlink_file_0805_B125_fDR = spotlink_root_dir + 'JYD_20220727_E125_HCDFT_result_filtered.csv'
    spotlink_file_0805_B625_fDR = spotlink_root_dir + 'JYD_20220727_E625_HCDFT_result_filtered.csv'
    spotlink_file_0805_BF_fDR = spotlink_root_dir + 'JYD_20220727_EF_HCDFT_result_filtered.csv'
    plink_file_0805_B_fDR = plink_root_dir + "JYD_20220727_E.csv"
    plink_file_0805_B5_fDR = plink_root_dir + "JYD_20220727_E5.csv"
    plink_file_0805_B25_fDR = plink_root_dir + "JYD_20220727_E25.csv"
    plink_file_0805_B125_fDR = plink_root_dir + "JYD_20220727_E125.csv"
    plink_file_0805_B625_fDR = plink_root_dir + "JYD_20220727_E625.csv"
    plink_file_0805_BF_fDR = plink_root_dir + "JYD_20220727_EF.csv"
    B_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B_fDR,
                                               bsa_fasta)[0]
    B5_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B5_fDR,
                                                bsa_fasta)[0]
    B25_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B25_fDR,
                                                 bsa_fasta)[0]
    B125_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B125_fDR,
                                                  bsa_fasta)[0]
    B625_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B625_fDR,
                                                  bsa_fasta)[0]
    BF_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_BF_fDR,
                                                bsa_fasta)[0]
    B_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B_fDR,
                                            bsa_fasta)[0]
    B5_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B5_fDR,
                                             bsa_fasta)[0]
    B25_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B25_fDR,
                                              bsa_fasta)[0]
    B125_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B125_fDR,
                                               bsa_fasta)[0]
    B625_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B625_fDR,
                                               bsa_fasta)[0]
    BF_0805_p = plink_report_valid_link_sfDR(plink_file_0805_BF_fDR,
                                             bsa_fasta)[0]
    ## repeat part

    B_repeat = cal_multi_list([B_0805_s, BF_0805_s])
    B5_repeat = cal_multi_list([B5_0805_s, BF_0805_s])
    B25_repeat = cal_multi_list([B25_0805_s, BF_0805_s])
    B125_repeat = cal_multi_list([B125_0805_s, BF_0805_s])
    B625_repeat = cal_multi_list([B625_0805_s, BF_0805_s])
    # B_repeat = cal_multi_list([B_0805_s, B_0805_s])
    # B5_repeat = cal_multi_list([B5_0805_s, B5_0805_s])
    # B25_repeat = cal_multi_list([B25_0805_s, B25_0805_s])
    # B125_repeat = cal_multi_list([B125_0805_s, B125_0805_s])
    # B625_repeat = cal_multi_list([B625_0805_s, B625_0805_s])
    B_repeat_list = [B_repeat, B5_repeat, B25_repeat, B125_repeat, B625_repeat]

    for i in B_repeat_list:
        report_animo_ratio(i,
                           pos_form=True,
                           fasta_file=bsa_fasta,
                           tableform=True,
                           ratio_output=True,
                           threshold=15)

    # ADK
    print("*" * 40)
    print("--ADK--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/22020802BARSN_modify_power/Spotlink/"
    plink_root_dir = "G:/MSdata/22020802BARSN_modify_power/Plink/Plink_CL_spotlinkform/"
    ### fasta
    bsa_fasta = "MRIILLGAPGAGKGTQAQFIMEKYGIPQISTGDMLRAAVKSGSELGKQAKDIMDAGKLVTDELVIALVKERIAQEDCRNGFLLDGFPRTIPQADAMKEAGINVDYVLEFDVPDELIVDRIVGRRVHAPSGRVYHVKFNPPKVEGKDDVTGEELTTRKDDQEETVRKRLVEYHQMTAPLIGYYSKEAEAGNTKYAKVDGTKPVAEVRADLEKILG"
    ### file_dir

    spotlink_file_0805_B_fDR = spotlink_root_dir + 'JYD_20220727_A_HCDFT_result_filtered.csv'
    spotlink_file_0805_B5_fDR = spotlink_root_dir + 'JYD_20220727_A5_HCDFT_result_filtered.csv'
    spotlink_file_0805_B25_fDR = spotlink_root_dir + 'JYD_20220727_A25_HCDFT_result_filtered.csv'
    spotlink_file_0805_B125_fDR = spotlink_root_dir + 'JYD_20220727_A125_HCDFT_result_filtered.csv'
    spotlink_file_0805_B625_fDR = spotlink_root_dir + 'JYD_20220727_A625_HCDFT_result_filtered.csv'
    spotlink_file_0805_BF_fDR = spotlink_root_dir + 'JYD_20220727_AF_HCDFT_result_filtered.csv'
    plink_file_0805_B_fDR = plink_root_dir + "JYD_20220727_A.csv"
    plink_file_0805_B5_fDR = plink_root_dir + "JYD_20220727_A5.csv"
    plink_file_0805_B25_fDR = plink_root_dir + "JYD_20220727_A25.csv"
    plink_file_0805_B125_fDR = plink_root_dir + "JYD_20220727_A125.csv"
    plink_file_0805_B625_fDR = plink_root_dir + "JYD_20220727_A625.csv"
    plink_file_0805_BF_fDR = plink_root_dir + "JYD_20220727_AF.csv"
    B_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B_fDR,
                                               bsa_fasta)[0]
    B5_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B5_fDR,
                                                bsa_fasta)[0]
    B25_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B25_fDR,
                                                 bsa_fasta)[0]
    B125_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B125_fDR,
                                                  bsa_fasta)[0]
    B625_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B625_fDR,
                                                  bsa_fasta)[0]
    BF_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_BF_fDR,
                                                bsa_fasta)[0]
    B_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B_fDR,
                                            bsa_fasta)[0]
    B5_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B5_fDR,
                                             bsa_fasta)[0]
    B25_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B25_fDR,
                                              bsa_fasta)[0]
    B125_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B125_fDR,
                                               bsa_fasta)[0]
    B625_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B625_fDR,
                                               bsa_fasta)[0]
    BF_0805_p = plink_report_valid_link_sfDR(plink_file_0805_BF_fDR,
                                             bsa_fasta)[0]
    ## repeat part

    B_repeat = cal_multi_list([B_0805_s, BF_0805_s])
    B5_repeat = cal_multi_list([B5_0805_s, BF_0805_s])
    B25_repeat = cal_multi_list([B25_0805_s, BF_0805_s])
    B125_repeat = cal_multi_list([B125_0805_s, BF_0805_s])
    B625_repeat = cal_multi_list([B625_0805_s, BF_0805_s])
    # B_repeat = cal_multi_list([B_0805_s, B_0805_s])
    # B5_repeat = cal_multi_list([B5_0805_s, B5_0805_s])
    # B25_repeat = cal_multi_list([B25_0805_s, B25_0805_s])
    # B125_repeat = cal_multi_list([B125_0805_s, B125_0805_s])
    # B625_repeat = cal_multi_list([B625_0805_s, B625_0805_s])
    B_repeat_list = [B_repeat, B5_repeat, B25_repeat, B125_repeat, B625_repeat]

    for i in B_repeat_list:
        report_animo_ratio(i,
                           pos_form=True,
                           fasta_file=bsa_fasta,
                           tableform=True,
                           ratio_output=True,
                           threshold=10)

# 220812-MOD
    # plink2crosslink(
    #     "G:/MSdata/22020802BARSN_modify_power/Plink/pLink_task_2022.08.05.16.12.59_NSP/reports/NSP5_2022.08.05.filtered_cross-linked_spectra.csv",
    #     "G:/MSdata/22020802BARSN_modify_power/Plink/Plink_CL_spotlinkform/")

    #BSA
    print("*" * 40)
    print("--BSA--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/22020802BARSN_modify_power/Spotlink/"
    plink_root_dir = "G:/MSdata/22020802BARSN_modify_power/Plink/Plink_CL_spotlinkform/"
    ### fasta
    bsa_fasta = "MKWVTFISLLLLFSSAYSRGVFRRDTHKSEIAHRFKDLGEEHFKGLVLIAFSQYLQQCPFDEHVKLVNELTEFAKTCVADESHAGCEKSLHTLFGDELCKVASLRETYGDMADCCEKQEPERNECFLSHKDDSPDLPKLKPDPNTLCDEFKADEKKFWGKYLYEIARRHPYFYAPELLYYANKYNGVFQECCQAEDKGACLLPKIETMREKVLTSSARQRLRCASIQKFGERALKAWSVARLSQKFPKAEFVEVTKLVTDLTKVHKECCHGDLLECADDRADLAKYICDNQDTISSKLKECCDKPLLEKSHCIAEVEKDAIPENLPPLTADFAEDKDVCKNYQEAKDAFLGSFLYEYSRRHPEYAVSVLLRLAKEYEATLEECCAKDDPHACYSTVFDKLKHLVDEPQNLIKQNCDQFEKLGEYGFQNALIVRYTRKVPQVSTPTLVEVSRSLGKVGTRCCTKPESERMPCTEDYLSLILNRLCVLHEKTPVSEKVTKCCTESLVNRRPCFSALTPDETYVPKAFDEKLFTFHADICTLPDTEKQIKKQTALVELLKHKPKATEEQLKTVMENFVAFVDKCCAADDKEACFAVEGPKLVVSTQTALA"
    ### file_dir
    spotlink_file_0805_B_fDR = spotlink_root_dir + 'JYD_20220727_B_HCDFT_result_filtered.csv'
    spotlink_file_0805_B5_fDR = spotlink_root_dir + 'JYD_20220727_B5_HCDFT_result_filtered.csv'
    spotlink_file_0805_B25_fDR = spotlink_root_dir + 'JYD_20220727_B25_HCDFT_result_filtered.csv'
    spotlink_file_0805_B125_fDR = spotlink_root_dir + 'JYD_20220727_B125_HCDFT_result_filtered.csv'
    spotlink_file_0805_B625_fDR = spotlink_root_dir + 'JYD_20220727_B625_HCDFT_result_filtered.csv'
    spotlink_file_0805_BF_fDR = spotlink_root_dir + 'JYD_20220727_BF_HCDFT_result_filtered.csv'
    plink_file_0805_B_fDR = plink_root_dir + "JYD_20220727_B.csv"
    plink_file_0805_B5_fDR = plink_root_dir + "JYD_20220727_B5.csv"
    plink_file_0805_B25_fDR = plink_root_dir + "JYD_20220727_B25.csv"
    plink_file_0805_B125_fDR = plink_root_dir + "JYD_20220727_B125.csv"
    plink_file_0805_B625_fDR = plink_root_dir + "JYD_20220727_B625.csv"
    plink_file_0805_BF_fDR = plink_root_dir + "JYD_20220727_BF.csv"
    B_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B_fDR,
                                               bsa_fasta)[0]
    B5_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B5_fDR,
                                                bsa_fasta)[0]
    B25_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B25_fDR,
                                                 bsa_fasta)[0]
    B125_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B125_fDR,
                                                  bsa_fasta)[0]
    B625_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B625_fDR,
                                                  bsa_fasta)[0]
    BF_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_BF_fDR,
                                                bsa_fasta,
                                                f2sf=False)[0]
    B_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B_fDR,
                                            bsa_fasta)[0]
    B5_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B5_fDR,
                                             bsa_fasta)[0]
    B25_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B25_fDR,
                                              bsa_fasta)[0]
    B125_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B125_fDR,
                                               bsa_fasta)[0]
    B625_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B625_fDR,
                                               bsa_fasta)[0]
    BF_0805_p = plink_report_valid_link_sfDR(plink_file_0805_BF_fDR,
                                             bsa_fasta)[0]
    ## repeat part

    # B_repeat = cal_multi_list([B_0805_s, BF_0805_s])
    # B5_repeat = cal_multi_list([B5_0805_s, BF_0805_s])
    # B25_repeat = cal_multi_list([B25_0805_s, BF_0805_s])
    # B125_repeat = cal_multi_list([B125_0805_s, BF_0805_s])
    # B625_repeat = cal_multi_list([B625_0805_s, BF_0805_s])
    B_repeat = cal_multi_list([B_0805_s, B_0805_p])
    B5_repeat = cal_multi_list([B5_0805_s, B5_0805_p])
    B25_repeat = cal_multi_list([B25_0805_s, B25_0805_p])
    B125_repeat = cal_multi_list([B125_0805_s, B125_0805_p])
    B625_repeat = cal_multi_list([B625_0805_s, B625_0805_p])

    # B_repeat = cal_multi_list([B_0805_s, B_0805_s])
    # B5_repeat = cal_multi_list([B5_0805_s, B5_0805_s])
    # B25_repeat = cal_multi_list([B25_0805_s, B25_0805_s])
    # B125_repeat = cal_multi_list([B125_0805_s, B125_0805_s])
    # B625_repeat = cal_multi_list([B625_0805_s, B625_0805_s])
    # BF_repeat = cal_multi_list([BF_0805_s, BF_0805_s])

    # B_repeat = cal_multi_list([B_0805_p, B_0805_p])
    # B5_repeat = cal_multi_list([B5_0805_p, B5_0805_p])
    # B25_repeat = cal_multi_list([B25_0805_p, B25_0805_p])
    # B125_repeat = cal_multi_list([B125_0805_p, B125_0805_p])
    # B625_repeat = cal_multi_list([B625_0805_p, B625_0805_p])
    # BF_repeat = cal_multi_list([BF_0805_p, BF_0805_p])

    B_repeat_list = [B_repeat, B5_repeat, B25_repeat, B125_repeat, B625_repeat]
    B_0805_s_list = [
        B_0805_s, B5_0805_s, B25_0805_s, B125_0805_s, B625_0805_s, BF_0805_s
    ]

    for i in B_repeat_list:
        cal_distance_pos_list(i[0:25], print_all=True)
        report_animo_ratio(i,
                           pos_form=True,
                           fasta_file=bsa_fasta,
                           tableform=True,
                           ratio_output=True,
                           threshold=25)

    # 220805-BSA-modify-power

    bsa_fasta = "MKWVTFISLLLLFSSAYSRGVFRRDTHKSEIAHRFKDLGEEHFKGLVLIAFSQYLQQCPFDEHVKLVNELTEFAKTCVADESHAGCEKSLHTLFGDELCKVASLRETYGDMADCCEKQEPERNECFLSHKDDSPDLPKLKPDPNTLCDEFKADEKKFWGKYLYEIARRHPYFYAPELLYYANKYNGVFQECCQAEDKGACLLPKIETMREKVLTSSARQRLRCASIQKFGERALKAWSVARLSQKFPKAEFVEVTKLVTDLTKVHKECCHGDLLECADDRADLAKYICDNQDTISSKLKECCDKPLLEKSHCIAEVEKDAIPENLPPLTADFAEDKDVCKNYQEAKDAFLGSFLYEYSRRHPEYAVSVLLRLAKEYEATLEECCAKDDPHACYSTVFDKLKHLVDEPQNLIKQNCDQFEKLGEYGFQNALIVRYTRKVPQVSTPTLVEVSRSLGKVGTRCCTKPESERMPCTEDYLSLILNRLCVLHEKTPVSEKVTKCCTESLVNRRPCFSALTPDETYVPKAFDEKLFTFHADICTLPDTEKQIKKQTALVELLKHKPKATEEQLKTVMENFVAFVDKCCAADDKEACFAVEGPKLVVSTQTALA"

    # plink2crosslink(
    #     "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/bsa_2022.03.26.filtered_cross-linked_spectra.csv",
    #     "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/"
    # )

    spotlink_file_0322_B_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_B_HCDFT_result_filtered.csv'
    spotlink_file_0322_BO_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_BO_HCDFT_result_filtered.csv'
    spotlink_file_0322_BN_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_BN_HCDFT_result_filtered.csv'
    spotlink_file_0322_BU_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_BU_HCDFT_result_filtered.csv'
    spotlink_file_0322_B1_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_B1_HCDFT_result_filtered.csv'
    spotlink_file_0322_B5_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_B5_HCDFT_result_filtered.csv'
    spotlink_file_0322_B50_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_B50_HCDFT_result_filtered.csv'
    spotlink_file_0322_B500_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_B500_HCDFT_result_filtered.csv'
    spotlink_file_0322_B1000_fDR = 'G:/MSdata/220321BSA_modify_power/SPOTLINK/JYD_20220322_B1000_HCDFT_result_filtered.csv'

    crosslink_file_0118_BM10_fDR = 'G:/MSdata/220118UBBSA/spotlink/WXZ_20220118_BM10_HCDFT_result_filtered.csv'

    plink_0322_B_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_B.csv"
    plink_0322_BO_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_BO.csv"
    plink_0322_BU_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_BU.csv"
    plink_0322_BN_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_BN.csv"
    plink_0322_B1_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_B1.csv"
    plink_0322_B5_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_B5.csv"
    plink_0322_B50_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_B50.csv"
    plink_0322_B500_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_B500.csv"
    plink_0322_B1000_fDR = "G:/MSdata/220321BSA_modify_power/PLINK/pLink_task_2022.03.26.09.56.22/reports/crosslink_spotlinkform/JYD_20220322_B1000.csv"

    B_0322_s = spotlink_report_valid_link_sfDR(spotlink_file_0322_B_fDR,
                                               bsa_fasta)[0]
    BO_0322_s = spotlink_report_valid_link_sfDR(spotlink_file_0322_BO_fDR,
                                                bsa_fasta)[0]
    BN_0322_s = spotlink_report_valid_link_sfDR(spotlink_file_0322_BN_fDR,
                                                bsa_fasta)[0]
    BU_0322_s = spotlink_report_valid_link_sfDR(spotlink_file_0322_BU_fDR,
                                                bsa_fasta)[0]
    B1_0322_s = spotlink_report_valid_link_sfDR(spotlink_file_0322_B1_fDR,
                                                bsa_fasta)[0]
    B5_0322_s = spotlink_report_valid_link_sfDR(spotlink_file_0322_B5_fDR,
                                                bsa_fasta)[0]
    B50_0322_s = spotlink_report_valid_link_sfDR(spotlink_file_0322_B50_fDR,
                                                 bsa_fasta)[0]
    B500_0322_s = spotlink_report_valid_link_sfDR(spotlink_file_0322_B500_fDR,
                                                  bsa_fasta)[0]
    B1000_0322_s = spotlink_report_valid_link_sfDR(
        spotlink_file_0322_B1000_fDR, bsa_fasta)[0]
    BM10_0118_s = spotlink_report_valid_link_sfDR(crosslink_file_0118_BM10_fDR,
                                                  bsa_fasta,
                                                  least_ssn=1,
                                                  threshold=0.8)[0]

    B_0322_p = plink_report_valid_link_sfDR(plink_0322_B_fDR, bsa_fasta)[0]
    BO_0322_p = plink_report_valid_link_sfDR(plink_0322_BO_fDR, bsa_fasta)[0]
    BU_0322_p = plink_report_valid_link_sfDR(plink_0322_BU_fDR, bsa_fasta)[0]
    BN_0322_p = plink_report_valid_link_sfDR(plink_0322_BN_fDR, bsa_fasta)[0]
    B1_0322_p = plink_report_valid_link_sfDR(plink_0322_B1_fDR, bsa_fasta)[0]
    B5_0322_p = plink_report_valid_link_sfDR(plink_0322_B5_fDR, bsa_fasta)[0]
    B50_0322_p = plink_report_valid_link_sfDR(plink_0322_B50_fDR, bsa_fasta)[0]
    B500_0322_p = plink_report_valid_link_sfDR(plink_0322_B500_fDR,
                                               bsa_fasta)[0]
    B1000_0322_p = plink_report_valid_link_sfDR(plink_0322_B1000_fDR,
                                                bsa_fasta)[0]
    print("-------------")

    B_repeat = cal_repeat_list(B_0322_p, B_0322_s)[0]
    BO_repeat = cal_repeat_list(BO_0322_p, BO_0322_s)[0]
    BU_repeat = cal_repeat_list(BU_0322_p, BU_0322_s)[0]
    BN_repeat = cal_repeat_list(BN_0322_p, BN_0322_s)[0]
    B1_repeat = cal_repeat_list(B1_0322_p, B1_0322_s)[0]
    B5_repeat = cal_repeat_list(B5_0322_p, B5_0322_s)[0]
    B50_repeat = cal_repeat_list(B50_0322_p, B50_0322_s)[0]
    B500_repeat = cal_repeat_list(B500_0322_p, B500_0322_s)[0]
    B1000_repeat = cal_repeat_list(B1000_0322_p, B1000_0322_s)[0]
    # Contrast with standard
    print("-------------")
    # print(len(BM10_0118_s))
    # B_repeat = cal_repeat_list(B_0322_s, BF_0805_s)[0]
    # B1_repeat = cal_repeat_list(B1_0322_s, BF_0805_s)[0]
    # BO_repeat = cal_repeat_list(BO_0322_s, BF_0805_s)[0]
    # B5_repeat = cal_repeat_list(B5_0322_s, BF_0805_s)[0]
    # B50_repeat = cal_repeat_list(B50_0322_s, BF_0805_s)[0]
    # B500_repeat = cal_repeat_list(B500_0322_s, BF_0805_s)[0]
    # B1000_repeat = cal_repeat_list(B1000_0322_s, BF_0805_s)[0]
    # print("-------------")

    repeat_list_0322 = [
        B_repeat, B1_repeat, B5_repeat, B50_repeat, B500_repeat
    ]

    list_0322_s = [
        B_0322_s, BO_0322_s, BN_0322_s, BU_0322_s, B1_0322_s, B5_0322_s,
        B50_0322_s, B500_0322_s, B1000_0322_s
    ]

    list_0322_p = [
        B_0322_p, BO_0322_p, BN_0322_p, BU_0322_p, B1_0322_p, B5_0322_p,
        B50_0322_p, B500_0322_p, B1000_0322_p
    ]

    # for i in list_0322_s:
    #     cal_distance_pos_list(i[0:100], print_all=False)

    for i in repeat_list_0322:
        # cal_distance_pos_list(i[0:20], print_all=False)
        report_animo_ratio(i,
                           pos_form=True,
                           fasta_file=bsa_fasta,
                           tableform=True,
                           ratio_output=True,
                           threshold=30)

    # RSV_CA
    print("*" * 40)
    print("--RSV--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/22020802BARSN_modify_power/Spotlink/"
    plink_root_dir = "G:/MSdata/22020802BARSN_modify_power/Plink/Plink_CL_spotlinkform/"
    ### fasta
    bsa_fasta = "MASMTGGQQMGRGSEFMPVVIKTEGPAWTPLEPKLITRLADTVRTKGLRSPITMAEVEALMSSPLLPHDVTNLMRVILGPAPYALWMDAWGVQLQTVIAAATRDPRHPANGQGRGERTNLNRLKGLADGMVGNPQGQAALLRPGELVAITASALQAFREVARLAEPAGPWADIMQGPSESFVDFANRLIKAVEGSDLPPSARAPVIIDSFRQKSQPDIQQLIRTAPSTLTTPGEIIKYVLDRQKTAPLTDQGIAAAM"
    ### file_dir

    spotlink_file_0805_B_fDR = spotlink_root_dir + 'JYD_20220727_R_HCDFT_result_filtered.csv'
    spotlink_file_0805_B5_fDR = spotlink_root_dir + 'JYD_20220727_R5_HCDFT_result_filtered.csv'
    spotlink_file_0805_B25_fDR = spotlink_root_dir + 'JYD_20220727_R25_HCDFT_result_filtered.csv'
    spotlink_file_0805_B125_fDR = spotlink_root_dir + 'JYD_20220727_R125_HCDFT_result_filtered.csv'
    spotlink_file_0805_B625_fDR = spotlink_root_dir + 'JYD_20220727_R625_HCDFT_result_filtered.csv'
    spotlink_file_0805_BF_fDR = spotlink_root_dir + 'JYD_20220727_RF_HCDFT_result_filtered.csv'
    plink_file_0805_B_fDR = plink_root_dir + "JYD_20220727_R.csv"
    plink_file_0805_B5_fDR = plink_root_dir + "JYD_20220727_R5.csv"
    plink_file_0805_B25_fDR = plink_root_dir + "JYD_20220727_R25.csv"
    plink_file_0805_B125_fDR = plink_root_dir + "JYD_20220727_R125.csv"
    plink_file_0805_B625_fDR = plink_root_dir + "JYD_20220727_R625.csv"
    plink_file_0805_BF_fDR = plink_root_dir + "JYD_20220727_RF.csv"
    B_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B_fDR,
                                               bsa_fasta)[0]
    B5_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B5_fDR,
                                                bsa_fasta)[0]
    B25_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B25_fDR,
                                                 bsa_fasta)[0]
    B125_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B125_fDR,
                                                  bsa_fasta)[0]
    B625_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B625_fDR,
                                                  bsa_fasta)[0]
    BF_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_BF_fDR,
                                                bsa_fasta)[0]
    B_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B_fDR,
                                            bsa_fasta)[0]
    B5_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B5_fDR,
                                             bsa_fasta)[0]
    B25_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B25_fDR,
                                              bsa_fasta)[0]
    B125_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B125_fDR,
                                               bsa_fasta)[0]
    B625_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B625_fDR,
                                               bsa_fasta)[0]
    BF_0805_p = plink_report_valid_link_sfDR(plink_file_0805_BF_fDR,
                                             bsa_fasta)[0]
    # repeat part

    # B_repeat = cal_multi_list([B_0805_s, BF_0805_s])
    # B5_repeat = cal_multi_list([B5_0805_s, BF_0805_s])
    # B25_repeat = cal_multi_list([B25_0805_s, BF_0805_s])
    # B125_repeat = cal_multi_list([B125_0805_s, BF_0805_s])
    # B625_repeat = cal_multi_list([B625_0805_s, BF_0805_s])

    # B_repeat = cal_multi_list([B_0805_s, B_0805_s])
    # B5_repeat = cal_multi_list([B5_0805_s, B5_0805_s])
    # B25_repeat = cal_multi_list([B25_0805_s, B25_0805_s])
    # B125_repeat = cal_multi_list([B125_0805_s, B125_0805_s])
    # B625_repeat = cal_multi_list([B625_0805_s, B625_0805_s])

    B_repeat = cal_multi_list([B_0805_s, B_0805_p])
    B5_repeat = cal_multi_list([B5_0805_s, B5_0805_p])
    B25_repeat = cal_multi_list([B25_0805_s, B25_0805_p])
    B125_repeat = cal_multi_list([B125_0805_s, B125_0805_p])
    B625_repeat = cal_multi_list([B625_0805_s, B625_0805_p])

    B_repeat_list = [B_repeat, B5_repeat, B25_repeat, B125_repeat, B625_repeat]

    for i in B_repeat_list:
        # cal_distance_pos_list(i[0:8],
        #                       fasta=bsa_fasta,
        #                       pdb_file='G:/MSdata/pdb/rsv_ca.pdb',
        #                       print_all=False)
        report_animo_ratio(i,
                           pos_form=True,
                           fasta_file=bsa_fasta,
                           tableform=True,
                           ratio_output=True,
                           threshold=6)

    # E1
    print("*" * 40)
    print("--E1--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/22020802BARSN_modify_power/Spotlink/"
    plink_root_dir = "G:/MSdata/22020802BARSN_modify_power/Plink/Plink_CL_spotlinkform/"
    ### fasta
    bsa_fasta = "MTTVLYYLPASPPCRSVLLLAKMIGVELDLKVLNIMEGEQLKPDFVELNPQHCIPTMDDHGLVLWESRVILSYLVSAYGKDENLYPKDFRSRAIVDQRLHFDLGTLYQRVVDYYFPTIHLGAHLDQTKKAKLAEALGWFEAMLKQYQWSAANHFTIADIALCVTVSQIEAFQFDLHPYPRVRAWLLKCKDELEGHGYKEINETGAETLAGLFRSKLKQSDLVPRGSMSSSPLSKKRRVSGPDPKPGSNCSPAQSVLSEVPSVPTNGMAKNGSEADIDEGLYSRQLYVLGHEAMKRLQTSSVLVSGLRGLGVEIAKNIILGGVKAVTLHDQGTAQWADLSSQFYLREEDIGKNRAEVSQPRLAELNSYVPVTAYTGPLVEDFLSGFQVVVLTNTPLEDQLRVGEFCHNRGIKLVVADTRGLFGQLFCDFGEEMILTDSNGEQPLSAMVSMVTKDNPGVVTCLDEARHGFESGDFVSFSEVQGMVELNGNQPMEIKVLGPYTFSICDTSNFSDYIRGGIVSQVKVPKKISFKSLVASLAEPDFVVTDFAKFSRPAQLHIGFQALHQFCAQHGRPPRPRNEEDAAELVALAQAVNARALPAVQQNNLDEDLIRKLAYVAAGDLAPINAFIGGLAAQEVMKACSGKFMPIMQWLYFDALECLPEDKEVLTEDKCLQRQNRYDGQVAVFGSDLQEKLGKQKYFLVGAGAIGCELLKNFAMIGLGCGEGGEIIVTDMDTIEKSNLNRQFLFRPWDVTKLKSDTAAAAVRQMNPHIRVTSHQNRVGPDTERIYDDDFFQNLDGVANALDNVDARMYMDRRCVYYRKPLLESGTLGTKGNVQVVIPFLTESYSSSQDPPEKSIPICTLKNFPNAIEHTLQWARDEFEGLFKQPAENVNQYLTDPKFVERTLRLAGTQPLEVLEAVQRSLVLQRPQTWADCVTWACHHWHTQYSNNIRQLLHNFPPDQLTSSGAPFWSGPKRCPHPLTFDVNNPLHLDYVMAAANLFAQTYGLTGSQDRAAVATFLQSVQVPEFTPKSGVKIHVSDQELQSANASVDDSRLEELKATLPSPDKLPGFKMYPIDFEKDDDSNFHMDFIVAASNLRAENYDIPSADRHKSKLIAGKIIPAIATTTAAVVGLVCLELYKVVQGHRQLDSYKNGFLNLALPFFGFSEPLAAPRHQYYNQEWTLWDRFEVQGLQPNGEEMTLKQFLDYFKTEHKLEITMLSQGVSMLYSFFMPAAKLKERLDQPMTEIVSRVSKRKLGRHVRALVLELCCNDESGEDVEVPYVRYTIR"
    ### file_dir

    spotlink_file_0805_B_fDR = spotlink_root_dir + 'JYD_20220727_E_HCDFT_result_filtered.csv'
    spotlink_file_0805_B5_fDR = spotlink_root_dir + 'JYD_20220727_E5_HCDFT_result_filtered.csv'
    spotlink_file_0805_B25_fDR = spotlink_root_dir + 'JYD_20220727_E25_HCDFT_result_filtered.csv'
    spotlink_file_0805_B125_fDR = spotlink_root_dir + 'JYD_20220727_E125_HCDFT_result_filtered.csv'
    spotlink_file_0805_B625_fDR = spotlink_root_dir + 'JYD_20220727_E625_HCDFT_result_filtered.csv'
    spotlink_file_0805_BF_fDR = spotlink_root_dir + 'JYD_20220727_EF_HCDFT_result_filtered.csv'
    plink_file_0805_B_fDR = plink_root_dir + "JYD_20220727_E.csv"
    plink_file_0805_B5_fDR = plink_root_dir + "JYD_20220727_E5.csv"
    plink_file_0805_B25_fDR = plink_root_dir + "JYD_20220727_E25.csv"
    plink_file_0805_B125_fDR = plink_root_dir + "JYD_20220727_E125.csv"
    plink_file_0805_B625_fDR = plink_root_dir + "JYD_20220727_E625.csv"
    plink_file_0805_BF_fDR = plink_root_dir + "JYD_20220727_EF.csv"
    B_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B_fDR,
                                               bsa_fasta)[0]
    B5_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B5_fDR,
                                                bsa_fasta)[0]
    B25_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B25_fDR,
                                                 bsa_fasta)[0]
    B125_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B125_fDR,
                                                  bsa_fasta)[0]
    B625_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B625_fDR,
                                                  bsa_fasta)[0]
    BF_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_BF_fDR,
                                                bsa_fasta)[0]
    B_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B_fDR,
                                            bsa_fasta)[0]
    B5_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B5_fDR,
                                             bsa_fasta)[0]
    B25_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B25_fDR,
                                              bsa_fasta)[0]
    B125_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B125_fDR,
                                               bsa_fasta)[0]
    B625_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B625_fDR,
                                               bsa_fasta)[0]
    BF_0805_p = plink_report_valid_link_sfDR(plink_file_0805_BF_fDR,
                                             bsa_fasta)[0]
    ## repeat part

    # B_repeat = cal_multi_list([B_0805_s, BF_0805_s])
    # B5_repeat = cal_multi_list([B5_0805_s, BF_0805_s])
    # B25_repeat = cal_multi_list([B25_0805_s, BF_0805_s])
    # B125_repeat = cal_multi_list([B125_0805_s, BF_0805_s])
    # B625_repeat = cal_multi_list([B625_0805_s, BF_0805_s])

    # B_repeat = cal_multi_list([B_0805_s, B_0805_s])
    # B5_repeat = cal_multi_list([B5_0805_s, B5_0805_s])
    # B25_repeat = cal_multi_list([B25_0805_s, B25_0805_s])
    # B125_repeat = cal_multi_list([B125_0805_s, B125_0805_s])
    # B625_repeat = cal_multi_list([B625_0805_s, B625_0805_s])

    B_repeat = cal_multi_list([B_0805_s, B_0805_p])
    B5_repeat = cal_multi_list([B5_0805_s, B5_0805_p])
    B25_repeat = cal_multi_list([B25_0805_s, B25_0805_p])
    B125_repeat = cal_multi_list([B125_0805_s, B125_0805_p])
    B625_repeat = cal_multi_list([B625_0805_s, B625_0805_p])

    B_repeat_list = [B_repeat, B5_repeat, B25_repeat, B125_repeat, B625_repeat]

    for i in B_repeat_list:
        # cal_distance_pos_list(i[0:8],
        #                       fasta=bsa_fasta,
        #                       pdb_file='G:/MSdata/pdb/E1.pdb',
        #                       print_all=False)
        report_animo_ratio(i,
                           pos_form=True,
                           fasta_file=bsa_fasta,
                           tableform=True,
                           ratio_output=True,
                           threshold=3)

    # ADK
    print("*" * 40)
    print("--ADK--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/22020802BARSN_modify_power/Spotlink/"
    plink_root_dir = "G:/MSdata/22020802BARSN_modify_power/Plink/Plink_CL_spotlinkform/"
    ### fasta
    bsa_fasta = "MRIILLGAPGAGKGTQAQFIMEKYGIPQISTGDMLRAAVKSGSELGKQAKDIMDAGKLVTDELVIALVKERIAQEDCRNGFLLDGFPRTIPQADAMKEAGINVDYVLEFDVPDELIVDRIVGRRVHAPSGRVYHVKFNPPKVEGKDDVTGEELTTRKDDQEETVRKRLVEYHQMTAPLIGYYSKEAEAGNTKYAKVDGTKPVAEVRADLEKILG"
    ### file_dir

    spotlink_file_0805_B_fDR = spotlink_root_dir + 'JYD_20220727_A_HCDFT_result_filtered.csv'
    spotlink_file_0805_B5_fDR = spotlink_root_dir + 'JYD_20220727_A5_HCDFT_result_filtered.csv'
    spotlink_file_0805_B25_fDR = spotlink_root_dir + 'JYD_20220727_A25_HCDFT_result_filtered.csv'
    spotlink_file_0805_B125_fDR = spotlink_root_dir + 'JYD_20220727_A125_HCDFT_result_filtered.csv'
    spotlink_file_0805_B625_fDR = spotlink_root_dir + 'JYD_20220727_A625_HCDFT_result_filtered.csv'
    spotlink_file_0805_BF_fDR = spotlink_root_dir + 'JYD_20220727_AF_HCDFT_result_filtered.csv'
    plink_file_0805_B_fDR = plink_root_dir + "JYD_20220727_A.csv"
    plink_file_0805_B5_fDR = plink_root_dir + "JYD_20220727_A5.csv"
    plink_file_0805_B25_fDR = plink_root_dir + "JYD_20220727_A25.csv"
    plink_file_0805_B125_fDR = plink_root_dir + "JYD_20220727_A125.csv"
    plink_file_0805_B625_fDR = plink_root_dir + "JYD_20220727_A625.csv"
    plink_file_0805_BF_fDR = plink_root_dir + "JYD_20220727_AF.csv"
    B_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B_fDR,
                                               bsa_fasta)[0]
    B5_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B5_fDR,
                                                bsa_fasta)[0]
    B25_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B25_fDR,
                                                 bsa_fasta)[0]
    B125_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B125_fDR,
                                                  bsa_fasta)[0]
    B625_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_B625_fDR,
                                                  bsa_fasta)[0]
    BF_0805_s = spotlink_report_valid_link_sfDR(spotlink_file_0805_BF_fDR,
                                                bsa_fasta)[0]
    B_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B_fDR,
                                            bsa_fasta)[0]
    B5_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B5_fDR,
                                             bsa_fasta)[0]
    B25_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B25_fDR,
                                              bsa_fasta)[0]
    B125_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B125_fDR,
                                               bsa_fasta)[0]
    B625_0805_p = plink_report_valid_link_sfDR(plink_file_0805_B625_fDR,
                                               bsa_fasta)[0]
    BF_0805_p = plink_report_valid_link_sfDR(plink_file_0805_BF_fDR,
                                             bsa_fasta)[0]
    ## repeat part

    # B_repeat = cal_multi_list([B_0805_s, BF_0805_s])
    # B5_repeat = cal_multi_list([B5_0805_s, BF_0805_s])
    # B25_repeat = cal_multi_list([B25_0805_s, BF_0805_s])
    # B125_repeat = cal_multi_list([B125_0805_s, BF_0805_s])
    # B625_repeat = cal_multi_list([B625_0805_s, BF_0805_s])

    # B_repeat = cal_multi_list([B_0805_s, B_0805_s])
    # B5_repeat = cal_multi_list([B5_0805_s, B5_0805_s])
    # B25_repeat = cal_multi_list([B25_0805_s, B25_0805_s])
    # B125_repeat = cal_multi_list([B125_0805_s, B125_0805_s])
    # B625_repeat = cal_multi_list([B625_0805_s, B625_0805_s])

    # B_repeat = cal_multi_list([B_0805_s, B_0805_s])
    # B5_repeat = cal_multi_list([B5_0805_s, B5_0805_s])
    # B25_repeat = cal_multi_list([B25_0805_s, B25_0805_s])
    # B125_repeat = cal_multi_list([B125_0805_s, B125_0805_s])
    # B625_repeat = cal_multi_list([B625_0805_s, B625_0805_s])

    B_repeat = cal_multi_list([B_0805_s, B_0805_p])
    B5_repeat = cal_multi_list([B5_0805_s, B5_0805_p])
    B25_repeat = cal_multi_list([B25_0805_s, B25_0805_p])
    B125_repeat = cal_multi_list([B125_0805_s, B125_0805_p])
    B625_repeat = cal_multi_list([B625_0805_s, B625_0805_p])
    BF_repeat = cal_multi_list([BF_0805_s, BF_0805_p])

    B_repeat_list = [
        B_repeat, B5_repeat, B25_repeat, B125_repeat, B625_repeat, BF_repeat
    ]

    for i in B_repeat_list:
        # cal_distance_pos_list(i,
        #                       fasta=bsa_fasta,
        #                       pdb_file='G:/MSdata/pdb/adk.pdb',
        #                       print_all=True)
        report_animo_ratio(i,
                           pos_form=True,
                           fasta_file=bsa_fasta,
                           tableform=True,
                           ratio_output=True,
                           threshold=3)


# 20220920
     # plink2crosslink(
    #     "G:/MSdata/220913BSABQXL/plink/pLink_task_2022.09.15.14.35.11/reports/bsa_2022.09.15.filtered_cross-linked_spectra.csv",
    #     "G:/MSdata/220913BSABQXL/plink/pLink_task_2022.09.15.14.35.11/reports/crosslink_spotlinkform/"
    # )

    print("*" * 40)
    print("--BSA--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/220913BSABQXL/spotlink/"
    plink_root_dir = "G:/MSdata/220913BSABQXL/plink/pLink_task_2022.09.15.14.35.11/reports/crosslink_spotlinkform/"
    ### fasta
    bsa_fasta = "MKWVTFISLLLLFSSAYSRGVFRRDTHKSEIAHRFKDLGEEHFKGLVLIAFSQYLQQCPFDEHVKLVNELTEFAKTCVADESHAGCEKSLHTLFGDELCKVASLRETYGDMADCCEKQEPERNECFLSHKDDSPDLPKLKPDPNTLCDEFKADEKKFWGKYLYEIARRHPYFYAPELLYYANKYNGVFQECCQAEDKGACLLPKIETMREKVLTSSARQRLRCASIQKFGERALKAWSVARLSQKFPKAEFVEVTKLVTDLTKVHKECCHGDLLECADDRADLAKYICDNQDTISSKLKECCDKPLLEKSHCIAEVEKDAIPENLPPLTADFAEDKDVCKNYQEAKDAFLGSFLYEYSRRHPEYAVSVLLRLAKEYEATLEECCAKDDPHACYSTVFDKLKHLVDEPQNLIKQNCDQFEKLGEYGFQNALIVRYTRKVPQVSTPTLVEVSRSLGKVGTRCCTKPESERMPCTEDYLSLILNRLCVLHEKTPVSEKVTKCCTESLVNRRPCFSALTPDETYVPKAFDEKLFTFHADICTLPDTEKQIKKQTALVELLKHKPKATEEQLKTVMENFVAFVDKCCAADDKEACFAVEGPKLVVSTQTALA"
    ### file_dir
    spotlink_file_0908_B0_fDR = spotlink_root_dir + 'JYD_20220908_B0_HCDFT_result_filtered.csv'
    spotlink_file_0908_B1_fDR = spotlink_root_dir + 'JYD_20220908_B1_HCDFT_result_filtered.csv'
    spotlink_file_0908_B5_fDR = spotlink_root_dir + 'JYD_20220908_B5_HCDFT_result_filtered.csv'
    spotlink_file_0908_B25_fDR = spotlink_root_dir + 'JYD_20220908_B25_HCDFT_result_filtered.csv'
    spotlink_file_0908_B100_fDR = spotlink_root_dir + 'JYD_20220908_B100_HCDFT_result_filtered.csv'
    plink_file_0908_B0_fDR = plink_root_dir + "JYD_20220908_B0.csv"
    plink_file_0908_B5_fDR = plink_root_dir + "JYD_20220908_B5.csv"
    plink_file_0908_B25_fDR = plink_root_dir + "JYD_20220908_B25.csv"
    plink_file_0908_B100_fDR = plink_root_dir + "JYD_20220908_B100.csv"
    plink_file_0908_B1_fDR = plink_root_dir + "JYD_20220908_B1.csv"
    B0_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B0_fDR,
                                                bsa_fasta,
                                                f2sf=False)[0]
    B1_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B1_fDR,
                                                bsa_fasta,
                                                f2sf=False)[0]
    B5_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B5_fDR,
                                                bsa_fasta,
                                                f2sf=False)[0]
    B25_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B25_fDR,
                                                 bsa_fasta,
                                                 f2sf=False)[0]
    B100_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B100_fDR,
                                                  bsa_fasta,
                                                  f2sf=False)[0]
    # B0_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B0_fDR,
    #                                             bsa_fasta,
    #                                             f2sf=True)[0]
    # B1_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B1_fDR,
    #                                             bsa_fasta,
    #                                             f2sf=True)[0]
    # B5_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B5_fDR,
    #                                             bsa_fasta,
    #                                             f2sf=True)[0]
    # B25_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B25_fDR,
    #                                              bsa_fasta,
    #                                              f2sf=True)[0]
    # B100_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B100_fDR,
    #                                               bsa_fasta,
    #                                               f2sf=True)[0]
    B0_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B0_fDR,
                                             bsa_fasta)[0]
    B1_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B1_fDR,
                                             bsa_fasta)[0]
    B5_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B5_fDR,
                                             bsa_fasta)[0]
    B25_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B25_fDR,
                                              bsa_fasta)[0]
    B100_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B100_fDR,
                                               bsa_fasta)[0]
    ## repeat part

    B0_repeat = cal_multi_list([B0_0908_s, B0_0908_p])
    B1_repeat = cal_multi_list([B1_0908_s, B1_0908_p])
    B5_repeat = cal_multi_list([B5_0908_s, B5_0908_p])
    B25_repeat = cal_multi_list([B25_0908_s, B25_0908_p])
    B100_repeat = cal_multi_list([B100_0908_s, B100_0908_p])
    # B0_repeat = cal_multi_list([B0_0908_s, B0_0908_s])
    # B1_repeat = cal_multi_list([B1_0908_s, B1_0908_s])
    # B5_repeat = cal_multi_list([B5_0908_s, B5_0908_s])
    # B25_repeat = cal_multi_list([B25_0908_s, B25_0908_s])
    # B100_repeat = cal_multi_list([B100_0908_s, B100_0908_s])

    # B0_repeat = cal_multi_list([B0_0908_p, B0_0908_p])
    # B1_repeat = cal_multi_list([B1_0908_p, B1_0908_p])
    # B5_repeat = cal_multi_list([B5_0908_p, B5_0908_p])
    # B25_repeat = cal_multi_list([B25_0908_p, B25_0908_p])
    # B100_repeat = cal_multi_list([B100_0908_p, B100_0908_p])

    B_repeat_list = [B0_repeat, B1_repeat, B5_repeat, B25_repeat, B100_repeat]
    B0_0908_s_list = [B0_0908_s, B1_0908_s, B5_0908_s, B25_0908_s, B100_0908_s]

    for i in B_repeat_list:
        k = [
            j for j in i
            if bsa_fasta[int(j[0]) - 1] == "K" or bsa_fasta[int(j[1]) -
                                                            1] == "K"
        ]
        cal_distance_pos_list(k[0:75],
                              fasta=bsa_fasta,
                              pdb_file='G:/MSdata/pdb/bsa.pdb',
                              print_all=False)
        report_animo_ratio(k,
                           pos_form=True,
                           fasta_file=bsa_fasta,
                           tableform=True,
                           ratio_output=True,
                           threshold=50)


  # plink2crosslink(
    #     "G:/MSdata/220913BSABQXL/plink/pLink_task_2022.09.15.14.44.33/reports/conalbumin_2022.09.15.filtered_cross-linked_spectra.csv",
    #     "G:/MSdata/220913BSABQXL/plink/pLink_task_2022.09.15.14.44.33/reports/crosslink_spotlinkform/"
    # )

    print("*" * 40)
    print("--BQ--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/220913BSABQXL/spotlink/"
    plink_root_dir = "G:/MSdata/220913BSABQXL/plink/pLink_task_2022.09.15.14.44.33/reports/crosslink_spotlinkform/"
    ### fasta
    fasta = "MKLILCTVLSLGIAAVCFAAPPKSVIRWCTISSPEEKKCNNLRDLTQQERISLTCVQKATYLDCIKAIANNEADAISLDGGQAFEAGLAPYKLKPIAAEVYEHTEGSTTSYYAVAVVKKGTEFTVNDLQGKTSCHTGLGRSAGWNIPIGTLLHRGAIEWEGIESGSVEQAVAKFFSASCVPGATIEQKLCRQCKGDPKTKCARNAPYSGYSGAFHCLKDGKGDVAFVKHTTVNENAPDQKDEYELLCLDGSRQPVDNYKTCNWARVAAHAVVARDDNKVEDIWSFLSKAQSDFGVDTKSDFHLFGPPGKKDPVLKDLLFKDSAIMLKRVPSLMDSQLYLGFEYYSAIQSMRKDQLTPSPRENRIQWCAVGKDEKSKCDRWSVVSNGDVECTVVDETKDCIIKIMKGEADAVALDGGLVYTAGVCGLVPVMAERYDDESQCSKTDERPASYFAVAVARKDSNVNWNNLKGKKSCHTAVGRTAGWVIPMGLIHNRTGTCNFDEYFSEGCAPGSPPNSRLCQLCQGSGGIPPEKCVASSHEKYFGYTGALRCLVEKGDVAFIQHSTVEENTGGKNKADWAKNLQMDDFELLCTDGRRANVMDYRECNLAEVPTHAVVVRPEKANKIRDLLERQEKRFGVNGSEKSKFMMFESQNKDLLFKDLTKCLFKVREGTTYKEFLGDKFYTVISSLKTCNPSDILQMCSFLEGK"
    ### file_dir
    spotlink_file_0908_BQ0_fDR = spotlink_root_dir + 'JYD_20220908_BQ0_HCDFT_result_filtered.csv'
    spotlink_file_0908_BQ1_fDR = spotlink_root_dir + 'JYD_20220908_BQ1_HCDFT_result_filtered.csv'
    spotlink_file_0908_BQ5_fDR = spotlink_root_dir + 'JYD_20220908_BQ5_HCDFT_result_filtered.csv'
    spotlink_file_0908_BQ25_fDR = spotlink_root_dir + 'JYD_20220908_BQ25_HCDFT_result_filtered.csv'
    spotlink_file_0908_BQ100_fDR = spotlink_root_dir + 'JYD_20220908_BQ100_HCDFT_result_filtered.csv'
    plink_file_0908_BQ0_fDR = plink_root_dir + "JYD_20220908_BQ0.csv"
    plink_file_0908_BQ5_fDR = plink_root_dir + "JYD_20220908_BQ5.csv"
    plink_file_0908_BQ25_fDR = plink_root_dir + "JYD_20220908_BQ25.csv"
    plink_file_0908_BQ100_fDR = plink_root_dir + "JYD_20220908_BQ100.csv"
    plink_file_0908_BQ1_fDR = plink_root_dir + "JYD_20220908_BQ1.csv"
    BQ0_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ0_fDR,
                                                 fasta,
                                                 f2sf=False)[0]
    BQ1_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ1_fDR,
                                                 fasta,
                                                 f2sf=False)[0]
    BQ5_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ5_fDR,
                                                 fasta,
                                                 f2sf=False)[0]
    BQ25_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ25_fDR,
                                                  fasta,
                                                  f2sf=False)[0]
    BQ100_0908_s = spotlink_report_valid_link_sfDR(
        spotlink_file_0908_BQ100_fDR, fasta, f2sf=False)[0]
    # BQ0_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ0_fDR,
    #                                              fasta,
    #                                              f2sf=True)[0]
    # BQ1_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ1_fDR,
    #                                              fasta,
    #                                              f2sf=True)[0]
    # BQ5_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ5_fDR,
    #                                              fasta,
    #                                              f2sf=True)[0]
    # BQ25_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ25_fDR,
    #                                               fasta,
    #                                               f2sf=True)[0]
    # BQ100_0908_s = spotlink_report_valid_link_sfDR(
    #     spotlink_file_0908_BQ100_fDR, fasta, f2sf=True)[0]
    BQ0_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ0_fDR,
                                              fasta)[0]
    BQ1_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ1_fDR,
                                              fasta)[0]
    BQ5_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ5_fDR,
                                              fasta)[0]
    BQ25_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ25_fDR,
                                               fasta)[0]
    BQ100_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ100_fDR,
                                                fasta)[0]
    ## repeat part

    BQ0_repeat = cal_multi_list([BQ0_0908_s, BQ0_0908_p])
    BQ1_repeat = cal_multi_list([BQ1_0908_s, BQ1_0908_p])
    BQ5_repeat = cal_multi_list([BQ5_0908_s, BQ5_0908_p])
    BQ25_repeat = cal_multi_list([BQ25_0908_s, BQ25_0908_p])
    BQ100_repeat = cal_multi_list([BQ100_0908_s, BQ100_0908_p])
    # BQ0_repeat = cal_multi_list([BQ0_0908_s, BQ0_0908_s])
    # BQ1_repeat = cal_multi_list([BQ1_0908_s, BQ1_0908_s])
    # BQ5_repeat = cal_multi_list([BQ5_0908_s, BQ5_0908_s])
    # BQ25_repeat = cal_multi_list([BQ25_0908_s, BQ25_0908_s])
    # BQ100_repeat = cal_multi_list([BQ100_0908_s, BQ100_0908_s])

    # BQ0_repeat = cal_multi_list([BQ0_0908_p, BQ0_0908_p])
    # BQ1_repeat = cal_multi_list([BQ1_0908_p, BQ1_0908_p])
    # BQ5_repeat = cal_multi_list([BQ5_0908_p, BQ5_0908_p])
    # BQ25_repeat = cal_multi_list([BQ25_0908_p, BQ25_0908_p])
    # BQ100_repeat = cal_multi_list([BQ100_0908_p, BQ100_0908_p])

    BQ_repeat_list = [
        BQ0_repeat, BQ1_repeat, BQ5_repeat, BQ25_repeat, BQ100_repeat
    ]
    BQ0_0908_s_list = [
        BQ0_0908_s, BQ1_0908_s, BQ5_0908_s, BQ25_0908_s, BQ100_0908_s
    ]

    for i in BQ_repeat_list:
        k = [
            j for j in i
            if fasta[int(j[0]) - 1] == "K" or fasta[int(j[1]) - 1] == "K"
        ]
        # cal_distance_pos_list(k[0:40],
        #                       fasta=fasta,
        #                       pdb_file='G:/MSdata/pdb/conalbumin.pdb',
        #                       print_all=False)
        report_animo_ratio(k,
                           pos_form=True,
                           fasta_file=fasta,
                           tableform=True,
                           ratio_output=False,
                           threshold=40)

  # plink2crosslink(
    #     "G:/MSdata/220929HSAEGGMILK/plink/pLink_task_2022.09.29.19.41.01/reports/HSA_2022.09.29.filtered_cross-linked_spectra.csv",
    #     "G:/MSdata/220929HSAEGGMILK/plink/pLink_task_2022.09.29.19.41.01/reports/crosslink_spotlinkform/"
    # )

    print("*" * 40)
    print("--HSA--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/220929HSAEGGMILK/spotlink/"
    plink_root_dir = "G:/MSdata/220929HSAEGGMILK/plink/pLink_task_2022.09.29.19.41.01/reports/crosslink_spotlinkform/"
    ### fasta
    fasta = "MKWVTFISLLFLFSSAYSRGVFRRDAHKSEVAHRFKDLGEENFKALVLIAFAQYLQQCPFEDHVKLVNEVTEFAKTCVADESAENCDKSLHTLFGDKLCTVATLRETYGEMADCCAKQEPERNECFLQHKDDNPNLPRLVRPEVDVMCTAFHDNEETFLKKYLYEIARRHPYFYAPELLFFAKRYKAAFTECCQAADKAACLLPKLDELRDEGKASSAKQRLKCASLQKFGERAFKAWAVARLSQRFPKAEFAEVSKLVTDLTKVHTECCHGDLLECADDRADLAKYICENQDSISSKLKECCEKPLLEKSHCIAEVENDEMPADLPSLAADFVESKDVCKNYAEAKDVFLGMFLYEYARRHPDYSVVLLLRLAKTYETTLEKCCAAADPHECYAKVFDEFKPLVEEPQNLIKQNCELFEQLGEYKFQNALLVRYTKKVPQVSTPTLVEVSRNLGKVGSKCCKHPEAKRMPCAEDYLSVVLNQLCVLHEKTPVSDRVTKCCTESLVNRRPCFSALEVDETYVPKEFNAETFTFHADICTLSEKERQIKKQTALVELVKHKPKATKEQLKAVMDDFAAFVEKCCKADDKETCFAEEGKKLVAASQAALGL"
    ### file_dir
    spotlink_file_0923_H0_fDR = spotlink_root_dir + 'JYD_20220923_H0_HCDFT_result_filtered.csv'
    spotlink_file_0923_H1_fDR = spotlink_root_dir + 'JYD_20220923_H1_HCDFT_result_filtered.csv'
    spotlink_file_0923_H5_fDR = spotlink_root_dir + 'JYD_20220923_H5_HCDFT_result_filtered.csv'
    spotlink_file_0923_H25_fDR = spotlink_root_dir + 'JYD_20220923_H25_HCDFT_result_filtered.csv'
    spotlink_file_0923_H100_fDR = spotlink_root_dir + 'JYD_20220923_H100_HCDFT_result_filtered.csv'
    plink_file_0923_H0_fDR = plink_root_dir + "JYD_20220923_H0.csv"
    plink_file_0923_H5_fDR = plink_root_dir + "JYD_20220923_H5.csv"
    plink_file_0923_H25_fDR = plink_root_dir + "JYD_20220923_H25.csv"
    plink_file_0923_H100_fDR = plink_root_dir + "JYD_20220923_H100.csv"
    plink_file_0923_H1_fDR = plink_root_dir + "JYD_20220923_H1.csv"
    H0_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H0_fDR,
                                                fasta,
                                                f2sf=False)[0]
    H1_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H1_fDR,
                                                fasta,
                                                f2sf=False)[0]
    H5_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H5_fDR,
                                                fasta,
                                                f2sf=False)[0]
    H25_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H25_fDR,
                                                 fasta,
                                                 f2sf=False)[0]
    H100_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H100_fDR,
                                                  fasta,
                                                  f2sf=False)[0]
    # H0_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H0_fDR,
    #                                             fasta,
    #                                             f2sf=True)[0]
    # H1_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H1_fDR,
    #                                             fasta,
    #                                             f2sf=True)[0]
    # H5_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H5_fDR,
    #                                             fasta,
    #                                             f2sf=True)[0]
    # H25_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H25_fDR,
    #                                              fasta,
    #                                              f2sf=True)[0]
    # H100_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H100_fDR,
    #                                               fasta,
    #                                               f2sf=True)[0]
    H0_0923_p = plink_report_valid_link_sfDR(plink_file_0923_H0_fDR, fasta)[0]
    H1_0923_p = plink_report_valid_link_sfDR(plink_file_0923_H1_fDR, fasta)[0]
    H5_0923_p = plink_report_valid_link_sfDR(plink_file_0923_H5_fDR, fasta)[0]
    H25_0923_p = plink_report_valid_link_sfDR(plink_file_0923_H25_fDR,
                                              fasta)[0]
    H100_0923_p = plink_report_valid_link_sfDR(plink_file_0923_H100_fDR,
                                               fasta)[0]
    ## repeat part

    H0_repeat = cal_multi_list([H0_0923_s, H0_0923_p])
    H1_repeat = cal_multi_list([H1_0923_s, H1_0923_p])
    H5_repeat = cal_multi_list([H5_0923_s, H5_0923_p])
    H25_repeat = cal_multi_list([H25_0923_s, H25_0923_p])
    H100_repeat = cal_multi_list([H100_0923_s, H100_0923_p])
    # H0_repeat = cal_multi_list([H0_0923_s, H0_0923_s])
    # H1_repeat = cal_multi_list([H1_0923_s, H1_0923_s])
    # H5_repeat = cal_multi_list([H5_0923_s, H5_0923_s])
    # H25_repeat = cal_multi_list([H25_0923_s, H25_0923_s])
    # H100_repeat = cal_multi_list([H100_0923_s, H100_0923_s])

    # H0_repeat = cal_multi_list([H0_0923_p, H0_0923_p])
    # H1_repeat = cal_multi_list([H1_0923_p, H1_0923_p])
    # H5_repeat = cal_multi_list([H5_0923_p, H5_0923_p])
    # H25_repeat = cal_multi_list([H25_0923_p, H25_0923_p])
    # H100_repeat = cal_multi_list([H100_0923_p, H100_0923_p])

    H_repeat_list = [H0_repeat, H1_repeat, H5_repeat, H25_repeat, H100_repeat]
    H0_0923_s_list = [H0_0923_s, H1_0923_s, H5_0923_s, H25_0923_s, H100_0923_s]

    for i in H_repeat_list:
        k = [
            j for j in i
            if fasta[int(j[0]) - 1] == "K" or fasta[int(j[1]) - 1] == "K"
        ]
        cal_distance_pos_list(k[0:75],
                              fasta=fasta,
                              pdb_file='G:/MSdata/pdb/HSA.pdb',
                              print_all=False)
        report_animo_ratio(k,
                           pos_form=True,
                           fasta_file=fasta,
                           tableform=True,
                           ratio_output=True,
                           threshold=75)

 # plink2crosslink(
    #     "G:/MSdata/220929HSAEGGMILK/plink/pLink_task_2022.09.29.19.50.24/reports/Lactoferrin_2022.09.29.filtered_cross-linked_spectra.csv",
    #     "G:/MSdata/220929HSAEGGMILK/plink/pLink_task_2022.09.29.19.50.24/reports/crosslink_spotlinkform/"
    # )

    print("*" * 40)
    print("--Lactoferrin--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/220929HSAEGGMILK/spotlink/"
    plink_root_dir = "G:/MSdata/220929HSAEGGMILK/plink/pLink_task_2022.09.29.19.50.24//reports/crosslink_spotlinkform/"
    ### fasta
    fasta = "CTISQPEWFKCRRWQWRMKKLGAPSITCVRRAFALECIRAIAEKKADAVTLDGGMVFEACRDPYKLRPVAAEIYGTKESPQTHYYAVAVVKKGSNFQLDQLQGRKSCHTGLGRSAGWIIPMGILRPYLSWTESLEPLQGAVAKFFSASCVPCIDRQAYPNLCQLCKGEGENQCACSSREPYFGYSGAFKCLQDGAGDVAFVKETTVFENLPEKADRDQYELLCLNNSRAPVDAFKECHLAQVPSHAVVARSVDGKEDLIWKLLSKAQEKFGKNKSRSFQLFGSPPGQRDLLFKDSALGFLRIPSKVDSALYLGSRYLTTLKNLRETAEEVKARYTRVVWCAVGPEEQKKCQQWSQQSGQNVTCATASTTDDCIVLVLKGEADALNLDGGYIYTAGKCGLVPVLAENRKSSKHSSLDCVLRPTEGYLAVAVVKKANEGLTWNSLKDKKSCHTAVDRTAGWNIPMGLIVNQTGSCAFDEFFSQSCAPGADPKSRLCALCAGDDQGLDKCVPNSKEKYYGYTGAFRCLAEDVGDVAFVKNDTVWENTNGESTADWAKNLNREDFRLLCLDGTRKPVTEAQSCHLAVAPNHAVVSRSDRAAHVKQVLLHQQALFGKNGKNCPDKFCLFKSETKNLLFNDNTECLAKLGGRPTYEEYLGTEYVTAIANLKKCSTSPLLEACAFLTR"
    ### file_dir
    spotlink_file_0923_M0_fDR = spotlink_root_dir + 'JYD_20220923_M0_HCDFT_result_filtered.csv'
    spotlink_file_0923_M1_fDR = spotlink_root_dir + 'JYD_20220923_M1_HCDFT_result_filtered.csv'
    spotlink_file_0923_M5_fDR = spotlink_root_dir + 'JYD_20220923_M5_HCDFT_result_filtered.csv'
    spotlink_file_0923_M25_fDR = spotlink_root_dir + 'JYD_20220923_M25_HCDFT_result_filtered.csv'
    spotlink_file_0923_M100_fDR = spotlink_root_dir + 'JYD_20220923_M100_HCDFT_result_filtered.csv'
    plink_file_0923_M0_fDR = plink_root_dir + "JYD_20220923_M0.csv"
    plink_file_0923_M5_fDR = plink_root_dir + "JYD_20220923_M5.csv"
    plink_file_0923_M25_fDR = plink_root_dir + "JYD_20220923_M25.csv"
    plink_file_0923_M100_fDR = plink_root_dir + "JYD_20220923_M100.csv"
    plink_file_0923_M1_fDR = plink_root_dir + "JYD_20220923_M1.csv"
    M0_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M0_fDR,
                                                fasta,
                                                f2sf=False)[0]
    M1_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M1_fDR,
                                                fasta,
                                                f2sf=False)[0]
    M5_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M5_fDR,
                                                fasta,
                                                f2sf=False)[0]
    M25_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M25_fDR,
                                                 fasta,
                                                 f2sf=False)[0]
    M100_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M100_fDR,
                                                  fasta,
                                                  f2sf=False)[0]
    # M0_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M0_fDR,
    #                                             fasta,
    #                                             f2sf=True)[0]
    # M1_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M1_fDR,
    #                                             fasta,
    #                                             f2sf=True)[0]
    # M5_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M5_fDR,
    #                                             fasta,
    #                                             f2sf=True)[0]
    # M25_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M25_fDR,
    #                                              fasta,
    #                                              f2sf=True)[0]
    # M100_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M100_fDR,
    #                                               fasta,
    #                                               f2sf=True)[0]
    M0_0923_p = plink_report_valid_link_sfDR(plink_file_0923_M0_fDR, fasta)[0]
    M1_0923_p = plink_report_valid_link_sfDR(plink_file_0923_M1_fDR, fasta)[0]
    M5_0923_p = plink_report_valid_link_sfDR(plink_file_0923_M5_fDR, fasta)[0]
    M25_0923_p = plink_report_valid_link_sfDR(plink_file_0923_M25_fDR,
                                              fasta)[0]
    M100_0923_p = plink_report_valid_link_sfDR(plink_file_0923_M100_fDR,
                                               fasta)[0]
    ## repeat part

    M0_repeat = cal_multi_list([M0_0923_s, M0_0923_p])
    M1_repeat = cal_multi_list([M1_0923_s, M1_0923_p])
    M5_repeat = cal_multi_list([M5_0923_s, M5_0923_p])
    M25_repeat = cal_multi_list([M25_0923_s, M25_0923_p])
    M100_repeat = cal_multi_list([M100_0923_s, M100_0923_p])
    # M0_repeat = cal_multi_list([M0_0923_s, M0_0923_s])
    # M1_repeat = cal_multi_list([M1_0923_s, M1_0923_s])
    # M5_repeat = cal_multi_list([M5_0923_s, M5_0923_s])
    # M25_repeat = cal_multi_list([M25_0923_s, M25_0923_s])
    # M100_repeat = cal_multi_list([M100_0923_s, M100_0923_s])

    # M0_repeat = cal_multi_list([M0_0923_p, M0_0923_p])
    # M1_repeat = cal_multi_list([M1_0923_p, M1_0923_p])
    # M5_repeat = cal_multi_list([M5_0923_p, M5_0923_p])
    # M25_repeat = cal_multi_list([M25_0923_p, M25_0923_p])
    # M100_repeat = cal_multi_list([M100_0923_p, M100_0923_p])

    M_repeat_list = [M0_repeat, M1_repeat, M5_repeat, M25_repeat, M100_repeat]
    M0_0923_s_list = [M0_0923_s, M1_0923_s, M5_0923_s, M25_0923_s, M100_0923_s]

    for i in M_repeat_list:
        k = [
            j for j in i
            if fasta[int(j[0]) - 1] == "K" or fasta[int(j[1]) - 1] == "K"
        ]
        cal_distance_pos_list(k[0:25],
                              fasta=fasta,
                              pdb_file='G:/MSdata/pdb/lactoferrin.pdb',
                              print_all=False)
        report_animo_ratio(k,
                           pos_form=True,
                           fasta_file=fasta,
                           tableform=True,
                           ratio_output=True,
                           threshold=25)

## 20221008

    print("*" * 40)
    print("--BSA--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/220913BSABQXL/spotlink/"
    plink_root_dir = "G:/MSdata/220913BSABQXL/plink/pLink_task_2022.09.15.14.35.11/reports/crosslink_spotlinkform/"
    ### fasta
    bsa_fasta = "MKWVTFISLLLLFSSAYSRGVFRRDTHKSEIAHRFKDLGEEHFKGLVLIAFSQYLQQCPFDEHVKLVNELTEFAKTCVADESHAGCEKSLHTLFGDELCKVASLRETYGDMADCCEKQEPERNECFLSHKDDSPDLPKLKPDPNTLCDEFKADEKKFWGKYLYEIARRHPYFYAPELLYYANKYNGVFQECCQAEDKGACLLPKIETMREKVLTSSARQRLRCASIQKFGERALKAWSVARLSQKFPKAEFVEVTKLVTDLTKVHKECCHGDLLECADDRADLAKYICDNQDTISSKLKECCDKPLLEKSHCIAEVEKDAIPENLPPLTADFAEDKDVCKNYQEAKDAFLGSFLYEYSRRHPEYAVSVLLRLAKEYEATLEECCAKDDPHACYSTVFDKLKHLVDEPQNLIKQNCDQFEKLGEYGFQNALIVRYTRKVPQVSTPTLVEVSRSLGKVGTRCCTKPESERMPCTEDYLSLILNRLCVLHEKTPVSEKVTKCCTESLVNRRPCFSALTPDETYVPKAFDEKLFTFHADICTLPDTEKQIKKQTALVELLKHKPKATEEQLKTVMENFVAFVDKCCAADDKEACFAVEGPKLVVSTQTALA"
    ### file_dir
    spotlink_file_0908_B0_fDR = spotlink_root_dir + 'JYD_20220908_B0_HCDFT_result_filtered.csv'
    spotlink_file_0908_B1_fDR = spotlink_root_dir + 'JYD_20220908_B1_HCDFT_result_filtered.csv'
    spotlink_file_0908_B5_fDR = spotlink_root_dir + 'JYD_20220908_B5_HCDFT_result_filtered.csv'
    spotlink_file_0908_B25_fDR = spotlink_root_dir + 'JYD_20220908_B25_HCDFT_result_filtered.csv'
    spotlink_file_0908_B100_fDR = spotlink_root_dir + 'JYD_20220908_B100_HCDFT_result_filtered.csv'
    plink_file_0908_B0_fDR = plink_root_dir + "JYD_20220908_B0.csv"
    plink_file_0908_B5_fDR = plink_root_dir + "JYD_20220908_B5.csv"
    plink_file_0908_B25_fDR = plink_root_dir + "JYD_20220908_B25.csv"
    plink_file_0908_B100_fDR = plink_root_dir + "JYD_20220908_B100.csv"
    plink_file_0908_B1_fDR = plink_root_dir + "JYD_20220908_B1.csv"
    B0_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B0_fDR,
                                                bsa_fasta,
                                                f2sf=False)[0]
    B1_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B1_fDR,
                                                bsa_fasta,
                                                f2sf=False)[0]
    B5_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B5_fDR,
                                                bsa_fasta,
                                                f2sf=False)[0]
    B25_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B25_fDR,
                                                 bsa_fasta,
                                                 f2sf=False)[0]
    B100_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B100_fDR,
                                                  bsa_fasta,
                                                  f2sf=False)[0]
    B0_0908_sf = spotlink_report_valid_link_sfDR(spotlink_file_0908_B0_fDR,
                                                 bsa_fasta,
                                                 f2sf=True)[0]
    B1_0908_sf = spotlink_report_valid_link_sfDR(spotlink_file_0908_B1_fDR,
                                                 bsa_fasta,
                                                 f2sf=True)[0]
    B5_0908_sf = spotlink_report_valid_link_sfDR(spotlink_file_0908_B5_fDR,
                                                 bsa_fasta,
                                                 f2sf=True)[0]
    B25_0908_sf = spotlink_report_valid_link_sfDR(spotlink_file_0908_B25_fDR,
                                                  bsa_fasta,
                                                  f2sf=True)[0]
    B100_0908_sf = spotlink_report_valid_link_sfDR(spotlink_file_0908_B100_fDR,
                                                   bsa_fasta,
                                                   f2sf=True)[0]
    B0_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B0_fDR,
                                             bsa_fasta)[0]
    B1_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B1_fDR,
                                             bsa_fasta)[0]
    B5_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B5_fDR,
                                             bsa_fasta)[0]
    B25_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B25_fDR,
                                              bsa_fasta)[0]
    B100_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B100_fDR,
                                               bsa_fasta)[0]

    print("*" * 40)
    print("--BQ--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/220913BSABQXL/spotlink/"
    plink_root_dir = "G:/MSdata/220913BSABQXL/plink/pLink_task_2022.09.15.14.44.33/reports/crosslink_spotlinkform/"
    ### fasta
    bq_fasta = "MKLILCTVLSLGIAAVCFAAPPKSVIRWCTISSPEEKKCNNLRDLTQQERISLTCVQKATYLDCIKAIANNEADAISLDGGQAFEAGLAPYKLKPIAAEVYEHTEGSTTSYYAVAVVKKGTEFTVNDLQGKTSCHTGLGRSAGWNIPIGTLLHRGAIEWEGIESGSVEQAVAKFFSASCVPGATIEQKLCRQCKGDPKTKCARNAPYSGYSGAFHCLKDGKGDVAFVKHTTVNENAPDQKDEYELLCLDGSRQPVDNYKTCNWARVAAHAVVARDDNKVEDIWSFLSKAQSDFGVDTKSDFHLFGPPGKKDPVLKDLLFKDSAIMLKRVPSLMDSQLYLGFEYYSAIQSMRKDQLTPSPRENRIQWCAVGKDEKSKCDRWSVVSNGDVECTVVDETKDCIIKIMKGEADAVALDGGLVYTAGVCGLVPVMAERYDDESQCSKTDERPASYFAVAVARKDSNVNWNNLKGKKSCHTAVGRTAGWVIPMGLIHNRTGTCNFDEYFSEGCAPGSPPNSRLCQLCQGSGGIPPEKCVASSHEKYFGYTGALRCLVEKGDVAFIQHSTVEENTGGKNKADWAKNLQMDDFELLCTDGRRANVMDYRECNLAEVPTHAVVVRPEKANKIRDLLERQEKRFGVNGSEKSKFMMFESQNKDLLFKDLTKCLFKVREGTTYKEFLGDKFYTVISSLKTCNPSDILQMCSFLEGK"
    ### file_dir
    spotlink_file_0908_BQ0_fDR = spotlink_root_dir + 'JYD_20220908_BQ0_HCDFT_result_filtered.csv'
    spotlink_file_0908_BQ1_fDR = spotlink_root_dir + 'JYD_20220908_BQ1_HCDFT_result_filtered.csv'
    spotlink_file_0908_BQ5_fDR = spotlink_root_dir + 'JYD_20220908_BQ5_HCDFT_result_filtered.csv'
    spotlink_file_0908_BQ25_fDR = spotlink_root_dir + 'JYD_20220908_BQ25_HCDFT_result_filtered.csv'
    spotlink_file_0908_BQ100_fDR = spotlink_root_dir + 'JYD_20220908_BQ100_HCDFT_result_filtered.csv'
    plink_file_0908_BQ0_fDR = plink_root_dir + "JYD_20220908_BQ0.csv"
    plink_file_0908_BQ5_fDR = plink_root_dir + "JYD_20220908_BQ5.csv"
    plink_file_0908_BQ25_fDR = plink_root_dir + "JYD_20220908_BQ25.csv"
    plink_file_0908_BQ100_fDR = plink_root_dir + "JYD_20220908_BQ100.csv"
    plink_file_0908_BQ1_fDR = plink_root_dir + "JYD_20220908_BQ1.csv"
    BQ0_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ0_fDR,
                                                 bq_fasta,
                                                 f2sf=False)[0]
    BQ1_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ1_fDR,
                                                 bq_fasta,
                                                 f2sf=False)[0]
    BQ5_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ5_fDR,
                                                 bq_fasta,
                                                 f2sf=False)[0]
    BQ25_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ25_fDR,
                                                  bq_fasta,
                                                  f2sf=False)[0]
    BQ100_0908_s = spotlink_report_valid_link_sfDR(
        spotlink_file_0908_BQ100_fDR, bq_fasta, f2sf=False)[0]
    BQ0_0908_sf = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ0_fDR,
                                                  bq_fasta,
                                                  f2sf=True)[0]
    BQ1_0908_sf = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ1_fDR,
                                                  bq_fasta,
                                                  f2sf=True)[0]
    BQ5_0908_sf = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ5_fDR,
                                                  bq_fasta,
                                                  f2sf=True)[0]
    BQ25_0908_sf = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ25_fDR,
                                                   bq_fasta,
                                                   f2sf=True)[0]
    BQ100_0908_sf = spotlink_report_valid_link_sfDR(
        spotlink_file_0908_BQ100_fDR, bq_fasta, f2sf=True)[0]
    BQ0_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ0_fDR,
                                              bq_fasta)[0]
    BQ1_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ1_fDR,
                                              bq_fasta)[0]
    BQ5_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ5_fDR,
                                              bq_fasta)[0]
    BQ25_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ25_fDR,
                                               bq_fasta)[0]
    BQ100_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ100_fDR,
                                                bq_fasta)[0]

    print("*" * 40)
    print("--HSA--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/220929HSAEGGMILK/spotlink/"
    plink_root_dir = "G:/MSdata/220929HSAEGGMILK/plink/pLink_task_2022.09.29.19.41.01/reports/crosslink_spotlinkform/"
    ### fasta
    hsa_fasta = "MKWVTFISLLFLFSSAYSRGVFRRDAHKSEVAHRFKDLGEENFKALVLIAFAQYLQQCPFEDHVKLVNEVTEFAKTCVADESAENCDKSLHTLFGDKLCTVATLRETYGEMADCCAKQEPERNECFLQHKDDNPNLPRLVRPEVDVMCTAFHDNEETFLKKYLYEIARRHPYFYAPELLFFAKRYKAAFTECCQAADKAACLLPKLDELRDEGKASSAKQRLKCASLQKFGERAFKAWAVARLSQRFPKAEFAEVSKLVTDLTKVHTECCHGDLLECADDRADLAKYICENQDSISSKLKECCEKPLLEKSHCIAEVENDEMPADLPSLAADFVESKDVCKNYAEAKDVFLGMFLYEYARRHPDYSVVLLLRLAKTYETTLEKCCAAADPHECYAKVFDEFKPLVEEPQNLIKQNCELFEQLGEYKFQNALLVRYTKKVPQVSTPTLVEVSRNLGKVGSKCCKHPEAKRMPCAEDYLSVVLNQLCVLHEKTPVSDRVTKCCTESLVNRRPCFSALEVDETYVPKEFNAETFTFHADICTLSEKERQIKKQTALVELVKHKPKATKEQLKAVMDDFAAFVEKCCKADDKETCFAEEGKKLVAASQAALGL"
    ### file_dir
    spotlink_file_0923_H0_fDR = spotlink_root_dir + 'JYD_20220923_H0_HCDFT_result_filtered.csv'
    spotlink_file_0923_H1_fDR = spotlink_root_dir + 'JYD_20220923_H1_HCDFT_result_filtered.csv'
    spotlink_file_0923_H5_fDR = spotlink_root_dir + 'JYD_20220923_H5_HCDFT_result_filtered.csv'
    spotlink_file_0923_H25_fDR = spotlink_root_dir + 'JYD_20220923_H25_HCDFT_result_filtered.csv'
    spotlink_file_0923_H100_fDR = spotlink_root_dir + 'JYD_20220923_H100_HCDFT_result_filtered.csv'
    plink_file_0923_H0_fDR = plink_root_dir + "JYD_20220923_H0.csv"
    plink_file_0923_H5_fDR = plink_root_dir + "JYD_20220923_H5.csv"
    plink_file_0923_H25_fDR = plink_root_dir + "JYD_20220923_H25.csv"
    plink_file_0923_H100_fDR = plink_root_dir + "JYD_20220923_H100.csv"
    plink_file_0923_H1_fDR = plink_root_dir + "JYD_20220923_H1.csv"
    H0_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H0_fDR,
                                                hsa_fasta,
                                                f2sf=False)[0]
    H1_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H1_fDR,
                                                hsa_fasta,
                                                f2sf=False)[0]
    H5_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H5_fDR,
                                                hsa_fasta,
                                                f2sf=False)[0]
    H25_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H25_fDR,
                                                 hsa_fasta,
                                                 f2sf=False)[0]
    H100_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H100_fDR,
                                                  hsa_fasta,
                                                  f2sf=False)[0]
    H0_0923_sf = spotlink_report_valid_link_sfDR(spotlink_file_0923_H0_fDR,
                                                 hsa_fasta,
                                                 f2sf=True)[0]
    H1_0923_sf = spotlink_report_valid_link_sfDR(spotlink_file_0923_H1_fDR,
                                                 hsa_fasta,
                                                 f2sf=True)[0]
    H5_0923_sf = spotlink_report_valid_link_sfDR(spotlink_file_0923_H5_fDR,
                                                 hsa_fasta,
                                                 f2sf=True)[0]
    H25_0923_sf = spotlink_report_valid_link_sfDR(spotlink_file_0923_H25_fDR,
                                                  hsa_fasta,
                                                  f2sf=True)[0]
    H100_0923_sf = spotlink_report_valid_link_sfDR(spotlink_file_0923_H100_fDR,
                                                   hsa_fasta,
                                                   f2sf=True)[0]
    H0_0923_p = plink_report_valid_link_sfDR(plink_file_0923_H0_fDR,
                                             hsa_fasta)[0]
    H1_0923_p = plink_report_valid_link_sfDR(plink_file_0923_H1_fDR,
                                             hsa_fasta)[0]
    H5_0923_p = plink_report_valid_link_sfDR(plink_file_0923_H5_fDR,
                                             hsa_fasta)[0]
    H25_0923_p = plink_report_valid_link_sfDR(plink_file_0923_H25_fDR,
                                              hsa_fasta)[0]
    H100_0923_p = plink_report_valid_link_sfDR(plink_file_0923_H100_fDR,
                                               hsa_fasta)[0]

    print("*" * 40)
    print("--Lactoferrin--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/220929HSAEGGMILK/spotlink/"
    plink_root_dir = "G:/MSdata/220929HSAEGGMILK/plink/pLink_task_2022.09.29.19.50.24//reports/crosslink_spotlinkform/"
    ### fasta
    lactoferrin_fasta = "CTISQPEWFKCRRWQWRMKKLGAPSITCVRRAFALECIRAIAEKKADAVTLDGGMVFEACRDPYKLRPVAAEIYGTKESPQTHYYAVAVVKKGSNFQLDQLQGRKSCHTGLGRSAGWIIPMGILRPYLSWTESLEPLQGAVAKFFSASCVPCIDRQAYPNLCQLCKGEGENQCACSSREPYFGYSGAFKCLQDGAGDVAFVKETTVFENLPEKADRDQYELLCLNNSRAPVDAFKECHLAQVPSHAVVARSVDGKEDLIWKLLSKAQEKFGKNKSRSFQLFGSPPGQRDLLFKDSALGFLRIPSKVDSALYLGSRYLTTLKNLRETAEEVKARYTRVVWCAVGPEEQKKCQQWSQQSGQNVTCATASTTDDCIVLVLKGEADALNLDGGYIYTAGKCGLVPVLAENRKSSKHSSLDCVLRPTEGYLAVAVVKKANEGLTWNSLKDKKSCHTAVDRTAGWNIPMGLIVNQTGSCAFDEFFSQSCAPGADPKSRLCALCAGDDQGLDKCVPNSKEKYYGYTGAFRCLAEDVGDVAFVKNDTVWENTNGESTADWAKNLNREDFRLLCLDGTRKPVTEAQSCHLAVAPNHAVVSRSDRAAHVKQVLLHQQALFGKNGKNCPDKFCLFKSETKNLLFNDNTECLAKLGGRPTYEEYLGTEYVTAIANLKKCSTSPLLEACAFLTR"
    ### file_dir
    spotlink_file_0923_M0_fDR = spotlink_root_dir + 'JYD_20220923_M0_HCDFT_result_filtered.csv'
    spotlink_file_0923_M1_fDR = spotlink_root_dir + 'JYD_20220923_M1_HCDFT_result_filtered.csv'
    spotlink_file_0923_M5_fDR = spotlink_root_dir + 'JYD_20220923_M5_HCDFT_result_filtered.csv'
    spotlink_file_0923_M25_fDR = spotlink_root_dir + 'JYD_20220923_M25_HCDFT_result_filtered.csv'
    spotlink_file_0923_M100_fDR = spotlink_root_dir + 'JYD_20220923_M100_HCDFT_result_filtered.csv'
    plink_file_0923_M0_fDR = plink_root_dir + "JYD_20220923_M0.csv"
    plink_file_0923_M5_fDR = plink_root_dir + "JYD_20220923_M5.csv"
    plink_file_0923_M25_fDR = plink_root_dir + "JYD_20220923_M25.csv"
    plink_file_0923_M100_fDR = plink_root_dir + "JYD_20220923_M100.csv"
    plink_file_0923_M1_fDR = plink_root_dir + "JYD_20220923_M1.csv"
    M0_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M0_fDR,
                                                lactoferrin_fasta,
                                                f2sf=False)[0]
    M1_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M1_fDR,
                                                lactoferrin_fasta,
                                                f2sf=False)[0]
    M5_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M5_fDR,
                                                lactoferrin_fasta,
                                                f2sf=False)[0]
    M25_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M25_fDR,
                                                 lactoferrin_fasta,
                                                 f2sf=False)[0]
    M100_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M100_fDR,
                                                  lactoferrin_fasta,
                                                  f2sf=False)[0]
    M0_0923_sf = spotlink_report_valid_link_sfDR(spotlink_file_0923_M0_fDR,
                                                 lactoferrin_fasta,
                                                 f2sf=True)[0]
    M1_0923_sf = spotlink_report_valid_link_sfDR(spotlink_file_0923_M1_fDR,
                                                 lactoferrin_fasta,
                                                 f2sf=True)[0]
    M5_0923_sf = spotlink_report_valid_link_sfDR(spotlink_file_0923_M5_fDR,
                                                 lactoferrin_fasta,
                                                 f2sf=True)[0]
    M25_0923_sf = spotlink_report_valid_link_sfDR(spotlink_file_0923_M25_fDR,
                                                  lactoferrin_fasta,
                                                  f2sf=True)[0]
    M100_0923_sf = spotlink_report_valid_link_sfDR(spotlink_file_0923_M100_fDR,
                                                   lactoferrin_fasta,
                                                   f2sf=True)[0]
    M0_0923_p = plink_report_valid_link_sfDR(plink_file_0923_M0_fDR,
                                             lactoferrin_fasta)[0]
    M1_0923_p = plink_report_valid_link_sfDR(plink_file_0923_M1_fDR,
                                             lactoferrin_fasta)[0]
    M5_0923_p = plink_report_valid_link_sfDR(plink_file_0923_M5_fDR,
                                             lactoferrin_fasta)[0]
    M25_0923_p = plink_report_valid_link_sfDR(plink_file_0923_M25_fDR,
                                              lactoferrin_fasta)[0]
    M100_0923_p = plink_report_valid_link_sfDR(plink_file_0923_M100_fDR,
                                               lactoferrin_fasta)[0]

    ## repeat part

    B0_repeat = cal_multi_list([B0_0908_s, B0_0908_p])
    B1_repeat = cal_multi_list([B1_0908_s, B1_0908_p])
    B5_repeat = cal_multi_list([B5_0908_s, B5_0908_p])
    B25_repeat = cal_multi_list([B25_0908_s, B25_0908_p])
    B100_repeat = cal_multi_list([B100_0908_s, B100_0908_p])
    # B0_repeat = cal_multi_list([B0_0908_s, B0_0908_s])
    # B1_repeat = cal_multi_list([B1_0908_s, B1_0908_s])
    # B5_repeat = cal_multi_list([B5_0908_s, B5_0908_s])
    # B25_repeat = cal_multi_list([B25_0908_s, B25_0908_s])
    # B100_repeat = cal_multi_list([B100_0908_s, B100_0908_s])
    # B0_repeat = cal_multi_list([B0_0908_p, B0_0908_p])
    # B1_repeat = cal_multi_list([B1_0908_p, B1_0908_p])
    # B5_repeat = cal_multi_list([B5_0908_p, B5_0908_p])
    # B25_repeat = cal_multi_list([B25_0908_p, B25_0908_p])
    # B100_repeat = cal_multi_list([B100_0908_p, B100_0908_p])

    BQ0_repeat = cal_multi_list([BQ0_0908_s, BQ0_0908_p])
    BQ1_repeat = cal_multi_list([BQ1_0908_s, BQ1_0908_p])
    BQ5_repeat = cal_multi_list([BQ5_0908_s, BQ5_0908_p])
    BQ25_repeat = cal_multi_list([BQ25_0908_s, BQ25_0908_p])
    BQ100_repeat = cal_multi_list([BQ100_0908_s, BQ100_0908_p])
    # BQ0_repeat = cal_multi_list([BQ0_0908_s, BQ0_0908_s])
    # BQ1_repeat = cal_multi_list([BQ1_0908_s, BQ1_0908_s])
    # BQ5_repeat = cal_multi_list([BQ5_0908_s, BQ5_0908_s])
    # BQ25_repeat = cal_multi_list([BQ25_0908_s, BQ25_0908_s])
    # BQ100_repeat = cal_multi_list([BQ100_0908_s, BQ100_0908_s])
    # BQ0_repeat = cal_multi_list([BQ0_0908_p, BQ0_0908_p])
    # BQ1_repeat = cal_multi_list([BQ1_0908_p, BQ1_0908_p])
    # BQ5_repeat = cal_multi_list([BQ5_0908_p, BQ5_0908_p])
    # BQ25_repeat = cal_multi_list([BQ25_0908_p, BQ25_0908_p])
    # BQ100_repeat = cal_multi_list([BQ100_0908_p, BQ100_0908_p])

    H0_repeat = cal_multi_list([H0_0923_s, H0_0923_p])
    H1_repeat = cal_multi_list([H1_0923_s, H1_0923_p])
    H5_repeat = cal_multi_list([H5_0923_s, H5_0923_p])
    H25_repeat = cal_multi_list([H25_0923_s, H25_0923_p])
    H100_repeat = cal_multi_list([H100_0923_s, H100_0923_p])
    # H0_repeat = cal_multi_list([H0_0923_s, H0_0923_s])
    # H1_repeat = cal_multi_list([H1_0923_s, H1_0923_s])
    # H5_repeat = cal_multi_list([H5_0923_s, H5_0923_s])
    # H25_repeat = cal_multi_list([H25_0923_s, H25_0923_s])
    # H100_repeat = cal_multi_list([H100_0923_s, H100_0923_s])
    # H0_repeat = cal_multi_list([H0_0923_p, H0_0923_p])
    # H1_repeat = cal_multi_list([H1_0923_p, H1_0923_p])
    # H5_repeat = cal_multi_list([H5_0923_p, H5_0923_p])
    # H25_repeat = cal_multi_list([H25_0923_p, H25_0923_p])
    # H100_repeat = cal_multi_list([H100_0923_p, H100_0923_p])

    M0_repeat = cal_multi_list([M0_0923_s, M0_0923_p])
    M1_repeat = cal_multi_list([M1_0923_s, M1_0923_p])
    M5_repeat = cal_multi_list([M5_0923_s, M5_0923_p])
    M25_repeat = cal_multi_list([M25_0923_s, M25_0923_p])
    M100_repeat = cal_multi_list([M100_0923_s, M100_0923_p])
    # M0_repeat = cal_multi_list([M0_0923_s, M0_0923_s])
    # M1_repeat = cal_multi_list([M1_0923_s, M1_0923_s])
    # M5_repeat = cal_multi_list([M5_0923_s, M5_0923_s])
    # M25_repeat = cal_multi_list([M25_0923_s, M25_0923_s])
    # M100_repeat = cal_multi_list([M100_0923_s, M100_0923_s])
    # M0_repeat = cal_multi_list([M0_0923_p, M0_0923_p])
    # M1_repeat = cal_multi_list([M1_0923_p, M1_0923_p])
    # M5_repeat = cal_multi_list([M5_0923_p, M5_0923_p])
    # M25_repeat = cal_multi_list([M25_0923_p, M25_0923_p])
    # M100_repeat = cal_multi_list([M100_0923_p, M100_0923_p])

    B_repeat_list = [B0_repeat, B1_repeat, B5_repeat, B25_repeat, B100_repeat]
    BQ_repeat_list = [
        BQ0_repeat, BQ1_repeat, BQ5_repeat, BQ25_repeat, BQ100_repeat
    ]
    H_repeat_list = [H0_repeat, H1_repeat, H5_repeat, H25_repeat, H100_repeat]
    M_repeat_list = [M0_repeat, M1_repeat, M5_repeat, M25_repeat, M100_repeat]

    for i in B_repeat_list:
        k = [
            j for j in i
            if bsa_fasta[int(j[0]) - 1] == "K" or bsa_fasta[int(j[1]) -
                                                            1] == "K"
        ]
        cal_distance_pos_list(k,
                              fasta=bsa_fasta,
                              pdb_file='G:/MSdata/pdb/bsa.pdb',
                              threshold=0.75,
                              print_all=False)
        report_animo_ratio(k,
                           pos_form=True,
                           fasta_file=bsa_fasta,
                           tableform=True,
                           ratio_output=False,
                           threshold=0.75)

    for i in BQ_repeat_list:
        if len(i) > 1:
            k = [
                j for j in i
                if bq_fasta[int(j[0]) - 1] == "K" or bq_fasta[int(j[1]) -
                                                              1] == "K"
            ]
        else:
            k = i

        cal_distance_pos_list(k,
                              fasta=bq_fasta,
                              pdb_file='G:/MSdata/pdb/conalbumin.pdb',
                              threshold=0.75,
                              print_all=False)
        report_animo_ratio(k,
                           pos_form=True,
                           fasta_file=bq_fasta,
                           tableform=True,
                           ratio_output=False,
                           threshold=0.75)

    for i in H_repeat_list:
        k = [
            j for j in i
            if hsa_fasta[int(j[0]) - 1] == "K" or hsa_fasta[int(j[1]) -
                                                            1] == "K"
        ]
        cal_distance_pos_list(k,
                              fasta=hsa_fasta,
                              pdb_file='G:/MSdata/pdb/HSA.pdb',
                              threshold=0.75,
                              print_all=False)
        report_animo_ratio(k,
                           pos_form=True,
                           fasta_file=hsa_fasta,
                           tableform=True,
                           ratio_output=False,
                           threshold=0.75)

    for i in M_repeat_list:
        k = [
            j for j in i
            if lactoferrin_fasta[int(j[0]) -
                                 1] == "K" or lactoferrin_fasta[int(j[1]) -
                                                                1] == "K"
        ]
        cal_distance_pos_list(k,
                              fasta=lactoferrin_fasta,
                              pdb_file='G:/MSdata/pdb/lactoferrin.pdb',
                              threshold=0.75,
                              print_all=False)
        report_animo_ratio(k,
                           pos_form=True,
                           fasta_file=lactoferrin_fasta,
                           tableform=True,
                           ratio_output=False,
                           threshold=0.75)
        
# 221018
   # plink2crosslink(
    #     "G:/MSdata/221018MixBQM/BSA/reports/MixBQM_2022.10.18.filtered_cross-linked_spectra.csv",
    #     "G:/MSdata/221018MixBQM/BSA/reports/crosslink_spotlinkform/")
    print("*" * 40)
    print("--BSA--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/221018MixBQM/BSA/spotlink/"
    plink_root_dir = "G:/MSdata/221018MixBQM/BSA/reports/crosslink_spotlinkform/"
    ### fasta
    bsa_fasta = "MKWVTFISLLLLFSSAYSRGVFRRDTHKSEIAHRFKDLGEEHFKGLVLIAFSQYLQQCPFDEHVKLVNELTEFAKTCVADESHAGCEKSLHTLFGDELCKVASLRETYGDMADCCEKQEPERNECFLSHKDDSPDLPKLKPDPNTLCDEFKADEKKFWGKYLYEIARRHPYFYAPELLYYANKYNGVFQECCQAEDKGACLLPKIETMREKVLTSSARQRLRCASIQKFGERALKAWSVARLSQKFPKAEFVEVTKLVTDLTKVHKECCHGDLLECADDRADLAKYICDNQDTISSKLKECCDKPLLEKSHCIAEVEKDAIPENLPPLTADFAEDKDVCKNYQEAKDAFLGSFLYEYSRRHPEYAVSVLLRLAKEYEATLEECCAKDDPHACYSTVFDKLKHLVDEPQNLIKQNCDQFEKLGEYGFQNALIVRYTRKVPQVSTPTLVEVSRSLGKVGTRCCTKPESERMPCTEDYLSLILNRLCVLHEKTPVSEKVTKCCTESLVNRRPCFSALTPDETYVPKAFDEKLFTFHADICTLPDTEKQIKKQTALVELLKHKPKATEEQLKTVMENFVAFVDKCCAADDKEACFAVEGPKLVVSTQTALA"
    ### file_dir
    spotlink_file_0908_B0_fDR = spotlink_root_dir + 'JYD_20220908_B0_HCDFT_result_filtered.csv'
    spotlink_file_0908_B1_fDR = spotlink_root_dir + 'JYD_20220908_B1_HCDFT_result_filtered.csv'
    spotlink_file_0908_B5_fDR = spotlink_root_dir + 'JYD_20220908_B5_HCDFT_result_filtered.csv'
    spotlink_file_0908_B25_fDR = spotlink_root_dir + 'JYD_20220908_B25_HCDFT_result_filtered.csv'
    spotlink_file_0908_B100_fDR = spotlink_root_dir + 'JYD_20220908_B100_HCDFT_result_filtered.csv'
    plink_file_0908_B0_fDR = plink_root_dir + "JYD_20220908_B0.csv"
    plink_file_0908_B5_fDR = plink_root_dir + "JYD_20220908_B5.csv"
    plink_file_0908_B25_fDR = plink_root_dir + "JYD_20220908_B25.csv"
    plink_file_0908_B100_fDR = plink_root_dir + "JYD_20220908_B100.csv"
    plink_file_0908_B1_fDR = plink_root_dir + "JYD_20220908_B1.csv"
    # B0_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B0_fDR,
    #                                             bsa_fasta,
    #                                             f2sf=False)[0]
    # B1_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B1_fDR,
    #                                             bsa_fasta,
    #                                             f2sf=False)[0]
    # B5_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B5_fDR,
    #                                             bsa_fasta,
    #                                             f2sf=False)[0]
    # B25_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B25_fDR,
    #                                              bsa_fasta,
    #                                              f2sf=False)[0]
    # B100_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B100_fDR,
    #                                               bsa_fasta,
    #                                               f2sf=False)[0]
    B0_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B0_fDR,
                                                bsa_fasta,
                                                f2sf=True)[0]
    B1_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B1_fDR,
                                                bsa_fasta,
                                                f2sf=True)[0]
    B5_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B5_fDR,
                                                bsa_fasta,
                                                f2sf=True)[0]
    B25_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B25_fDR,
                                                 bsa_fasta,
                                                 f2sf=True)[0]
    B100_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B100_fDR,
                                                  bsa_fasta,
                                                  f2sf=True)[0]
    B0_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B0_fDR,
                                             bsa_fasta)[0]
    B1_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B1_fDR,
                                             bsa_fasta)[0]
    B5_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B5_fDR,
                                             bsa_fasta)[0]
    B25_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B25_fDR,
                                              bsa_fasta)[0]
    B100_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B100_fDR,
                                               bsa_fasta)[0]
    ## repeat part

    # B0_repeat = cal_multi_list([B0_0908_s, B0_0908_p])
    # B1_repeat = cal_multi_list([B1_0908_s, B1_0908_p])
    # B5_repeat = cal_multi_list([B5_0908_s, B5_0908_p])
    # B25_repeat = cal_multi_list([B25_0908_s, B25_0908_p])
    # B100_repeat = cal_multi_list([B100_0908_s, B100_0908_p])
    B0_repeat = cal_multi_list([B0_0908_s, B0_0908_s])
    B1_repeat = cal_multi_list([B1_0908_s, B1_0908_s])
    B5_repeat = cal_multi_list([B5_0908_s, B5_0908_s])
    B25_repeat = cal_multi_list([B25_0908_s, B25_0908_s])
    B100_repeat = cal_multi_list([B100_0908_s, B100_0908_s])

    # B0_repeat = cal_multi_list([B0_0908_p, B0_0908_p])
    # B1_repeat = cal_multi_list([B1_0908_p, B1_0908_p])
    # B5_repeat = cal_multi_list([B5_0908_p, B5_0908_p])
    # B25_repeat = cal_multi_list([B25_0908_p, B25_0908_p])
    # B100_repeat = cal_multi_list([B100_0908_p, B100_0908_p])

    B_repeat_list = [B0_repeat, B1_repeat, B5_repeat, B25_repeat, B100_repeat]
    # B0_0908_s_list = [B0_0908_s, B1_0908_s, B5_0908_s, B25_0908_s, B100_0908_s]

    for i in B_repeat_list:
        k = [
            j for j in i
            if bsa_fasta[int(j[0]) - 1] == "K" or bsa_fasta[int(j[1]) -
                                                            1] == "K"
        ]
        cal_distance_pos_list(k,
                              fasta=bsa_fasta,
                              pdb_file='G:/MSdata/pdb/bsa.pdb',
                              print_all=False,
                              threshold=600)
        report_animo_ratio(k,
                           pos_form=True,
                           fasta_file=bsa_fasta,
                           tableform=True,
                           ratio_output=True,
                           threshold=600)
        
    # BQ
       # plink2crosslink(
    #     "G:/MSdata/221018MixBQM/BQ/reports/MixBQM_2022.10.18.filtered_cross-linked_spectra.csv",
    #     "G:/MSdata/221018MixBQM/BQ/reports/crosslink_spotlinkform/")
    print("*" * 40)
    print("--BQ--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/221018MixBQM/BQ/spotlink/"
    plink_root_dir = "G:/MSdata/221018MixBQM/BQ/reports/crosslink_spotlinkform/"
    ### fasta
    bq_fasta = "MKLILCTVLSLGIAAVCFAAPPKSVIRWCTISSPEEKKCNNLRDLTQQERISLTCVQKATYLDCIKAIANNEADAISLDGGQAFEAGLAPYKLKPIAAEVYEHTEGSTTSYYAVAVVKKGTEFTVNDLQGKTSCHTGLGRSAGWNIPIGTLLHRGAIEWEGIESGSVEQAVAKFFSASCVPGATIEQKLCRQCKGDPKTKCARNAPYSGYSGAFHCLKDGKGDVAFVKHTTVNENAPDQKDEYELLCLDGSRQPVDNYKTCNWARVAAHAVVARDDNKVEDIWSFLSKAQSDFGVDTKSDFHLFGPPGKKDPVLKDLLFKDSAIMLKRVPSLMDSQLYLGFEYYSAIQSMRKDQLTPSPRENRIQWCAVGKDEKSKCDRWSVVSNGDVECTVVDETKDCIIKIMKGEADAVALDGGLVYTAGVCGLVPVMAERYDDESQCSKTDERPASYFAVAVARKDSNVNWNNLKGKKSCHTAVGRTAGWVIPMGLIHNRTGTCNFDEYFSEGCAPGSPPNSRLCQLCQGSGGIPPEKCVASSHEKYFGYTGALRCLVEKGDVAFIQHSTVEENTGGKNKADWAKNLQMDDFELLCTDGRRANVMDYRECNLAEVPTHAVVVRPEKANKIRDLLERQEKRFGVNGSEKSKFMMFESQNKDLLFKDLTKCLFKVREGTTYKEFLGDKFYTVISSLKTCNPSDILQMCSFLEGK"
    ### file_dir
    spotlink_file_0908_BQ0_fDR = spotlink_root_dir + 'JYD_20220908_BQ0_HCDFT_result_filtered.csv'
    spotlink_file_0908_BQ1_fDR = spotlink_root_dir + 'JYD_20220908_BQ1_HCDFT_result_filtered.csv'
    spotlink_file_0908_BQ5_fDR = spotlink_root_dir + 'JYD_20220908_BQ5_HCDFT_result_filtered.csv'
    spotlink_file_0908_BQ25_fDR = spotlink_root_dir + 'JYD_20220908_BQ25_HCDFT_result_filtered.csv'
    spotlink_file_0908_BQ100_fDR = spotlink_root_dir + 'JYD_20220908_BQ100_HCDFT_result_filtered.csv'
    plink_file_0908_BQ0_fDR = plink_root_dir + "JYD_20220908_BQ0.csv"
    plink_file_0908_BQ5_fDR = plink_root_dir + "JYD_20220908_BQ5.csv"
    plink_file_0908_BQ25_fDR = plink_root_dir + "JYD_20220908_BQ25.csv"
    plink_file_0908_BQ100_fDR = plink_root_dir + "JYD_20220908_BQ100.csv"
    plink_file_0908_BQ1_fDR = plink_root_dir + "JYD_20220908_BQ1.csv"
    # BQ0_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ0_fDR,
    #                                              bq_fasta,
    #                                              f2sf=False)[0]
    # BQ1_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ1_fDR,
    #                                              bq_fasta,
    #                                              f2sf=False)[0]
    # BQ5_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ5_fDR,
    #                                              bq_fasta,
    #                                              f2sf=False)[0]
    # BQ25_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ25_fDR,
    #                                               bq_fasta,
    #                                               f2sf=False)[0]
    # BQ100_0908_s = spotlink_report_valid_link_sfDR(
    #     spotlink_file_0908_BQ100_fDR, bq_fasta, f2sf=False)[0]
    # BQ0_0908_sf = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ0_fDR,
    #                                               bq_fasta,
    #                                               f2sf=True)[0]
    # BQ1_0908_sf = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ1_fDR,
    #                                               bq_fasta,
    #                                               f2sf=True)[0]
    # BQ5_0908_sf = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ5_fDR,
    #                                               bq_fasta,
    #                                               f2sf=True)[0]
    # BQ25_0908_sf = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ25_fDR,
    #                                                bq_fasta,
    #                                                f2sf=True)[0]
    # BQ100_0908_sf = spotlink_report_valid_link_sfDR(
    #     spotlink_file_0908_BQ100_fDR, bq_fasta, f2sf=True)[0]
    BQ0_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ0_fDR,
                                              bq_fasta)[0]
    BQ1_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ1_fDR,
                                              bq_fasta)[0]
    BQ5_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ5_fDR,
                                              bq_fasta)[0]
    BQ25_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ25_fDR,
                                               bq_fasta)[0]
    BQ100_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ100_fDR,
                                                bq_fasta)[0]

    # BQ0_repeat = cal_multi_list([BQ0_0908_s, BQ0_0908_p])
    # BQ1_repeat = cal_multi_list([BQ1_0908_s, BQ1_0908_p])
    # BQ5_repeat = cal_multi_list([BQ5_0908_s, BQ5_0908_p])
    # BQ25_repeat = cal_multi_list([BQ25_0908_s, BQ25_0908_p])
    # BQ100_repeat = cal_multi_list([BQ100_0908_s, BQ100_0908_p])
    # BQ0_repeat = cal_multi_list([BQ0_0908_s, BQ0_0908_s])
    # BQ1_repeat = cal_multi_list([BQ1_0908_s, BQ1_0908_s])
    # BQ5_repeat = cal_multi_list([BQ5_0908_s, BQ5_0908_s])
    # BQ25_repeat = cal_multi_list([BQ25_0908_s, BQ25_0908_s])
    # BQ100_repeat = cal_multi_list([BQ100_0908_s, BQ100_0908_s])
    BQ0_repeat = cal_multi_list([BQ0_0908_p, BQ0_0908_p])
    BQ1_repeat = cal_multi_list([BQ1_0908_p, BQ1_0908_p])
    BQ5_repeat = cal_multi_list([BQ5_0908_p, BQ5_0908_p])
    BQ25_repeat = cal_multi_list([BQ25_0908_p, BQ25_0908_p])
    BQ100_repeat = cal_multi_list([BQ100_0908_p, BQ100_0908_p])

    BQ_repeat_list = [
        BQ0_repeat, BQ1_repeat, BQ5_repeat, BQ25_repeat, BQ100_repeat
    ]

    for i in BQ_repeat_list:
        if len(i) > 1:
            k = [
                j for j in i
                if bq_fasta[int(j[0]) - 1] == "K" or bq_fasta[int(j[1]) -
                                                              1] == "K"
            ]
        else:
            k = i

        cal_distance_pos_list(k,
                              fasta=bq_fasta,
                              pdb_file='G:/MSdata/pdb/conalbumin.pdb',
                              threshold=0.75,
                              print_all=False)
        report_animo_ratio(k,
                           pos_form=True,
                           fasta_file=bq_fasta,
                           tableform=True,
                           ratio_output=True,
                           threshold=0.75)
        
# 221031
   # # plink2crosslink(
    # #     "G:/MSdata/221020BQM/M/reports/Lactoferrin_con_2022.10.20.filtered_cross-linked_spectra.csv",
    # #     "G:/MSdata/221020BQM/M/reports/crosslink_spotlinkform/")
    # print("*" * 40)
    # print("--Lactoferrin--" * 5)
    # print("*" * 40)
    # ## define part
    # spotlink_root_dir = "G:/MSdata/220929HSAEGGMILK/spotlink/"
    # plink_root_dir = "G:/MSdata/221020BQM/M/reports/crosslink_spotlinkform/"
    # ### fasta
    # lactoferrin_fasta = "CTISQPEWFKCRRWQWRMKKLGAPSITCVRRAFALECIRAIAEKKADAVTLDGGMVFEACRDPYKLRPVAAEIYGTKESPQTHYYAVAVVKKGSNFQLDQLQGRKSCHTGLGRSAGWIIPMGILRPYLSWTESLEPLQGAVAKFFSASCVPCIDRQAYPNLCQLCKGEGENQCACSSREPYFGYSGAFKCLQDGAGDVAFVKETTVFENLPEKADRDQYELLCLNNSRAPVDAFKECHLAQVPSHAVVARSVDGKEDLIWKLLSKAQEKFGKNKSRSFQLFGSPPGQRDLLFKDSALGFLRIPSKVDSALYLGSRYLTTLKNLRETAEEVKARYTRVVWCAVGPEEQKKCQQWSQQSGQNVTCATASTTDDCIVLVLKGEADALNLDGGYIYTAGKCGLVPVLAENRKSSKHSSLDCVLRPTEGYLAVAVVKKANEGLTWNSLKDKKSCHTAVDRTAGWNIPMGLIVNQTGSCAFDEFFSQSCAPGADPKSRLCALCAGDDQGLDKCVPNSKEKYYGYTGAFRCLAEDVGDVAFVKNDTVWENTNGESTADWAKNLNREDFRLLCLDGTRKPVTEAQSCHLAVAPNHAVVSRSDRAAHVKQVLLHQQALFGKNGKNCPDKFCLFKSETKNLLFNDNTECLAKLGGRPTYEEYLGTEYVTAIANLKKCSTSPLLEACAFLTR"
    # ### file_dir
    # spotlink_file_0923_M0_fDR = spotlink_root_dir + 'JYD_20220923_M0_HCDFT_result_filtered.csv'
    # spotlink_file_0923_M1_fDR = spotlink_root_dir + 'JYD_20220923_M1_HCDFT_result_filtered.csv'
    # spotlink_file_0923_M5_fDR = spotlink_root_dir + 'JYD_20220923_M5_HCDFT_result_filtered.csv'
    # spotlink_file_0923_M25_fDR = spotlink_root_dir + 'JYD_20220923_M25_HCDFT_result_filtered.csv'
    # spotlink_file_0923_M100_fDR = spotlink_root_dir + 'JYD_20220923_M100_HCDFT_result_filtered.csv'
    # plink_file_0923_M0_fDR = plink_root_dir + "JYD_20220923_M0.csv"
    # plink_file_0923_M5_fDR = plink_root_dir + "JYD_20220923_M5.csv"
    # plink_file_0923_M25_fDR = plink_root_dir + "JYD_20220923_M25.csv"
    # plink_file_0923_M100_fDR = plink_root_dir + "JYD_20220923_M100.csv"
    # plink_file_0923_M1_fDR = plink_root_dir + "JYD_20220923_M1.csv"
    # # M0_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M0_fDR,
    # #                                             lactoferrin_fasta,
    # #                                             f2sf=False)[0]
    # # M1_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M1_fDR,
    # #                                             lactoferrin_fasta,
    # #                                             f2sf=False)[0]
    # # M5_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M5_fDR,
    # #                                             lactoferrin_fasta,
    # #                                             f2sf=False)[0]
    # # M25_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M25_fDR,
    # #                                              lactoferrin_fasta,
    # #                                              f2sf=False)[0]
    # # M100_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_M100_fDR,
    # #                                               lactoferrin_fasta,
    # #                                               f2sf=False)[0]
    # # M0_0923_sf = spotlink_report_valid_link_sfDR(spotlink_file_0923_M0_fDR,
    # #                                              lactoferrin_fasta,
    # #                                              f2sf=True)[0]
    # # M1_0923_sf = spotlink_report_valid_link_sfDR(spotlink_file_0923_M1_fDR,
    # #                                              lactoferrin_fasta,
    # #                                              f2sf=True)[0]
    # # M5_0923_sf = spotlink_report_valid_link_sfDR(spotlink_file_0923_M5_fDR,
    # #                                              lactoferrin_fasta,
    # #                                              f2sf=True)[0]
    # # M25_0923_sf = spotlink_report_valid_link_sfDR(spotlink_file_0923_M25_fDR,
    # #                                               lactoferrin_fasta,
    # #                                               f2sf=True)[0]
    # # M100_0923_sf = spotlink_report_valid_link_sfDR(spotlink_file_0923_M100_fDR,
    # #                                                lactoferrin_fasta,
    # #                                                f2sf=True)[0]
    # M0_0923_p = plink_report_valid_link_sfDR(plink_file_0923_M0_fDR,
    #                                          lactoferrin_fasta)[0]
    # M1_0923_p = plink_report_valid_link_sfDR(plink_file_0923_M1_fDR,
    #                                          lactoferrin_fasta)[0]
    # M5_0923_p = plink_report_valid_link_sfDR(plink_file_0923_M5_fDR,
    #                                          lactoferrin_fasta)[0]
    # M25_0923_p = plink_report_valid_link_sfDR(plink_file_0923_M25_fDR,
    #                                           lactoferrin_fasta)[0]
    # M100_0923_p = plink_report_valid_link_sfDR(plink_file_0923_M100_fDR,
    #                                            lactoferrin_fasta)[0]

    # # M0_repeat = cal_multi_list([M0_0923_s, M0_0923_p])
    # # M1_repeat = cal_multi_list([M1_0923_s, M1_0923_p])
    # # M5_repeat = cal_multi_list([M5_0923_s, M5_0923_p])
    # # M25_repeat = cal_multi_list([M25_0923_s, M25_0923_p])
    # # M100_repeat = cal_multi_list([M100_0923_s, M100_0923_p])
    # # M0_repeat = cal_multi_list([M0_0923_s, M0_0923_s])
    # # M1_repeat = cal_multi_list([M1_0923_s, M1_0923_s])
    # # M5_repeat = cal_multi_list([M5_0923_s, M5_0923_s])
    # # M25_repeat = cal_multi_list([M25_0923_s, M25_0923_s])
    # # M100_repeat = cal_multi_list([M100_0923_s, M100_0923_s])
    # M0_repeat = cal_multi_list([M0_0923_p, M0_0923_p])
    # M1_repeat = cal_multi_list([M1_0923_p, M1_0923_p])
    # M5_repeat = cal_multi_list([M5_0923_p, M5_0923_p])
    # M25_repeat = cal_multi_list([M25_0923_p, M25_0923_p])
    # M100_repeat = cal_multi_list([M100_0923_p, M100_0923_p])

    # M_repeat_list = [M0_repeat, M1_repeat, M5_repeat, M25_repeat, M100_repeat]

    # for i in M_repeat_list:
    #     k = [
    #         j for j in i
    #         if lactoferrin_fasta[int(j[0]) -
    #                              1] == "K" or lactoferrin_fasta[int(j[1]) -
    #                                                             1] == "K"
    #     ]
    #     cal_distance_pos_list(k,
    #                           fasta=lactoferrin_fasta,
    #                           pdb_file='G:/MSdata/pdb/lactoferrin.pdb',
    #                           threshold=600,
    #                           print_all=False)
    #     report_animo_ratio(k,
    #                        pos_form=True,
    #                        fasta_file=lactoferrin_fasta,
    #                        tableform=True,
    #                        ratio_output=False,
    #                        threshold=600)

    # # plink2crosslink(
    # #     "G:/MSdata/221020BQM/BSA/reports/bsa_con_2022.10.20.filtered_cross-linked_spectra.csv",
    # #     "G:/MSdata/221020BQM/BSA/reports/crosslink_spotlinkform/")
    # print("*" * 40)
    # print("--BSA--" * 5)
    # print("*" * 40)
    # ## define part
    # spotlink_root_dir = "G:/MSdata/221020BQM/BSA/spotlink/"
    # plink_root_dir = "G:/MSdata/221020BQM/BSA/reports/crosslink_spotlinkform/"
    # ### fasta
    # bsa_fasta = "MKWVTFISLLLLFSSAYSRGVFRRDTHKSEIAHRFKDLGEEHFKGLVLIAFSQYLQQCPFDEHVKLVNELTEFAKTCVADESHAGCEKSLHTLFGDELCKVASLRETYGDMADCCEKQEPERNECFLSHKDDSPDLPKLKPDPNTLCDEFKADEKKFWGKYLYEIARRHPYFYAPELLYYANKYNGVFQECCQAEDKGACLLPKIETMREKVLTSSARQRLRCASIQKFGERALKAWSVARLSQKFPKAEFVEVTKLVTDLTKVHKECCHGDLLECADDRADLAKYICDNQDTISSKLKECCDKPLLEKSHCIAEVEKDAIPENLPPLTADFAEDKDVCKNYQEAKDAFLGSFLYEYSRRHPEYAVSVLLRLAKEYEATLEECCAKDDPHACYSTVFDKLKHLVDEPQNLIKQNCDQFEKLGEYGFQNALIVRYTRKVPQVSTPTLVEVSRSLGKVGTRCCTKPESERMPCTEDYLSLILNRLCVLHEKTPVSEKVTKCCTESLVNRRPCFSALTPDETYVPKAFDEKLFTFHADICTLPDTEKQIKKQTALVELLKHKPKATEEQLKTVMENFVAFVDKCCAADDKEACFAVEGPKLVVSTQTALA"
    # ### file_dir
    # spotlink_file_0908_B0_fDR = spotlink_root_dir + 'JYD_20220908_B0_HCDFT_result_filtered.csv'
    # spotlink_file_0908_B1_fDR = spotlink_root_dir + 'JYD_20220908_B1_HCDFT_result_filtered.csv'
    # spotlink_file_0908_B5_fDR = spotlink_root_dir + 'JYD_20220908_B5_HCDFT_result_filtered.csv'
    # spotlink_file_0908_B25_fDR = spotlink_root_dir + 'JYD_20220908_B25_HCDFT_result_filtered.csv'
    # spotlink_file_0908_B100_fDR = spotlink_root_dir + 'JYD_20220908_B100_HCDFT_result_filtered.csv'
    # plink_file_0908_B0_fDR = plink_root_dir + "JYD_20220908_B0.csv"
    # plink_file_0908_B5_fDR = plink_root_dir + "JYD_20220908_B5.csv"
    # plink_file_0908_B25_fDR = plink_root_dir + "JYD_20220908_B25.csv"
    # plink_file_0908_B100_fDR = plink_root_dir + "JYD_20220908_B100.csv"
    # plink_file_0908_B1_fDR = plink_root_dir + "JYD_20220908_B1.csv"
    # # B0_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B0_fDR,
    # #                                             bsa_fasta,
    # #                                             f2sf=False)[0]
    # # B1_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B1_fDR,
    # #                                             bsa_fasta,
    # #                                             f2sf=False)[0]
    # # B5_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B5_fDR,
    # #                                             bsa_fasta,
    # #                                             f2sf=False)[0]
    # # B25_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B25_fDR,
    # #                                              bsa_fasta,
    # #                                              f2sf=False)[0]
    # # B100_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B100_fDR,
    # #                                               bsa_fasta,
    # #                                               f2sf=False)[0]
    # # B0_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B0_fDR,
    # #                                             bsa_fasta,
    # #                                             f2sf=True)[0]
    # # B1_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B1_fDR,
    # #                                             bsa_fasta,
    # #                                             f2sf=True)[0]
    # # B5_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B5_fDR,
    # #                                             bsa_fasta,
    # #                                             f2sf=True)[0]
    # # B25_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B25_fDR,
    # #                                              bsa_fasta,
    # #                                              f2sf=True)[0]
    # # B100_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_B100_fDR,
    # #                                               bsa_fasta,
    # #                                               f2sf=True)[0]
    # B0_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B0_fDR,
    #                                          bsa_fasta)[0]
    # B1_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B1_fDR,
    #                                          bsa_fasta)[0]
    # B5_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B5_fDR,
    #                                          bsa_fasta)[0]
    # B25_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B25_fDR,
    #                                           bsa_fasta)[0]
    # B100_0908_p = plink_report_valid_link_sfDR(plink_file_0908_B100_fDR,
    #                                            bsa_fasta)[0]
    # ## repeat part

    # # B0_repeat = cal_multi_list([B0_0908_s, B0_0908_p])
    # # B1_repeat = cal_multi_list([B1_0908_s, B1_0908_p])
    # # B5_repeat = cal_multi_list([B5_0908_s, B5_0908_p])
    # # B25_repeat = cal_multi_list([B25_0908_s, B25_0908_p])
    # # B100_repeat = cal_multi_list([B100_0908_s, B100_0908_p])
    # # B0_repeat = cal_multi_list([B0_0908_s, B0_0908_s])
    # # B1_repeat = cal_multi_list([B1_0908_s, B1_0908_s])
    # # B5_repeat = cal_multi_list([B5_0908_s, B5_0908_s])
    # # B25_repeat = cal_multi_list([B25_0908_s, B25_0908_s])
    # # B100_repeat = cal_multi_list([B100_0908_s, B100_0908_s])

    # B0_repeat = cal_multi_list([B0_0908_p, B0_0908_p])
    # B1_repeat = cal_multi_list([B1_0908_p, B1_0908_p])
    # B5_repeat = cal_multi_list([B5_0908_p, B5_0908_p])
    # B25_repeat = cal_multi_list([B25_0908_p, B25_0908_p])
    # B100_repeat = cal_multi_list([B100_0908_p, B100_0908_p])

    # B_repeat_list = [B0_repeat, B1_repeat, B5_repeat, B25_repeat, B100_repeat]
    # # B0_0908_s_list = [B0_0908_s, B1_0908_s, B5_0908_s, B25_0908_s, B100_0908_s]

    # for i in B_repeat_list:
    #     k = [
    #         j for j in i
    #         if bsa_fasta[int(j[0]) - 1] == "K" or bsa_fasta[int(j[1]) -
    #                                                         1] == "K"
    #     ]
    #     cal_distance_pos_list(k,
    #                           fasta=bsa_fasta,
    #                           pdb_file='G:/MSdata/pdb/bsa.pdb',
    #                           print_all=False,
    #                           threshold=600)
    #     report_animo_ratio(k,
    #                        pos_form=True,
    #                        fasta_file=bsa_fasta,
    #                        tableform=True,
    #                        ratio_output=False,
    #                        threshold=600)

    # # BQ
    # # plink2crosslink(
    # #     "G:/MSdata/221020BQM/BQ/reports/conalbumin_con_2022.10.20.filtered_cross-linked_spectra.csv",
    # #     "G:/MSdata/221020BQM/BQ/reports/crosslink_spotlinkform/")
    # print("*" * 40)
    # print("--BQ--" * 5)
    # print("*" * 40)
    # ## define part
    # spotlink_root_dir = "G:/MSdata/221020BQM/BQ/spotlink/"
    # plink_root_dir = "G:/MSdata/221020BQM/BQ/reports/crosslink_spotlinkform/"
    # ### fasta
    # bq_fasta = "MKLILCTVLSLGIAAVCFAAPPKSVIRWCTISSPEEKKCNNLRDLTQQERISLTCVQKATYLDCIKAIANNEADAISLDGGQAFEAGLAPYKLKPIAAEVYEHTEGSTTSYYAVAVVKKGTEFTVNDLQGKTSCHTGLGRSAGWNIPIGTLLHRGAIEWEGIESGSVEQAVAKFFSASCVPGATIEQKLCRQCKGDPKTKCARNAPYSGYSGAFHCLKDGKGDVAFVKHTTVNENAPDQKDEYELLCLDGSRQPVDNYKTCNWARVAAHAVVARDDNKVEDIWSFLSKAQSDFGVDTKSDFHLFGPPGKKDPVLKDLLFKDSAIMLKRVPSLMDSQLYLGFEYYSAIQSMRKDQLTPSPRENRIQWCAVGKDEKSKCDRWSVVSNGDVECTVVDETKDCIIKIMKGEADAVALDGGLVYTAGVCGLVPVMAERYDDESQCSKTDERPASYFAVAVARKDSNVNWNNLKGKKSCHTAVGRTAGWVIPMGLIHNRTGTCNFDEYFSEGCAPGSPPNSRLCQLCQGSGGIPPEKCVASSHEKYFGYTGALRCLVEKGDVAFIQHSTVEENTGGKNKADWAKNLQMDDFELLCTDGRRANVMDYRECNLAEVPTHAVVVRPEKANKIRDLLERQEKRFGVNGSEKSKFMMFESQNKDLLFKDLTKCLFKVREGTTYKEFLGDKFYTVISSLKTCNPSDILQMCSFLEGK"
    # ### file_dir
    # spotlink_file_0908_BQ0_fDR = spotlink_root_dir + 'JYD_20220908_BQ0_HCDFT_result_filtered.csv'
    # spotlink_file_0908_BQ1_fDR = spotlink_root_dir + 'JYD_20220908_BQ1_HCDFT_result_filtered.csv'
    # spotlink_file_0908_BQ5_fDR = spotlink_root_dir + 'JYD_20220908_BQ5_HCDFT_result_filtered.csv'
    # spotlink_file_0908_BQ25_fDR = spotlink_root_dir + 'JYD_20220908_BQ25_HCDFT_result_filtered.csv'
    # spotlink_file_0908_BQ100_fDR = spotlink_root_dir + 'JYD_20220908_BQ100_HCDFT_result_filtered.csv'
    # plink_file_0908_BQ0_fDR = plink_root_dir + "JYD_20220908_BQ0.csv"
    # plink_file_0908_BQ5_fDR = plink_root_dir + "JYD_20220908_BQ5.csv"
    # plink_file_0908_BQ25_fDR = plink_root_dir + "JYD_20220908_BQ25.csv"
    # plink_file_0908_BQ100_fDR = plink_root_dir + "JYD_20220908_BQ100.csv"
    # plink_file_0908_BQ1_fDR = plink_root_dir + "JYD_20220908_BQ1.csv"
    # # BQ0_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ0_fDR,
    # #                                              bq_fasta,
    # #                                              f2sf=False)[0]
    # # BQ1_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ1_fDR,
    # #                                              bq_fasta,
    # #                                              f2sf=False)[0]
    # # BQ5_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ5_fDR,
    # #                                              bq_fasta,
    # #                                              f2sf=False)[0]
    # # BQ25_0908_s = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ25_fDR,
    # #                                               bq_fasta,
    # #                                               f2sf=False)[0]
    # # BQ100_0908_s = spotlink_report_valid_link_sfDR(
    # #     spotlink_file_0908_BQ100_fDR, bq_fasta, f2sf=False)[0]
    # # BQ0_0908_sf = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ0_fDR,
    # #                                               bq_fasta,
    # #                                               f2sf=True)[0]
    # # BQ1_0908_sf = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ1_fDR,
    # #                                               bq_fasta,
    # #                                               f2sf=True)[0]
    # # BQ5_0908_sf = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ5_fDR,
    # #                                               bq_fasta,
    # #                                               f2sf=True)[0]
    # # BQ25_0908_sf = spotlink_report_valid_link_sfDR(spotlink_file_0908_BQ25_fDR,
    # #                                                bq_fasta,
    # #                                                f2sf=True)[0]
    # # BQ100_0908_sf = spotlink_report_valid_link_sfDR(
    # #     spotlink_file_0908_BQ100_fDR, bq_fasta, f2sf=True)[0]
    # BQ0_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ0_fDR,
    #                                           bq_fasta)[0]
    # BQ1_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ1_fDR,
    #                                           bq_fasta)[0]
    # BQ5_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ5_fDR,
    #                                           bq_fasta)[0]
    # BQ25_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ25_fDR,
    #                                            bq_fasta)[0]
    # BQ100_0908_p = plink_report_valid_link_sfDR(plink_file_0908_BQ100_fDR,
    #                                             bq_fasta)[0]

    # # BQ0_repeat = cal_multi_list([BQ0_0908_s, BQ0_0908_p])
    # # BQ1_repeat = cal_multi_list([BQ1_0908_s, BQ1_0908_p])
    # # BQ5_repeat = cal_multi_list([BQ5_0908_s, BQ5_0908_p])
    # # BQ25_repeat = cal_multi_list([BQ25_0908_s, BQ25_0908_p])
    # # BQ100_repeat = cal_multi_list([BQ100_0908_s, BQ100_0908_p])
    # # BQ0_repeat = cal_multi_list([BQ0_0908_s, BQ0_0908_s])
    # # BQ1_repeat = cal_multi_list([BQ1_0908_s, BQ1_0908_s])
    # # BQ5_repeat = cal_multi_list([BQ5_0908_s, BQ5_0908_s])
    # # BQ25_repeat = cal_multi_list([BQ25_0908_s, BQ25_0908_s])
    # # BQ100_repeat = cal_multi_list([BQ100_0908_s, BQ100_0908_s])
    # BQ0_repeat = cal_multi_list([BQ0_0908_p, BQ0_0908_p])
    # BQ1_repeat = cal_multi_list([BQ1_0908_p, BQ1_0908_p])
    # BQ5_repeat = cal_multi_list([BQ5_0908_p, BQ5_0908_p])
    # BQ25_repeat = cal_multi_list([BQ25_0908_p, BQ25_0908_p])
    # BQ100_repeat = cal_multi_list([BQ100_0908_p, BQ100_0908_p])

    # BQ_repeat_list = [
    #     BQ0_repeat, BQ1_repeat, BQ5_repeat, BQ25_repeat, BQ100_repeat
    # ]

    # for i in BQ_repeat_list:
    #     if len(i) > 1:
    #         k = [
    #             j for j in i
    #             if bq_fasta[int(j[0]) - 1] == "K" or bq_fasta[int(j[1]) -
    #                                                           1] == "K"
    #         ]
    #     else:
    #         k = []

    #     cal_distance_pos_list(k,
    #                           fasta=bq_fasta,
    #                           pdb_file='G:/MSdata/pdb/conalbumin.pdb',
    #                           threshold=600,
    #                           print_all=False)
    #     report_animo_ratio(k,
    #                        pos_form=True,
    #                        fasta_file=bq_fasta,
    #                        tableform=True,
    #                        ratio_output=False,
    #                        threshold=600)

    # HSA
    # plink2crosslink(
    #     "G:/MSdata/221020BQM/HSA/reports/HSA_con_2022.10.21.filtered_cross-linked_spectra.csv",
    #     "G:/MSdata/221020BQM/HSA/reports/crosslink_spotlinkform/")

    print("*" * 40)
    print("--HSA--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/220929HSAEGGMILK/spotlink/"
    plink_root_dir = "G:/MSdata/221020BQM/HSA/reports/crosslink_spotlinkform/"
    ### fasta
    hsa_fasta = "MKWVTFISLLFLFSSAYSRGVFRRDAHKSEVAHRFKDLGEENFKALVLIAFAQYLQQCPFEDHVKLVNEVTEFAKTCVADESAENCDKSLHTLFGDKLCTVATLRETYGEMADCCAKQEPERNECFLQHKDDNPNLPRLVRPEVDVMCTAFHDNEETFLKKYLYEIARRHPYFYAPELLFFAKRYKAAFTECCQAADKAACLLPKLDELRDEGKASSAKQRLKCASLQKFGERAFKAWAVARLSQRFPKAEFAEVSKLVTDLTKVHTECCHGDLLECADDRADLAKYICENQDSISSKLKECCEKPLLEKSHCIAEVENDEMPADLPSLAADFVESKDVCKNYAEAKDVFLGMFLYEYARRHPDYSVVLLLRLAKTYETTLEKCCAAADPHECYAKVFDEFKPLVEEPQNLIKQNCELFEQLGEYKFQNALLVRYTKKVPQVSTPTLVEVSRNLGKVGSKCCKHPEAKRMPCAEDYLSVVLNQLCVLHEKTPVSDRVTKCCTESLVNRRPCFSALEVDETYVPKEFNAETFTFHADICTLSEKERQIKKQTALVELVKHKPKATKEQLKAVMDDFAAFVEKCCKADDKETCFAEEGKKLVAASQAALGL"
    ### file_dir
    spotlink_file_0923_H0_fDR = spotlink_root_dir + 'JYD_20220923_H0_HCDFT_result_filtered.csv'
    spotlink_file_0923_H1_fDR = spotlink_root_dir + 'JYD_20220923_H1_HCDFT_result_filtered.csv'
    spotlink_file_0923_H5_fDR = spotlink_root_dir + 'JYD_20220923_H5_HCDFT_result_filtered.csv'
    spotlink_file_0923_H25_fDR = spotlink_root_dir + 'JYD_20220923_H25_HCDFT_result_filtered.csv'
    spotlink_file_0923_H100_fDR = spotlink_root_dir + 'JYD_20220923_H100_HCDFT_result_filtered.csv'
    plink_file_0923_H0_fDR = plink_root_dir + "JYD_20220923_H0.csv"
    plink_file_0923_H5_fDR = plink_root_dir + "JYD_20220923_H5.csv"
    plink_file_0923_H25_fDR = plink_root_dir + "JYD_20220923_H25.csv"
    plink_file_0923_H100_fDR = plink_root_dir + "JYD_20220923_H100.csv"
    plink_file_0923_H1_fDR = plink_root_dir + "JYD_20220923_H1.csv"
    # H0_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H0_fDR,
    #                                             fasta,
    #                                             f2sf=False)[0]
    # H1_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H1_fDR,
    #                                             fasta,
    #                                             f2sf=False)[0]
    # H5_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H5_fDR,
    #                                             fasta,
    #                                             f2sf=False)[0]
    # H25_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H25_fDR,
    #                                              fasta,
    #                                              f2sf=False)[0]
    # H100_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H100_fDR,
    #                                               fasta,
    #                                               f2sf=False)[0]
    # H0_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H0_fDR,
    #                                             fasta,
    #                                             f2sf=True)[0]
    # H1_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H1_fDR,
    #                                             fasta,
    #                                             f2sf=True)[0]
    # H5_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H5_fDR,
    #                                             fasta,
    #                                             f2sf=True)[0]
    # H25_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H25_fDR,
    #                                              fasta,
    #                                              f2sf=True)[0]
    # H100_0923_s = spotlink_report_valid_link_sfDR(spotlink_file_0923_H100_fDR,
    #                                               fasta,
    #                                               f2sf=True)[0]
    H0_0923_p = plink_report_valid_link_sfDR(plink_file_0923_H0_fDR,
                                             hsa_fasta)[0]
    H1_0923_p = plink_report_valid_link_sfDR(plink_file_0923_H1_fDR,
                                             hsa_fasta)[0]
    H5_0923_p = plink_report_valid_link_sfDR(plink_file_0923_H5_fDR,
                                             hsa_fasta)[0]
    H25_0923_p = plink_report_valid_link_sfDR(plink_file_0923_H25_fDR,
                                              hsa_fasta)[0]
    H100_0923_p = plink_report_valid_link_sfDR(plink_file_0923_H100_fDR,
                                               hsa_fasta)[0]
    ## repeat part

    # H0_repeat = cal_multi_list([H0_0923_s, H0_0923_p])
    # H1_repeat = cal_multi_list([H1_0923_s, H1_0923_p])
    # H5_repeat = cal_multi_list([H5_0923_s, H5_0923_p])
    # H25_repeat = cal_multi_list([H25_0923_s, H25_0923_p])
    # H100_repeat = cal_multi_list([H100_0923_s, H100_0923_p])
    # H0_repeat = cal_multi_list([H0_0923_s, H0_0923_s])
    # H1_repeat = cal_multi_list([H1_0923_s, H1_0923_s])
    # H5_repeat = cal_multi_list([H5_0923_s, H5_0923_s])
    # H25_repeat = cal_multi_list([H25_0923_s, H25_0923_s])
    # H100_repeat = cal_multi_list([H100_0923_s, H100_0923_s])

    H0_repeat = cal_multi_list([H0_0923_p, H0_0923_p])
    H1_repeat = cal_multi_list([H1_0923_p, H1_0923_p])
    H5_repeat = cal_multi_list([H5_0923_p, H5_0923_p])
    H25_repeat = cal_multi_list([H25_0923_p, H25_0923_p])
    H100_repeat = cal_multi_list([H100_0923_p, H100_0923_p])

    H_repeat_list = [H0_repeat, H1_repeat, H5_repeat, H25_repeat, H100_repeat]
    # H0_0923_s_list = [H0_0923_s, H1_0923_s, H5_0923_s, H25_0923_s, H100_0923_s]

    for i in H_repeat_list:
        k = [
            j for j in i
            if hsa_fasta[int(j[0]) - 1] == "K" or hsa_fasta[int(j[1]) -
                                                            1] == "K"
        ]
        cal_distance_pos_list(k,
                              fasta=hsa_fasta,
                              pdb_file='G:/MSdata/pdb/HSA.pdb',
                              print_all=False,
                              threshold=900)
        report_animo_ratio(k,
                           pos_form=True,
                           fasta_file=hsa_fasta,
                           tableform=True,
                           ratio_output=False,
                           threshold=900)
        
# 221031
  # plink2crosslink(
    #     "G:/MSdata/221027ETF/ALB/reports/alb_con_2022.10.29.filtered_cross-linked_spectra.csv",
    #     "G:/MSdata/221027ETF/ALB/reports/crosslink_spotlinkform/")
    print("*" * 40)
    print("--ALB--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/220929HSAEGGMILK/spotlink/"
    plink_root_dir = "G:/MSdata/221027ETF/ALB/reports/crosslink_spotlinkform/"
    ### fasta
    alb_fasta = "MKWVTLISFIFLFSSATSRNLQRFARDAEHKSEIAHRYNDLKEETFKAVAMITFAQYLQRCSYEGLSKLVKDVVDLAQKCVANEDAPECSKPLPSIILDEICQVEKLRDSYGAMADCCSKADPERNECFLSFKVSQPDFVQPYQRPASDVICQEYQDNRVSFLGHFIYSVARRHPFLYAPAILSFAVDFEHALQSCCKESDVGACLDTKEIVMREKAKGVSVKQQYFCGILKQFGDRVFQARQLIYLSQKYPKAPFSEVSKFVHDSIGVHKECCEGDMVECMDDMARMMSNLCSQQDVFSGKIKDCCEKPIVERSQCIMEAEFDEKPADLPSLVEKYIEDKEVCKSFEAGHDAFMAEFVYEYSRRHPEFSIQLIMRIAKGYESLLEKCCKTDNPAECYANAQEQLNQHIKETQDVVKTNCDLLHDHGEADFLKSILIRYTKKMPQVPTDLLLETGKKMTTIGTKCCQLGEDRRMACSEGYLSIVIHDTCRKQETTPINDNVSQCCSQLYANRRPCFTAMGVDTKYVPPPFNPDMFSFDEKLCSAPAEEREVGQMKLLINLIKRKPQMTEEQIKTIADGFTAMVDKCCKQSDINTCFGEEGANLIVQSRATLGIGA"
    ### file_dir
    spotlink_file_1025_Egg0_fDR = spotlink_root_dir + 'JYD_20221025_Egg0_HCDFT_result_filtered.csv'
    spotlink_file_1025_Egg1_fDR = spotlink_root_dir + 'JYD_20221025_Egg1_HCDFT_result_filtered.csv'
    spotlink_file_1025_Egg5_fDR = spotlink_root_dir + 'JYD_20221025_Egg5_HCDFT_result_filtered.csv'
    spotlink_file_1025_Egg25_fDR = spotlink_root_dir + 'JYD_20221025_Egg25_HCDFT_result_filtered.csv'
    spotlink_file_1025_Egg100_fDR = spotlink_root_dir + 'JYD_20221025_Egg100_HCDFT_result_filtered.csv'
    plink_file_1025_Egg0_fDR = plink_root_dir + "JYD_20221025_Egg0.csv"
    plink_file_1025_Egg5_fDR = plink_root_dir + "JYD_20221025_Egg5.csv"
    plink_file_1025_Egg25_fDR = plink_root_dir + "JYD_20221025_Egg25.csv"
    plink_file_1025_Egg100_fDR = plink_root_dir + "JYD_20221025_Egg100.csv"
    plink_file_1025_Egg1_fDR = plink_root_dir + "JYD_20221025_Egg1.csv"
    # Egg0_1025_s = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg0_fDR,
    #                                             alb_fasta,
    #                                             f2sf=False)[0]
    # Egg1_1025_s = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg1_fDR,
    #                                             alb_fasta,
    #                                             f2sf=False)[0]
    # Egg5_1025_s = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg5_fDR,
    #                                             alb_fasta,
    #                                             f2sf=False)[0]
    # Egg25_1025_s = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg25_fDR,
    #                                              alb_fasta,
    #                                              f2sf=False)[0]
    # Egg100_1025_s = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg100_fDR,
    #                                               alb_fasta,
    #                                               f2sf=False)[0]
    # Egg0_1025_sf = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg0_fDR,
    #                                              alb_fasta,
    #                                              f2sf=True)[0]
    # Egg1_1025_sf = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg1_fDR,
    #                                              alb_fasta,
    #                                              f2sf=True)[0]
    # Egg5_1025_sf = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg5_fDR,
    #                                              alb_fasta,
    #                                              f2sf=True)[0]
    # Egg25_1025_sf = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg25_fDR,
    #                                               alb_fasta,
    #                                               f2sf=True)[0]
    # Egg100_1025_sf = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg100_fDR,
    #                                                alb_fasta,
    #                                                f2sf=True)[0]
    Egg0_1025_p = plink_report_valid_link_sfDR(plink_file_1025_Egg0_fDR,
                                               alb_fasta)[0]
    Egg1_1025_p = plink_report_valid_link_sfDR(plink_file_1025_Egg1_fDR,
                                               alb_fasta)[0]
    Egg5_1025_p = plink_report_valid_link_sfDR(plink_file_1025_Egg5_fDR,
                                               alb_fasta)[0]
    Egg25_1025_p = plink_report_valid_link_sfDR(plink_file_1025_Egg25_fDR,
                                                alb_fasta)[0]
    Egg100_1025_p = plink_report_valid_link_sfDR(plink_file_1025_Egg100_fDR,
                                                 alb_fasta)[0]

    # Egg0_repeat = cal_multi_list([Egg0_1025_s, Egg0_1025_p])
    # Egg1_repeat = cal_multi_list([Egg1_1025_s, Egg1_1025_p])
    # Egg5_repeat = cal_multi_list([Egg5_1025_s, Egg5_1025_p])
    # Egg25_repeat = cal_multi_list([Egg25_1025_s, Egg25_1025_p])
    # Egg100_repeat = cal_multi_list([Egg100_1025_s, Egg100_1025_p])
    # Egg0_repeat = cal_multi_list([Egg0_1025_s, Egg0_1025_s])
    # Egg1_repeat = cal_multi_list([Egg1_1025_s, Egg1_1025_s])
    # Egg5_repeat = cal_multi_list([Egg5_1025_s, Egg5_1025_s])
    # Egg25_repeat = cal_multi_list([Egg25_1025_s, Egg25_1025_s])
    # Egg100_repeat = cal_multi_list([Egg100_1025_s, Egg100_1025_s])
    Egg0_repeat = cal_multi_list([Egg0_1025_p, Egg0_1025_p])
    Egg1_repeat = cal_multi_list([Egg1_1025_p, Egg1_1025_p])
    Egg5_repeat = cal_multi_list([Egg5_1025_p, Egg5_1025_p])
    Egg25_repeat = cal_multi_list([Egg25_1025_p, Egg25_1025_p])
    Egg100_repeat = cal_multi_list([Egg100_1025_p, Egg100_1025_p])

    Egg_repeat_list = [
        Egg0_repeat, Egg1_repeat, Egg5_repeat, Egg25_repeat, Egg100_repeat
    ]

    for i in Egg_repeat_list:
        k = [
            j for j in i
            if alb_fasta[int(j[0]) - 1] == "K" or alb_fasta[int(j[1]) -
                                                            1] == "K"
        ]
        cal_distance_pos_list(k,
                              fasta=alb_fasta,
                              pdb_file='G:/MSdata/pdb/alb.pdb',
                              threshold=600,
                              print_all=False)
        report_animo_ratio(k,
                           pos_form=True,
                           fasta_file=alb_fasta,
                           tableform=True,
                           ratio_output=False,
                           threshold=600)

# 1103
  # plink2crosslink(
    #     "G:/MSdata/221027ETF/Trans/reports/trfe_human_con_2022.10.29.filtered_cross-linked_spectra.csv",
    #     "G:/MSdata/221027ETF/Trans/reports/crosslink_spotlinkform/")
    print("*" * 40)
    print("--Trans--" * 5)
    print("*" * 40)
    ## define part
    spotlink_root_dir = "G:/MSdata/220929HSAEGGMILK/spotlink/"
    plink_root_dir = "G:/MSdata/221027ETF/Trans/reports/crosslink_spotlinkform/"
    ### fasta
    trfe_human_fasta = "MRLAVGALLVCAVLGLCLAVPDKTVRWCAVSEHEATKCQSFRDHMKSVIPSDGPSVACVKKASYLDCIRAIAANEADAVTLDAGLVYDAYLAPNNLKPVVAEFYGSKEDPQTFYYAVAVVKKDSGFQMNQLRGKKSCHTGLGRSAGWNIPIGLLYCDLPEPRKPLEKAVANFFSGSCAPCADGTDFPQLCQLCPGCGCSTLNQYFGYSGAFKCLKDGAGDVAFVKHSTIFENLANKADRDQYELLCLDNTRKPVDEYKDCHLAQVPSHTVVARSMGGKEDLIWELLNQAQEHFGKDKSKEFQLFSSPHGKDLLFKDSAHGFLKVPPRMDAKMYLGYEYVTAIRNLREGTCPEAPTDECKPVKWCALSHHERLKCDEWSVNSVGKIECVSAETTEDCIAKIMNGEADAMSLDGGFVYIAGKCGLVPVLAENYNKSDNCEDTPEAGYFAIAVVKKSASDLTWDNLKGKKSCHTAVGRTAGWNIPMGLLYNKINHCRFDEFFSEGCAPGSKKDSSLCKLCMGSGLNLCEPNNKEGYYGYTGAFRCLVEKGDVAFVKHQTVPQNTGGKNPDPWAKNLNEKDYELLCLDGTRKPVEEYANCHLARAPNHAVVTRKDKEACVHKILRQQQHLFGSNVTDCSGNFCLFRSETKDLLFRDDTVCLAKLHDRNTYEKYLGEEYVKAVGNLRKCSTSSLLEACTFRRP"
    ### file_dir
    spotlink_file_1025_Trans0_fDR = spotlink_root_dir + 'JYD_20221025_Trans0_HCDFT_result_filtered.csv'
    spotlink_file_1025_Trans1_fDR = spotlink_root_dir + 'JYD_20221025_Trans1_HCDFT_result_filtered.csv'
    spotlink_file_1025_Trans5_fDR = spotlink_root_dir + 'JYD_20221025_Trans5_HCDFT_result_filtered.csv'
    spotlink_file_1025_Trans25_fDR = spotlink_root_dir + 'JYD_20221025_Trans25_HCDFT_result_filtered.csv'
    spotlink_file_1025_Trans100_fDR = spotlink_root_dir + 'JYD_20221025_Trans100_HCDFT_result_filtered.csv'
    plink_file_1025_Trans0_fDR = plink_root_dir + "JYD_20221025_Trans0.csv"
    plink_file_1025_Trans5_fDR = plink_root_dir + "JYD_20221025_Trans5.csv"
    plink_file_1025_Trans25_fDR = plink_root_dir + "JYD_20221025_Trans25.csv"
    plink_file_1025_Trans100_fDR = plink_root_dir + "JYD_20221025_Trans100.csv"
    plink_file_1025_Trans1_fDR = plink_root_dir + "JYD_20221025_Trans1.csv"
    # Trans0_1025_s = spotlink_report_valid_link_sfDR(spotlink_file_1025_Trans0_fDR,
    #                                             trfe_human_fasta,
    #                                             f2sf=False)[0]
    # Trans1_1025_s = spotlink_report_valid_link_sfDR(spotlink_file_1025_Trans1_fDR,
    #                                             trfe_human_fasta,
    #                                             f2sf=False)[0]
    # Trans5_1025_s = spotlink_report_valid_link_sfDR(spotlink_file_1025_Trans5_fDR,
    #                                             trfe_human_fasta,
    #                                             f2sf=False)[0]
    # Trans25_1025_s = spotlink_report_valid_link_sfDR(spotlink_file_1025_Trans25_fDR,
    #                                              trfe_human_fasta,
    #                                              f2sf=False)[0]
    # Trans100_1025_s = spotlink_report_valid_link_sfDR(spotlink_file_1025_Trans100_fDR,
    #                                               trfe_human_fasta,
    #                                               f2sf=False)[0]
    # Trans0_1025_sf = spotlink_report_valid_link_sfDR(spotlink_file_1025_Trans0_fDR,
    #                                              trfe_human_fasta,
    #                                              f2sf=True)[0]
    # Trans1_1025_sf = spotlink_report_valid_link_sfDR(spotlink_file_1025_Trans1_fDR,
    #                                              trfe_human_fasta,
    #                                              f2sf=True)[0]
    # Trans5_1025_sf = spotlink_report_valid_link_sfDR(spotlink_file_1025_Trans5_fDR,
    #                                              trfe_human_fasta,
    #                                              f2sf=True)[0]
    # Trans25_1025_sf = spotlink_report_valid_link_sfDR(spotlink_file_1025_Trans25_fDR,
    #                                               trfe_human_fasta,
    #                                               f2sf=True)[0]
    # Trans100_1025_sf = spotlink_report_valid_link_sfDR(spotlink_file_1025_Trans100_fDR,
    #                                                trfe_human_fasta,
    #                                                f2sf=True)[0]
    Trans0_1025_p = plink_report_valid_link_sfDR(plink_file_1025_Trans0_fDR,
                                                 trfe_human_fasta)[0]
    Trans1_1025_p = plink_report_valid_link_sfDR(plink_file_1025_Trans1_fDR,
                                                 trfe_human_fasta)[0]
    Trans5_1025_p = plink_report_valid_link_sfDR(plink_file_1025_Trans5_fDR,
                                                 trfe_human_fasta)[0]
    Trans25_1025_p = plink_report_valid_link_sfDR(plink_file_1025_Trans25_fDR,
                                                  trfe_human_fasta)[0]
    Trans100_1025_p = plink_report_valid_link_sfDR(
        plink_file_1025_Trans100_fDR, trfe_human_fasta)[0]

    # Trans0_repeat = cal_multi_list([Trans0_1025_s, Trans0_1025_p])
    # Trans1_repeat = cal_multi_list([Trans1_1025_s, Trans1_1025_p])
    # Trans5_repeat = cal_multi_list([Trans5_1025_s, Trans5_1025_p])
    # Trans25_repeat = cal_multi_list([Trans25_1025_s, Trans25_1025_p])
    # Trans100_repeat = cal_multi_list([Trans100_1025_s, Trans100_1025_p])
    # Trans0_repeat = cal_multi_list([Trans0_1025_s, Trans0_1025_s])
    # Trans1_repeat = cal_multi_list([Trans1_1025_s, Trans1_1025_s])
    # Trans5_repeat = cal_multi_list([Trans5_1025_s, Trans5_1025_s])
    # Trans25_repeat = cal_multi_list([Trans25_1025_s, Trans25_1025_s])
    # Trans100_repeat = cal_multi_list([Trans100_1025_s, Trans100_1025_s])
    Trans0_repeat = cal_multi_list([Trans0_1025_p, Trans0_1025_p])
    Trans1_repeat = cal_multi_list([Trans1_1025_p, Trans1_1025_p])
    Trans5_repeat = cal_multi_list([Trans5_1025_p, Trans5_1025_p])
    Trans25_repeat = cal_multi_list([Trans25_1025_p, Trans25_1025_p])
    Trans100_repeat = cal_multi_list([Trans100_1025_p, Trans100_1025_p])

    Trans_repeat_list = [
        Trans0_repeat, Trans1_repeat, Trans5_repeat, Trans25_repeat,
        Trans100_repeat
    ]

    for i in Trans_repeat_list:
        k = [
            j for j in i
            if mod_fasta_head(trfe_human_fasta)[int(j[0]) - 1] == "K"
            or mod_fasta_head(trfe_human_fasta)[int(j[1]) - 1] == "K"
        ]
        # cal_distance_pos_list(k,
        #                       fasta=trfe_human_fasta,
        #                       pdb_file='G:/MSdata/pdb/alb.pdb',
        #                       threshold=600,
        #                       print_all=False)
        print(k)
        report_animo_ratio(k,
                           pos_form=True,
                           fasta_file=mod_fasta_head(trfe_human_fasta),
                           tableform=True,
                           ratio_output=False,
                           threshold=600)

    # # plink2crosslink(
    # #     "G:/MSdata/221027ETF/ALB/reports/alb_con_2022.10.29.filtered_cross-linked_spectra.csv",
    # #     "G:/MSdata/221027ETF/ALB/reports/crosslink_spotlinkform/")
    # print("*" * 40)
    # print("--ALB--" * 5)
    # print("*" * 40)
    # ## define part
    # spotlink_root_dir = "G:/MSdata/220929HSAEGGMILK/spotlink/"
    # plink_root_dir = "G:/MSdata/221027ETF/ALB/reports/crosslink_spotlinkform/"
    # ### fasta
    # alb_fasta = "MKWVTLISFIFLFSSATSRNLQRFARDAEHKSEIAHRYNDLKEETFKAVAMITFAQYLQRCSYEGLSKLVKDVVDLAQKCVANEDAPECSKPLPSIILDEICQVEKLRDSYGAMADCCSKADPERNECFLSFKVSQPDFVQPYQRPASDVICQEYQDNRVSFLGHFIYSVARRHPFLYAPAILSFAVDFEHALQSCCKESDVGACLDTKEIVMREKAKGVSVKQQYFCGILKQFGDRVFQARQLIYLSQKYPKAPFSEVSKFVHDSIGVHKECCEGDMVECMDDMARMMSNLCSQQDVFSGKIKDCCEKPIVERSQCIMEAEFDEKPADLPSLVEKYIEDKEVCKSFEAGHDAFMAEFVYEYSRRHPEFSIQLIMRIAKGYESLLEKCCKTDNPAECYANAQEQLNQHIKETQDVVKTNCDLLHDHGEADFLKSILIRYTKKMPQVPTDLLLETGKKMTTIGTKCCQLGEDRRMACSEGYLSIVIHDTCRKQETTPINDNVSQCCSQLYANRRPCFTAMGVDTKYVPPPFNPDMFSFDEKLCSAPAEEREVGQMKLLINLIKRKPQMTEEQIKTIADGFTAMVDKCCKQSDINTCFGEEGANLIVQSRATLGIGA"
    # ### file_dir
    # spotlink_file_1025_Egg0_fDR = spotlink_root_dir + 'JYD_20221025_Egg0_HCDFT_result_filtered.csv'
    # spotlink_file_1025_Egg1_fDR = spotlink_root_dir + 'JYD_20221025_Egg1_HCDFT_result_filtered.csv'
    # spotlink_file_1025_Egg5_fDR = spotlink_root_dir + 'JYD_20221025_Egg5_HCDFT_result_filtered.csv'
    # spotlink_file_1025_Egg25_fDR = spotlink_root_dir + 'JYD_20221025_Egg25_HCDFT_result_filtered.csv'
    # spotlink_file_1025_Egg100_fDR = spotlink_root_dir + 'JYD_20221025_Egg100_HCDFT_result_filtered.csv'
    # plink_file_1025_Egg0_fDR = plink_root_dir + "JYD_20221025_Egg0.csv"
    # plink_file_1025_Egg5_fDR = plink_root_dir + "JYD_20221025_Egg5.csv"
    # plink_file_1025_Egg25_fDR = plink_root_dir + "JYD_20221025_Egg25.csv"
    # plink_file_1025_Egg100_fDR = plink_root_dir + "JYD_20221025_Egg100.csv"
    # plink_file_1025_Egg1_fDR = plink_root_dir + "JYD_20221025_Egg1.csv"
    # # Egg0_1025_s = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg0_fDR,
    # #                                             alb_fasta,
    # #                                             f2sf=False)[0]
    # # Egg1_1025_s = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg1_fDR,
    # #                                             alb_fasta,
    # #                                             f2sf=False)[0]
    # # Egg5_1025_s = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg5_fDR,
    # #                                             alb_fasta,
    # #                                             f2sf=False)[0]
    # # Egg25_1025_s = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg25_fDR,
    # #                                              alb_fasta,
    # #                                              f2sf=False)[0]
    # # Egg100_1025_s = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg100_fDR,
    # #                                               alb_fasta,
    # #                                               f2sf=False)[0]
    # # Egg0_1025_sf = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg0_fDR,
    # #                                              alb_fasta,
    # #                                              f2sf=True)[0]
    # # Egg1_1025_sf = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg1_fDR,
    # #                                              alb_fasta,
    # #                                              f2sf=True)[0]
    # # Egg5_1025_sf = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg5_fDR,
    # #                                              alb_fasta,
    # #                                              f2sf=True)[0]
    # # Egg25_1025_sf = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg25_fDR,
    # #                                               alb_fasta,
    # #                                               f2sf=True)[0]
    # # Egg100_1025_sf = spotlink_report_valid_link_sfDR(spotlink_file_1025_Egg100_fDR,
    # #                                                alb_fasta,
    # #                                                f2sf=True)[0]
    # Egg0_1025_p = plink_report_valid_link_sfDR(plink_file_1025_Egg0_fDR,
    #                                            alb_fasta)[0]
    # Egg1_1025_p = plink_report_valid_link_sfDR(plink_file_1025_Egg1_fDR,
    #                                            alb_fasta)[0]
    # Egg5_1025_p = plink_report_valid_link_sfDR(plink_file_1025_Egg5_fDR,
    #                                            alb_fasta)[0]
    # Egg25_1025_p = plink_report_valid_link_sfDR(plink_file_1025_Egg25_fDR,
    #                                             alb_fasta)[0]
    # Egg100_1025_p = plink_report_valid_link_sfDR(plink_file_1025_Egg100_fDR,
    #                                              alb_fasta)[0]

    # # Egg0_repeat = cal_multi_list([Egg0_1025_s, Egg0_1025_p])
    # # Egg1_repeat = cal_multi_list([Egg1_1025_s, Egg1_1025_p])
    # # Egg5_repeat = cal_multi_list([Egg5_1025_s, Egg5_1025_p])
    # # Egg25_repeat = cal_multi_list([Egg25_1025_s, Egg25_1025_p])
    # # Egg100_repeat = cal_multi_list([Egg100_1025_s, Egg100_1025_p])
    # # Egg0_repeat = cal_multi_list([Egg0_1025_s, Egg0_1025_s])
    # # Egg1_repeat = cal_multi_list([Egg1_1025_s, Egg1_1025_s])
    # # Egg5_repeat = cal_multi_list([Egg5_1025_s, Egg5_1025_s])
    # # Egg25_repeat = cal_multi_list([Egg25_1025_s, Egg25_1025_s])
    # # Egg100_repeat = cal_multi_list([Egg100_1025_s, Egg100_1025_s])
    # Egg0_repeat = cal_multi_list([Egg0_1025_p, Egg0_1025_p])
    # Egg1_repeat = cal_multi_list([Egg1_1025_p, Egg1_1025_p])
    # Egg5_repeat = cal_multi_list([Egg5_1025_p, Egg5_1025_p])
    # Egg25_repeat = cal_multi_list([Egg25_1025_p, Egg25_1025_p])
    # Egg100_repeat = cal_multi_list([Egg100_1025_p, Egg100_1025_p])

    # Egg_repeat_list = [
    #     Egg0_repeat, Egg1_repeat, Egg5_repeat, Egg25_repeat, Egg100_repeat
    # ]

    # for i in Egg_repeat_list:
    #     k = [
    #         j for j in i
    #         if alb_fasta[int(j[0]) - 1] == "K" or alb_fasta[int(j[1]) -
    #                                                         1] == "K"
    #     ]
    #     cal_distance_pos_list(k,
    #                           fasta=alb_fasta,
    #                           pdb_file='G:/MSdata/pdb/alb.pdb',
    #                           threshold=600,
    #                           print_all=False)
    #     report_animo_ratio(k,
    #                        pos_form=True,
    #                        fasta_file=alb_fasta,
    #                        tableform=True,
    #                        ratio_output=False,
    #                        threshold=600)
